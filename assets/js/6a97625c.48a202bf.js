"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[4976],{85581:(e,t,r)=>{r.d(t,{Ay:()=>i,RM:()=>l});var n=r(74848),a=r(28453);const l=[];function s(e){const t={code:"code",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("br",{}),"\n",(0,n.jsxs)(t.p,{children:["The ",(0,n.jsx)(t.code,{children:"ziti"})," CLI will help you get an API Session from the controller's management API. You will be prompted to trust any new server certificates. Your login token cache and trust store are managed by the CLI in your home directory."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-text",children:"# implies https://localhost:1280\nziti edge login -u admin -p admin\n"})}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-text",children:"# implies https://\nziti edge login ctrl.ziti.example.com:8441 -u admin -p admin\n"})})]})}function i(e={}){const{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(s,{...e})}):s(e)}},42711:(e,t,r)=>{r.r(t),r.d(t,{assets:()=>d,contentTitle:()=>c,default:()=>m,frontMatter:()=>u,metadata:()=>n,toc:()=>p});const n=JSON.parse('{"id":"guides/deployments/linux/router/cli-mgmt","title":"Managing Routers with the CLI","description":"Login","source":"@site/docs/guides/deployments/10-linux/20-router/40-cli-mgmt.mdx","sourceDirName":"guides/deployments/10-linux/20-router","slug":"/guides/deployments/linux/router/cli-mgmt","permalink":"/docs/guides/deployments/linux/router/cli-mgmt","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/deployments/10-linux/20-router/40-cli-mgmt.mdx","tags":[],"version":"current","sidebarPosition":40,"frontMatter":{"id":"cli-mgmt","title":"Managing Routers with the CLI","sidebar_label":"CLI Mgmt"},"sidebar":"docsSidebar","previous":{"title":"Configuration","permalink":"/docs/guides/deployments/linux/router/router-configuration"},"next":{"title":"Migrate","permalink":"/docs/guides/deployments/linux/router/migrate"}}');var a=r(74848),l=r(28453),s=r(65537),i=r(79329),o=r(85581);const u={id:"cli-mgmt",title:"Managing Routers with the CLI",sidebar_label:"CLI Mgmt"},c=void 0,d={},p=[{value:"Login",id:"login",level:2},...o.RM,{value:"Create a Router",id:"create-a-router",level:2},{value:"Update a Router",id:"update-a-router",level:2},{value:"Additional Flags",id:"additional-flags",level:2},{value:"Role Attributes are Powerful",id:"role-attributes-are-powerful",level:2}];function h(e){const t={code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.h2,{id:"login",children:"Login"}),"\n",(0,a.jsx)(o.Ay,{}),"\n",(0,a.jsx)(t.h2,{id:"create-a-router",children:"Create a Router"}),"\n",(0,a.jsxs)(s.A,{groupId:"routerType",children:[(0,a.jsxs)(i.A,{value:"TunnelerEnabled",label:"Router with Tunneler",children:[(0,a.jsx)(t.p,{children:"The tunneler flag must be administratively set when the router is created or updated or the router will not start."}),(0,a.jsx)("br",{}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'ziti edge create edge-router "router2" \\\n    --jwt-output-file router2.jwt \\\n    --tunneler-enabled\n'})})]}),(0,a.jsxs)(i.A,{value:"NoTraversal",label:"Router with No Traversal",children:[(0,a.jsx)(t.p,{children:"No-traversal routers are administratively excluded from the set of routers that provide smart routing for transiting service traffic. They still provide service termination and origination."}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'ziti edge create edge-router "router3" \\\n    --jwt-output-file router3.jwt \\\n    --no-traversal\n'})})]})]}),"\n",(0,a.jsx)(t.h2,{id:"update-a-router",children:"Update a Router"}),"\n",(0,a.jsxs)(t.p,{children:["The update command will replace all administrative properties of the router. This example preserves the properties from the router3 example above, adding the ",(0,a.jsx)(t.code,{children:"--tunneler-enabled"})," flag."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'ziti edge update edge-router "router3" \\\n    --no-traversal \\\n    --tunneler-enabled\n'})}),"\n",(0,a.jsx)(t.h2,{id:"additional-flags",children:"Additional Flags"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"App-Data can be used to set key/value pair to be used in addressable terminator service for example."}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:'--app-data stringToString   Custom application data (default [])\n--app-data "fqdn"="aksprod-cae02995.eastus2.azmk8s.io"\n'})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Router cost can be used to influence the smart routing to not use this router for service traversal unless no other paths are available."}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"--cost uint16               Specifies the router cost. Default 0.\n--cost 300\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"No-traversal flag means no service traversal through this router at all. Only the service termination or origination can be completed on it."}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"--no-traversal              Disallow traversal for this edge router. Default to allowed(false).\n"})}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"The role attribute flag allows to set a list of attributes that can be referenced by all policies for dialing and/or hosting services."}),"\n"]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-text",children:"-a, --role-attributes strings   Set role attributes of the edge router. Use --role-attributes '' to set an empty list\n --role-attributes 'example,example2,example3'\n"})}),"\n",(0,a.jsx)(t.h2,{id:"role-attributes-are-powerful",children:"Role Attributes are Powerful"}),"\n",(0,a.jsx)(t.p,{children:"Consider an autoscaling group scenario where routers are created or deleted with scale-out or scale-in events. Attribute-based access control enables this scenario because the policies grant roles instead of the individual, temporary identities."}),"\n",(0,a.jsxs)(t.p,{children:["If router names or IDs were referenced explicitly in such a scenario then all policies would need to be updated upon the scale-out event with new grants like ",(0,a.jsx)(t.code,{children:"@router_name"}),". To keep the complexity of this deployment to minimum, it just makes sense to use role ",(0,a.jsx)(t.code,{children:"#attributes"}),"."]})]})}function m(e={}){const{wrapper:t}={...(0,l.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},79329:(e,t,r)=>{r.d(t,{A:()=>s});r(96540);var n=r(34164);const a={tabItem:"tabItem_Ymn6"};var l=r(74848);function s(e){let{children:t,hidden:r,className:s}=e;return(0,l.jsx)("div",{role:"tabpanel",className:(0,n.A)(a.tabItem,s),hidden:r,children:t})}},65537:(e,t,r)=>{r.d(t,{A:()=>w});var n=r(96540),a=r(34164),l=r(65627),s=r(56347),i=r(50372),o=r(30604),u=r(11861),c=r(78749);function d(e){return n.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,n.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function p(e){const{values:t,children:r}=e;return(0,n.useMemo)((()=>{const e=t??function(e){return d(e).map((e=>{let{props:{value:t,label:r,attributes:n,default:a}}=e;return{value:t,label:r,attributes:n,default:a}}))}(r);return function(e){const t=(0,u.XI)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,r])}function h(e){let{value:t,tabValues:r}=e;return r.some((e=>e.value===t))}function m(e){let{queryString:t=!1,groupId:r}=e;const a=(0,s.W6)(),l=function(e){let{queryString:t=!1,groupId:r}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:t,groupId:r});return[(0,o.aZ)(l),(0,n.useCallback)((e=>{if(!l)return;const t=new URLSearchParams(a.location.search);t.set(l,e),a.replace({...a.location,search:t.toString()})}),[l,a])]}function g(e){const{defaultValue:t,queryString:r=!1,groupId:a}=e,l=p(e),[s,o]=(0,n.useState)((()=>function(e){let{defaultValue:t,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!h({value:t,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const n=r.find((e=>e.default))??r[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:l}))),[u,d]=m({queryString:r,groupId:a}),[g,f]=function(e){let{groupId:t}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,l]=(0,c.Dv)(r);return[a,(0,n.useCallback)((e=>{r&&l.set(e)}),[r,l])]}({groupId:a}),b=(()=>{const e=u??g;return h({value:e,tabValues:l})?e:null})();(0,i.A)((()=>{b&&o(b)}),[b]);return{selectedValue:s,selectValue:(0,n.useCallback)((e=>{if(!h({value:e,tabValues:l}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),f(e)}),[d,f,l]),tabValues:l}}var f=r(9136);const b={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=r(74848);function v(e){let{className:t,block:r,selectedValue:n,selectValue:s,tabValues:i}=e;const o=[],{blockElementScrollPositionUntilNextRender:u}=(0,l.a_)(),c=e=>{const t=e.currentTarget,r=o.indexOf(t),a=i[r].value;a!==n&&(u(t),s(a))},d=e=>{let t=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=o.indexOf(e.currentTarget)+1;t=o[r]??o[0];break}case"ArrowLeft":{const r=o.indexOf(e.currentTarget)-1;t=o[r]??o[o.length-1];break}}t?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,a.A)("tabs",{"tabs--block":r},t),children:i.map((e=>{let{value:t,label:r,attributes:l}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:n===t?0:-1,"aria-selected":n===t,ref:e=>{o.push(e)},onKeyDown:d,onClick:c,...l,className:(0,a.A)("tabs__item",b.tabItem,l?.className,{"tabs__item--active":n===t}),children:r??t},t)}))})}function j(e){let{lazy:t,children:r,selectedValue:l}=e;const s=(Array.isArray(r)?r:[r]).filter(Boolean);if(t){const e=s.find((e=>e.props.value===l));return e?(0,n.cloneElement)(e,{className:(0,a.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:s.map(((e,t)=>(0,n.cloneElement)(e,{key:t,hidden:e.props.value!==l})))})}function y(e){const t=g(e);return(0,x.jsxs)("div",{className:(0,a.A)("tabs-container",b.tabList),children:[(0,x.jsx)(v,{...t,...e}),(0,x.jsx)(j,{...t,...e})]})}function w(e){const t=(0,f.A)();return(0,x.jsx)(y,{...e,children:d(e.children)},String(t))}},28453:(e,t,r)=>{r.d(t,{R:()=>s,x:()=>i});var n=r(96540);const a={},l=n.createContext(a);function s(e){const t=n.useContext(l);return n.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(a):e.components||a:s(e.components),n.createElement(l.Provider,{value:t},e.children)}}}]);