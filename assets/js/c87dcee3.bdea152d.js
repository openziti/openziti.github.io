"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[9123],{4819:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>c,contentTitle:()=>a,default:()=>p,frontMatter:()=>l,metadata:()=>i,toc:()=>u});const i=JSON.parse('{"id":"reference/tunnelers/linux/manual-installation","title":"Manual Installation","description":"The latest stable release of ziti-edge-tunnel is","source":"@site/docs/reference/tunnelers/60-linux/30-manual-installation.mdx","sourceDirName":"reference/tunnelers/60-linux","slug":"/reference/tunnelers/linux/manual-installation","permalink":"/docs/reference/tunnelers/linux/manual-installation","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/reference/tunnelers/60-linux/30-manual-installation.mdx","tags":[],"version":"current","lastUpdatedAt":1745951089000,"sidebarPosition":30,"frontMatter":{"title":"Manual Installation","sidebar_label":"Manual"},"sidebar":"docsSidebar","previous":{"title":"RedHat","permalink":"/docs/reference/tunnelers/linux/redhat-package"},"next":{"title":"Options and Modes","permalink":"/docs/reference/tunnelers/linux/linux-tunnel-options"}}');var s=t(74848),r=t(28453),o=t(49584),d=t(62364);const l={title:"Manual Installation",sidebar_label:"Manual"},a=void 0,c={},u=[...d.RM,...o.RM];function h(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/openziti/ziti-tunnel-sdk-c/releases/latest/",children:"The latest stable release"})," of ",(0,s.jsx)(n.code,{children:"ziti-edge-tunnel"})," is\ndistributed as an executable binary in GitHub."]}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Unzip the downloaded file and copy the binary to a directory in your PATH, such as ",(0,s.jsx)(n.code,{children:"/usr/local/bin"}),"."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"sudo install -o root -g root ./ziti-edge-tunnel /usr/local/bin/\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Create a POSIX group named ",(0,s.jsx)(n.code,{children:"ziti"})," if it doesn't already exist. Members of this group can access the identity files and send IPC commands to the socket server."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"sudo groupadd --system ziti\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Create a directory to hold the identity files. The tunneler will manage the contents of the identity directory."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"sudo mkdir -pv /opt/openziti/etc/identities\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Run the Manually Installed Binary"}),"\n",(0,s.jsx)(n.p,{children:"When not using the Linux package, you must run the tunneler as root so it will have permission to manage IP routes and the resolver configuration."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"sudo ziti-edge-tunnel run --identity-dir /opt/openziti/etc/identities\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Add an Identity"}),"\n",(0,s.jsx)(d.Ay,{}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure the Resolver"}),"\n",(0,s.jsx)(o.Ay,{}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},62364:(e,n,t)=>{t.d(n,{Ay:()=>d,RM:()=>r});var i=t(74848),s=t(28453);const r=[{value:"Add a Single Identity",id:"add-a-single-identity",level:3},{value:"Load Identities Directory",id:"load-identities-directory",level:3}];function o(e){const n={a:"a",admonition:"admonition",code:"code",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The tunneller can run with zero or more identities loaded, and needs at least one to make OpenZiti services available on\nthe host. Adding an identity means providing a JWT enrollment token which is used by the tunneller to obtain a client\ncertificate from the OpenZiti controller. ",(0,i.jsx)(n.a,{href:"/docs/learn/core-concepts/identities/overview",children:"Learn more about OpenZiti Identities"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"add-a-single-identity",children:"Add a Single Identity"}),"\n",(0,i.jsxs)(n.p,{children:["Root and members of group ",(0,i.jsx)(n.code,{children:"ziti"})," may add an identity without restarting."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'sudo ziti-edge-tunnel add --jwt "$(< ./in-file.jwt)" --identity myIdentityName\n'})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.a,{href:"/docs/learn/core-concepts/identities/enrolling",children:"Learn more about enrolling"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"load-identities-directory",children:"Load Identities Directory"}),"\n",(0,i.jsxs)(n.p,{children:["The tunneller will load all enrolled identities in the ",(0,i.jsx)(n.code,{children:"--identity-dir"})," directory at startup. The default location for\nidentities is is ",(0,i.jsx)(n.code,{children:"/opt/openziti/etc/identities"}),". Add enrolled identity files to this directory by copying the JSON file\ninto the directory and setting permissions for group ",(0,i.jsx)(n.code,{children:"ziti"}),"."]}),"\n",(0,i.jsx)(n.admonition,{type:"note",children:(0,i.jsxs)(n.p,{children:["Linux package users may place enrollment tokens named ",(0,i.jsx)(n.code,{children:"*.jwt"})," in this directory for automatic enrollment at next\nstartup."]})}),"\n",(0,i.jsxs)(n.p,{children:["Ensure the identities directory is writable by group ",(0,i.jsx)(n.code,{children:"ziti"})," and not readable by others to protect the confidentiality of\nthe identities."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"sudo chown -cR :ziti        /opt/openziti/etc/identities\nsudo chmod -cR ug=rwX,o-rwx /opt/openziti/etc/identities\n"})}),"\n",(0,i.jsxs)(n.p,{children:["The tunneller process needs to be restarted if the contents of ",(0,i.jsx)(n.code,{children:"/opt/openziti/etc/identities"})," change."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"# package users can restart with systemd\nsudo systemctl restart ziti-edge-tunnel.service\n"})})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},49584:(e,n,t)=>{t.d(n,{Ay:()=>d,RM:()=>r});var i=t(74848),s=t(28453);const r=[];function o(e){const n={code:"code",em:"em",p:"p",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"ziti-edge-tunnel run"})," provides a built-in nameserver for the services it is authorized to dial. The nameserver is automatically configured by ",(0,i.jsx)(n.code,{children:"systemd-resolved"}),", if enabled."]}),"\n",(0,i.jsxs)(n.p,{children:["If ",(0,i.jsx)(n.code,{children:"systemd-resolved"})," is not enabled, you must configure your resolver to query the tunneler's nameserver. Add Ziti's nameserver to the connection manager, e.g., NetworkManager, Netplan, or by directly editing ",(0,i.jsx)(n.code,{children:"/etc/resolv.conf"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"You may configure the system resolver to use the tunneler's nameserver as the first or only nameserver."}),"\n",(0,i.jsxs)(n.p,{children:["When the tunneler nameserver is the first of multiple nameservers and the requested DNS record does not match an authorized service's intercept domain name, it sets the query status to ",(0,i.jsx)(n.code,{children:"REFUSE"}),". This implies that the caller ",(0,i.jsx)(n.em,{children:"should"})," keep trying to resolve the domain name with other nameservers."]}),"\n",(0,i.jsxs)(n.p,{children:["To use the tunneler nameserver as the only nameserver, you must specify an upstream nameserver for recursion: ",(0,i.jsx)(n.code,{children:"ziti-edge-tunnel run --dns-upstream 208.67.222.222"}),". In this configuration, the query status from the upstream nameserver is returned, e.g., ",(0,i.jsx)(n.code,{children:"NXDOMAIN"})," if the domain name is not found in the tunneler nameserver or the upstream nameserver."]}),"\n",(0,i.jsxs)(n.p,{children:["The IP address of the nameserver (default: ",(0,i.jsx)(n.code,{children:"100.64.0.2"}),") is determined by the tunneler's dns-ip-range (default: ",(0,i.jsx)(n.code,{children:"100.64.0.1/10"}),")."]})]})}function d(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var i=t(96540);const s={},r=i.createContext(s);function o(e){const n=i.useContext(r);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);