"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[2656],{48169:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>o,toc:()=>c});var o=t(88693),s=t(74848),r=t(28453);const i={title:"zrok VPN",date:new Date("2024-05-21T15:17:50.000Z"),cuid:"clwgjhize000d0ck18y703n52",slug:"zrok-vpn",authors:["EugeneKobyakov"],image:"@site/blogs/openziti/v1716212137599/451cee0f-8d37-4ab2-8548-8a62b42656af.png",imageDark:"@site/blogs/openziti/v1716212137599/451cee0f-8d37-4ab2-8548-8a62b42656af.png",tags:["zerotrust","zrok"]},a=void 0,l={authorsImageUrls:[void 0]},c=[{value:"TL;DR version",id:"tldr-version",level:2},{value:"Longer Read",id:"longer-read",level:2},{value:"Why? What took so long?",id:"why-what-took-so-long",level:2},{value:"Enter zrok",id:"enter-zrok",level:2},{value:"VPN implementation",id:"vpn-implementation",level:2},{value:"zrok VPN future",id:"zrok-vpn-future",level:2}];function h(e){const n={a:"a",code:"code",em:"em",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:["The latest version of ",(0,s.jsx)(n.a,{href:"https://zrok.io/",children:(0,s.jsx)(n.code,{children:"zrok"})})," has a new capability -- host-to-host VPN tunnel."]}),"\n",(0,s.jsx)(n.h2,{id:"tldr-version",children:"TL;DR version"}),"\n",(0,s.jsxs)(n.p,{children:["On VPN ",(0,s.jsx)(n.em,{children:"host"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"$ sudo -E zrok share private --headless --backend-mode vpn\n[   0.542]    INFO sdk-golang/ziti.(*listenerManager).createSessionWithBackoff: {session token=[589d443c-f59d-4fc8-8c48-76609b7fb402]} new service session\n[   0.705]    INFO main.(*sharePrivateCommand).run: allow other to access your share with the following command:\nzrok access private 3rq7torslq3n\n[   0.705]    INFO zrok/endpoints/vpn.(*Backend).Run: started\n"})}),"\n",(0,s.jsxs)(n.p,{children:["On VPN ",(0,s.jsx)(n.em,{children:"client"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-plaintext",children:"$ sudo -E zrok access private --headless 3rq7torslq3n\n[   0.201]    INFO main.(*accessPrivateCommand).run: allocated frontend '50B5hloP1s1X'\n[   0.662]    INFO main.(*accessPrivateCommand).run: access the zrok share at the following endpoint: VPN:\n[   0.662]    INFO main.(*accessPrivateCommand).run: 10.122.0.1 -> CONNECTED Welcome to zrok VPN\n[   0.662]    INFO zrok/endpoints/vpn.(*Frontend).Run: connected:Welcome to zrok VPN\n"})}),"\n",(0,s.jsx)(n.p,{children:"At this point your VPN host and client are connect with VPN -- you can access host resources via host IP address (10.122.0.1), client IP will be from 10.122.0.0/16 block."}),"\n",(0,s.jsx)(n.h2,{id:"longer-read",children:"Longer Read"}),"\n",(0,s.jsxs)(n.p,{children:["If you just want to learn more and what options are available the best place to start is on zrok ",(0,s.jsx)(n.a,{href:"https://docs.zrok.io/docs/guides/vpn/",children:"doc page"}),". Also check out a ZitiTV episode where I discuss zrok VPN with the host, Clint."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.youtube.com/live/OG9z1_8FbDg?si=FNXqs8SYAMPMLggn",children:"https://www.youtube.com/live/OG9z1_8FbDg?si=FNXqs8SYAMPMLggn"})}),"\n",(0,s.jsx)(n.h2,{id:"why-what-took-so-long",children:"Why? What took so long?"}),"\n",(0,s.jsxs)(n.p,{children:["Both fair questions, so a little background. We (",(0,s.jsx)(n.a,{href:"https://openziti.io",children:"OpenZiti"})," project) and me personally do not consider VPN solutions particularly zero-trust-worthy. There a number of reasons for that:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"VPNs operate at the network packet level not application level. This means that they will forward any matching packet into the private network whether or not there is a legitimate target for it."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"VPNs have no concept of application access control -- meaning everyone connecting to a private network gets the same access to network resources."}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For those reasons we built OpenZiti on the foundation of ",(0,s.jsx)(n.a,{href:"https://openziti.io/docs/learn/introduction/features",children:"strong zero-trust principals"}),"."]}),"\n",(0,s.jsxs)(n.p,{children:["...But people still ",(0,s.jsx)(n.em,{children:"want"})," an easy way of remote access to home or office with ",(0,s.jsx)(n.em,{children:"good enough"})," security that VPN gives them."]}),"\n",(0,s.jsx)(n.p,{children:"So, you want a VPN I'll build you a VPN. How hard can it really be??"}),"\n",(0,s.jsx)(n.h2,{id:"enter-zrok",children:"Enter zrok"}),"\n",(0,s.jsxs)(n.p,{children:["If you have not yet tried or heard about zrok, I invite you to read the ",(0,s.jsx)(n.a,{href:"./tags/zrok",children:"zrok series"})," on this very blog."]}),"\n",(0,s.jsxs)(n.p,{children:["The reasons we chose to implement VPN as part of ",(0,s.jsx)(n.a,{href:"https://zrok.io/",children:"zrok"})," are the following:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"super easy to start and use"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"well established share/access pattern: both side are in sync on what mode is used"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["easy to add another ",(0,s.jsx)(n.code,{children:"backend"})," mode"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"vpn-implementation",children:"VPN implementation"}),"\n",(0,s.jsxs)(n.p,{children:["Under the hood, the zrok framework already has all the necessary components for creating shares, accessing them, and establishing connections between the ",(0,s.jsx)(n.code,{children:"access"})," and ",(0,s.jsx)(n.code,{children:"share"})," sides. So all I needed to do to implement VPN mode:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"open virtual network device (tun)"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"configure network addresses and routes"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"read packets and forward them"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"... Wait ... that was it? Took me a few hours. What was the fuss about?"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"zrok-vpn-future",children:"zrok VPN future"}),"\n",(0,s.jsx)(n.p,{children:"The initial zrok VPN release is somewhat simple and minimal. It currently provides only a host-to-host VPN functionality. We have some ideas how we want to continue improving it: better routing support, DNS, VPN mesh, mobile client -- are just some of them."}),"\n",(0,s.jsx)(n.p,{children:"Please give it a try and let us know how you like it, what features you want to see, and, of course, any bugs that you encounter."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Reach us on ",(0,s.jsx)(n.a,{href:"https://openziti.discourse.group/",children:"Discourse"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Check out (and star!) our repos: ",(0,s.jsx)(n.a,{href:"https://github.com/openziti/zrok",children:"zrok"}),", ",(0,s.jsx)(n.a,{href:"https://github.com/openziti/ziti",children:"ziti"}),", and ",(0,s.jsx)(n.a,{href:"https://github.com/openziti",children:"more"})]}),"\n"]}),"\n"]})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var o=t(96540);const s={},r=o.createContext(s);function i(e){const n=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),o.createElement(r.Provider,{value:n},e.children)}},88693:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/zrok-vpn","source":"@site/blog/zrok-vpn.md","title":"zrok VPN","description":"The latest version of zrok has a new capability -- host-to-host VPN tunnel.","date":"2024-05-21T15:17:50.000Z","tags":[{"inline":false,"label":"Zero Trust","permalink":"/docs/openziti/blog/tags/zerotrust","description":"Zero Trust Networking"},{"inline":false,"label":"zrok","permalink":"/docs/openziti/blog/tags/zrok","description":"zrok related content"}],"readingTime":2.99,"hasTruncateMarker":true,"authors":[{"name":"Eugene Kobyakov","title":"Author","url":"https://github.com/ekoby","imageURL":"https://avatars.githubusercontent.com/ekoby","key":"EugeneKobyakov","page":null}],"frontMatter":{"title":"zrok VPN","date":"2024-05-21T15:17:50.000Z","cuid":"clwgjhize000d0ck18y703n52","slug":"zrok-vpn","authors":["EugeneKobyakov"],"image":"@site/blogs/openziti/v1716212137599/451cee0f-8d37-4ab2-8548-8a62b42656af.png","imageDark":"@site/blogs/openziti/v1716212137599/451cee0f-8d37-4ab2-8548-8a62b42656af.png","tags":["zerotrust","zrok"]},"unlisted":false,"prevItem":{"title":"How to Prevent Path Traversal Attacks with OpenZiti BrowZer","permalink":"/docs/openziti/blog/how-to-prevent-path-traversal-attacks-with-openziti-browzer"},"nextItem":{"title":"Deploy OpenZiti in Kubernetes with Ease Using k3d","permalink":"/docs/openziti/blog/deploy-openziti-in-kubernetes-with-ease-using-k3d"}}')}}]);