"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[22619],{45738:(e,o,s)=>{s.r(o),s.d(o,{assets:()=>a,contentTitle:()=>c,default:()=>d,frontMatter:()=>r,metadata:()=>i,toc:()=>l});var i=s(74256),n=s(74848),t=s(28453);const r={title:"Jitsi, meet zrok",date:new Date("2024-07-31T18:25:02.000Z"),cuid:"clza6fr0v000608l2cnqjamv9",slug:"jitsi-meet-zrok",authors:["KennethBingham"],image:"@site/blogs/openziti/v1722450203675/ee7c2e5c-4ef2-46e7-a05d-767cf2e7ab58.png",imageDark:"@site/blogs/openziti/v1722450203675/ee7c2e5c-4ef2-46e7-a05d-767cf2e7ab58.png",tags:["self-hosted"]},c=void 0,a={authorsImageUrls:[void 0]},l=[{value:"Why zrok?",id:"why-zrok",level:2},{value:"Orientation",id:"orientation",level:2},{value:"The Steps",id:"the-steps",level:2},{value:"zrok frontdoor",id:"zrok-frontdoor",level:2},{value:"Relatedly",id:"relatedly",level:2},{value:"Share the Project",id:"share-the-project",level:2}];function h(e){const o={a:"a",code:"code",h2:"h2",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",...(0,t.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.a,{href:"https://jitsi.github.io/handbook/",children:"Jitsi Meet"})," is an open-source video conferencing server. I've wanted to run Jitsi behind zrok and ",(0,n.jsx)(o.a,{href:"https://openziti.discourse.group/t/local-jitsi-meet-zrok/2900/4?u=qrkourier",children:"someone asked about it today in the forum"})," and we got it working! Here's how I conveniently self-host Jitsi with zrok."]}),"\n",(0,n.jsx)(o.h2,{id:"why-zrok",children:"Why zrok?"}),"\n",(0,n.jsxs)(o.p,{children:[(0,n.jsx)(o.a,{href:"https://zrok.io",children:"zrok.io"})," makes it easy to self-host web applications while obscuring your real public IP and protecting your private network. Your visitors will see a trusted certificate with the name ",(0,n.jsx)(o.code,{children:"*.share.zrok.io"})," provided by zrok.io as a service when they visit your Jitsi Meet instance's public URL."]}),"\n",(0,n.jsx)(o.p,{children:"Jitsi Meet requires a trusted certificate for WebRTC, so zrok.io also spares you the chore of issuing, renewing, and configuring a TLS server certificate for Jitsi."}),"\n",(0,n.jsx)(o.h2,{id:"orientation",children:"Orientation"}),"\n",(0,n.jsxs)(o.p,{children:["You only need Docker to follow this tutorial. There's nothing else to install. You can use this guide with a free account from ",(0,n.jsx)(o.a,{href:"https://zrok.io",children:"zrok.io"})," or a ",(0,n.jsx)(o.a,{href:"https://docs.zrok.io/docs/guides/self-hosting/docker/",children:"self-hosted zrok instance"}),"."]}),"\n",(0,n.jsx)(o.p,{children:"Jitsi Meet's Docker Compose project is pre-configured to publish the container ports to the Docker Host's external interfaces. Typically, that is necessary so they are reachable by clients."}),"\n",(0,n.jsxs)(o.p,{children:["zrok works differently and does not need the ports to be published externally. Instead, zrok runs inside the Compose project on the ",(0,n.jsx)(o.code,{children:"meet.jitsi"})," bridge network. zrok will proxy the traffic securely to the containers' internal ports, so we'll override the forwarded, published ports, exposing them only inside the Compose project."]}),"\n",(0,n.jsx)(o.h2,{id:"the-steps",children:"The Steps"}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Follow ",(0,n.jsx)(o.a,{href:"https://jitsi.github.io/handbook/docs/devops-guide/devops-guide-docker/#quick-start",children:"Jitsi's Docker Quickstart"})," and wait to run ",(0,n.jsx)(o.code,{children:"docker compose up"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["In your terminal, change to the directory where you have created these Jitsi quickstart files: ",(0,n.jsx)(o.code,{children:".env"})," and ",(0,n.jsx)(o.code,{children:"docker-compose.yml"}),"."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Download the zrok ",(0,n.jsx)(o.a,{href:"https://docs.zrok.io/zrok-public-reserved/compose.yml",children:"public share compose example"})," and save it as the filename ",(0,n.jsx)(o.code,{children:"docker-compose.zrok.yml"})," in the same directory."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Add the following YAML as the filename ",(0,n.jsx)(o.code,{children:"docker-compose.override.yml"})," in the same directory."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-yaml",children:"services:\n  web:\n    ports: !override []\n  jicofo:\n    ports: !override []\n  jvb:\n    ports: !override []\n  zrok-share:\n    networks:\n      meet.jitsi:\n"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:"Think of a name for your self-hosted Jitsi Meet instance. You will use it in the next step to define the unique name of the zrok share which is part of the public URL. The name must be 4-32 lowercase letters or numbers."}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Save the following variable assignments as the filename ",(0,n.jsx)(o.code,{children:".env.zrok"})," in the same directory."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:'PUBLIC_URL="https://myjitsi.share.zrok.io"  # subdomain must match ZROK_UNIQUE_NAME\nZROK_UNIQUE_NAME="myjitsi"                  # must match PUBLIC_URL subdomain\nZROK_ENABLE_TOKEN="ix9XrvQt13Rf"            # zrok account token from console\nZROK_ENVIRONMENT_NAME="jitsi-zrok-compose"  # name for the environment in the console graph\nZROK_API_ENDPOINT="https://api.zrok.io"     # must be set to the zrok API you\'re using\nZROK_TARGET="https://web:443"               # this is correct for the web container\'s internal port\nZROK_INSECURE="--insecure"                  # let zrok skip cert verification for the internal web:443 target\n'})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Optionally, turn on OAuth for this Jitsi Meet instance with zrok. Add the following to the ",(0,n.jsx)(o.code,{children:".env.zrok"})," file (",(0,n.jsx)(o.a,{href:"https://docs.zrok.io/docs/guides/docker-share/docker_public_share_guide/",children:"Docker public share guide has more info"}),")."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:'ZROK_OAUTH_PROVIDER="google"  # google, github\n# space-separated list email patterns verified by the provider\nZROK_OAUTH_EMAILS="alice.example@gmail.com *@acme.example.com"\n'})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Save the following script as the filename ",(0,n.jsx)(o.code,{children:"compose.bash"})," in the same directory. This script configures the compose project and environment files."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:'\nexport COMPOSE_FILE="docker-compose.yml:docker-compose.zrok.yml:docker-compose.override.yml"\nexport COMPOSE_ENV_FILES=".env,.env.zrok"\n\ndocker compose  "${@}"\n'})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:"Ensure you have all the necessary files."}),"\n",(0,n.jsxs)(o.ol,{children:["\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:"docker-compose.yml"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:"docker-compose.zrok.yml"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:"docker-compose.override.yml"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:".env"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:".env.zrok"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.code,{children:"compose.bash"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsx)(o.p,{children:"Run Jitsi and zrok."}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"bash ./compose.bash up\n"})}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["Open Jitsi in a web browser at the address from the ",(0,n.jsx)(o.code,{children:"PUBLIC_URL"})," environment variable, e.g., ",(0,n.jsx)(o.code,{children:"https://myjitsi.share.zrok.io"})," ."]}),"\n"]}),"\n",(0,n.jsxs)(o.li,{children:["\n",(0,n.jsxs)(o.p,{children:["If you need to change the name, authentication, etc. you can delete the environment in the zrok web console and delete the Docker volumes like this to start over. It's also possible to make surgical changes if you don't want to start over. ",(0,n.jsx)(o.a,{href:"https://openziti.discourse.group/",children:"Ask for help in Discourse"}),"."]}),"\n",(0,n.jsx)(o.pre,{children:(0,n.jsx)(o.code,{className:"language-bash",children:"bash ./compose.bash down --volumes\n"})}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(o.h2,{id:"zrok-frontdoor",children:"zrok frontdoor"}),"\n",(0,n.jsxs)(o.p,{children:["This tutorial for Jitsi Meet is a great example of ",(0,n.jsx)(o.a,{href:"https://docs.zrok.io/docs/guides/frontdoor/?os=Docker",children:"zrok frontdoor"}),". zrok frontdoor brings many advantages for self-hosters and is always enabled when using zrok.io as a service with a production-ready service like this zrok public share in Docker. zrok.io users enjoy additional shielding for their Jitsi Meet public URL."]}),"\n",(0,n.jsx)(o.h2,{id:"relatedly",children:"Relatedly"}),"\n",(0,n.jsxs)(o.p,{children:["zrok is built with OpenZiti. Here's ",(0,n.jsx)(o.a,{href:"https://medium.com/netfoundry/tunneling-voip-over-openziti-69d6487605e4",children:"another post about running an Asterisk PBX without published ports"}),", just as your Jitsi Meet instance has no open ports on the Docker Host's outward-facing interfaces."]}),"\n",(0,n.jsx)(o.h2,{id:"share-the-project",children:"Share the Project"}),"\n",(0,n.jsx)(o.p,{children:(0,n.jsx)(o.img,{src:s(53854).A+"",width:"300",height:"300"})}),"\n",(0,n.jsxs)(o.p,{children:["If you find this interesting, please consider ",(0,n.jsx)(o.a,{href:"https://github.com/openziti/ziti/",children:(0,n.jsx)(o.strong,{children:"starring us on GitHub"})}),". It helps. Let us know if you found a good use for this or have an improvement or question in mind on ",(0,n.jsx)(o.a,{href:"https://twitter.com/openziti",children:(0,n.jsxs)(o.strong,{children:["X ",(0,n.jsx)("s",{children:"twitter"})]})}),", in ",(0,n.jsx)(o.a,{href:"https://www.reddit.com/r/openziti/",children:"/r/openziti"}),", or the ",(0,n.jsx)(o.a,{href:"https://openziti.discourse.group/",children:"Discourse forum"}),". We upload and stream ",(0,n.jsx)(o.a,{href:"https://youtube.com/openziti",children:(0,n.jsx)(o.strong,{children:"on YouTube"})})," too. We'd love to hear from you!"]})]})}function d(e={}){const{wrapper:o}={...(0,t.R)(),...e.components};return o?(0,n.jsx)(o,{...e,children:(0,n.jsx)(h,{...e})}):h(e)}},53854:(e,o,s)=>{s.d(o,{A:()=>i});const i=s.p+"assets/images/7bb2b76c-af3f-45c6-83ab-d519f183024d-905dcc2bc7ef9850c54417500e23d7fa.png"},28453:(e,o,s)=>{s.d(o,{R:()=>r,x:()=>c});var i=s(96540);const n={},t=i.createContext(n);function r(e){const o=i.useContext(t);return i.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function c(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:r(e.components),i.createElement(t.Provider,{value:o},e.children)}},74256:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/jitsi-meet-zrok","source":"@site/blog/jitsi-meet-zrok.md","title":"Jitsi, meet zrok","description":"Jitsi Meet is an open-source video conferencing server. I\'ve wanted to run Jitsi behind zrok and someone asked about it today in the forum and we got it working! Here\'s how I conveniently self-host Jitsi with zrok.","date":"2024-07-31T18:25:02.000Z","tags":[{"inline":false,"label":"Self Hosted","permalink":"/docs/openziti/blog/tags/self-hosted","description":"Self-hosted setups"}],"readingTime":4.33,"hasTruncateMarker":true,"authors":[{"name":"Kenneth Bingham","title":"Author","url":"https://github.com/qrkourier","imageURL":"https://avatars.githubusercontent.com/qrkourier","key":"KennethBingham","page":null}],"frontMatter":{"title":"Jitsi, meet zrok","date":"2024-07-31T18:25:02.000Z","cuid":"clza6fr0v000608l2cnqjamv9","slug":"jitsi-meet-zrok","authors":["KennethBingham"],"image":"@site/blogs/openziti/v1722450203675/ee7c2e5c-4ef2-46e7-a05d-767cf2e7ab58.png","imageDark":"@site/blogs/openziti/v1722450203675/ee7c2e5c-4ef2-46e7-a05d-767cf2e7ab58.png","tags":["self-hosted"]},"unlisted":false,"prevItem":{"title":"Easy Steps to Install a Private VPN on Linux with zrok","permalink":"/docs/openziti/blog/zrok-vpn-linux-service"},"nextItem":{"title":"Extend Access to a Private S3 Bucket Using Python","permalink":"/docs/openziti/blog/extend-access-to-a-private-s3-bucket-using-python"}}')}}]);