"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[73568],{17912:(e,t,i)=>{i.r(t),i.d(t,{assets:()=>h,contentTitle:()=>o,default:()=>p,frontMatter:()=>s,metadata:()=>a,toc:()=>c});var a=i(45558),n=i(74848),r=i(28453);const s={title:"Bootstrapping Trust Part 2 - PKI",date:new Date("2022-06-03T12:42:37.000Z"),cuid:"cl3yfsb8900joemnv4jk46g98",slug:"bootstrapping-trust-part-2-a-primer-on-public-key-cryptography",authors:["AndrewMartinez"],image:"@site/blogs/openziti/v1654265273968/JSUhAzpL_.jpeg",imageDark:"@site/blogs/openziti/v1654265273968/JSUhAzpL_.jpeg",tags:["security"]},o=void 0,h={authorsImageUrls:[void 0]},c=[{value:"Keys",id:"keys",level:3},{value:"Public Key Encryption",id:"public-key-encryption",level:4},{value:"Private Key Encryption",id:"private-key-encryption",level:4},{value:"Digital Signatures",id:"digital-signatures",level:3}];function l(e){const t={a:"a",code:"code",h1:"h1",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.p,{children:"If you have read through the entire series up to here, welcome! If you have not, please consider reading the whole series:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-1-encryption-everywhere",children:"Part 1: Encryption Everywhere"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-2-a-primer-on-public-key-cryptography",children:"Part 2: A Primer On Public-Key Cryptography"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-3-certificates",children:"Part 3: Certificates"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-4-certificate-authorities-chains-of-trust",children:"Part 4: Certificate Authorities & Chains Of Trust"})}),"\n",(0,n.jsx)(t.li,{children:(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-5-bootstrapping-trust",children:"Part 5: Bootstrapping Trust"})}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"It isn't easy to talk about bootstrapping trust without covering the basics of public-key cryptography. The reader may skip this article if the concepts of encryption, signing, and public/private keys are familiar. However, if not, I implore that you bear the brunt of this article as later parts will heavily rely on it."}),"\n",(0,n.jsx)(t.p,{children:"If you wish, you can dive into the mathematics behind it to prove it to yourself, but I promise, no math here. When necessary, I will wave my hands at it, point into the distance, and let the reader journey out."}),"\n",(0,n.jsx)(t.h3,{id:"keys",children:"Keys"}),"\n",(0,n.jsx)(t.p,{children:'Keys are blobs of data containing rather large numbers. They can be stored anywhere data can be stored, but are commonly stored as files. A set of public and private keys is referred to as a "key set" or "key pair."'}),"\n",(0,n.jsx)(t.p,{children:'Within a key pair, there is only one private key and one public key. The two keys are mathematically entangled, given a particular function and its parameters. Today, those functions and parameters are generally elliptical curves and are the basis of a "trapdoor function." Trapdoor functions are attractive to the cryptographically inclined for two main reasons:'}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"they make it easy to encrypt with one key of a key pair and decrypt with the other."}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"one key cannot be derived from the other"}),"\n"]}),"\n"]}),"\n",(0,n.jsxs)(t.p,{children:["Of the two keys, the private key is the most important. It must be kept tucked away from prying eyes and attackers. Some secure environments store the private key in hardware such as ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Hardware_security_module",children:"Hardware Security Modules (HSMs)"})," or ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Trusted_Platform_Module",children:"Trusted Platform Modules (TPMs)"}),". Mobile devices, such as laptops and smartphones, use hardware technology similar to TPMs. Apple has its Secure Enclave, and Android has its Keymaster Hardware Abstraction Layer. The goal of all of these pieces of hardware is to keep sensitive secrets (e.g., private keys) safe. The fact that an entire industry of embedded hardware has been developed to keep private keys safe should tip the reader off to how important they are."]}),"\n",(0,n.jsx)(t.p,{children:"As stated above, these two keys have some impressive capabilities. It is not possible to derive one from the other. This allows the public key to be handed out freely without compromising the private key. Also, both keys can generate encrypted data that only the other key can decrypt. More clearly:"}),"\n",(0,n.jsxs)(t.ol,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Anyone with the public key can encrypt data only the private key holder can decrypt"}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Anyone with the public key can decrypt data from the private key holder"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:'Number one can succinctly be called "Public Key Encryption" and number two "Private Key Encryption." This article explores the merits of both.'}),"\n",(0,n.jsx)(t.h4,{id:"public-key-encryption",children:"Public Key Encryption"}),"\n",(0,n.jsx)(t.p,{children:'From the list above, number one is what most people think of as "encryption." It is "secure" as it allows anyone with the widely available public key to send messages only the private key holder can read. This property ensures that communication from the public key holder to the private key holder is being read exclusively by the intended target.'}),"\n",(0,n.jsx)(t.p,{children:"There is quite a bit of pressure to keep the private key extremely safe. Whoever holds the private key, has a guaranteed identity that is tied to and verifiable by the public key. It is verifiable because if one can use the public key to encrypt data, only the private key holder can decrypt it. This fact means that data can be encrypted and sent that coordinates on an additional secret. Since only the private key holder can decrypt the data to see this second level secret, future communication can use the new secret to encrypted and verify traffic in both directions. This additional exchange is roughly how part of the TLS negotiation works for HTTPs. TLS, and by proxy HTTPS, use other technologies and strategies to provide an incredible security proposition."}),"\n",(0,n.jsx)(t.h4,{id:"private-key-encryption",children:"Private Key Encryption"}),"\n",(0,n.jsx)(t.p,{children:"For private key encryption, the same principles apply as with public key encryption with the roles reversed. The private key encrypts data only the public key can decrypt. On the surface, this seems absurd. When the server encrypts data with its private key, the public key can decrypt it. The public key is not protected and expected to be widely available. It seems as if private key encryption is nearly useless as everyone can read it!"}),"\n",(0,n.jsx)(t.p,{children:'Except it isn\'t. Private key encryption verifies the identity of the private key holder. The public key cannot interact with anyone else. Additionally, this property allows us to generate encrypted data that could only have come from the private key holder. If that data happens to be small and describe another document, we call that a "digital signature" or "signature" for short.'}),"\n",(0,n.jsx)(t.h3,{id:"digital-signatures",children:"Digital Signatures"}),"\n",(0,n.jsx)(t.p,{children:"Digital signatures are similar to handwritten ones used to sign legal documents and checkbooks, but with a significant advantage. They validate that a document has not been altered since it was signed. With today's computer's graphical abilities, the nefarious can forge images and handwritten signatures. That puts handwritten signatures at a significant disadvantage. So how does this work?"}),"\n",(0,n.jsxs)(t.p,{children:["The data that will be signed can be anything. What it represents is not important. It can be text, JSON, an image, a PDF, or anything at all! That data is processed by a one-way ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/Cryptographic_hash_function",children:"cryptographic hashing algorithm"}),", such as SHA-256. This process is idempotent, meaning running it repeatedly on the same data, parameters, and hashing algorithm gives the same result. The output of this process is a hash, a string of characters that uniquely identifies the input data. With sufficiently large input data, the hash is much shorter than the input data as the hash size is usually fixed length."]}),"\n",(0,n.jsx)(t.p,{children:"For example, here is the Ziti logo:"}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.img,{src:i(5439).A+"",width:"300",height:"300"})}),"\n",(0,n.jsxs)(t.p,{children:["This logo's file can be hashed using SHA-256 via the ",(0,n.jsx)(t.code,{children:"sha256sum"})," command commonly found on Linux."]}),"\n",(0,n.jsx)(t.p,{children:(0,n.jsx)(t.code,{children:"c3a6681cc81f9c0fa44b3e2921495882c55f0a86c54cd60ee0fdc7d200ad26db="})}),"\n",(0,n.jsx)(t.p,{children:'That long string "c3a....6db" is the hash of that file! The string is 64 characters long and is comprised of hex characters (a base 16 numbering system of 0-9 and a-f). Each character takes four bits to represent (4^2 = 16). Since there are 64 characters at 4 bits each we have: 64 x 4 = 256. This is where SHA-256 gets its name. SHA-256 is a fixed-length cryptographic hashing algorithm who\'s output is 256 bits in length.'}),"\n",(0,n.jsx)(t.p,{children:'The hash itself is not encryption. It is "hashing." Hashing of this nature is not reversible while encryption is. For cryptographic hashing, it is impracticable to have two similar sets of data that have the same function that produces the same hash. In essence, the hash uniquely represents the data: all of it! Changing even a single character would generate a different hash.'}),"\n",(0,n.jsx)(t.p,{children:"After hashing a data or document, the private key holder can encrypt the hash to generate a signature. This process provides the following truths when working with the signature:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"the private key is the only key capable of producing its signature of the data's hash"}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"the public key can validate the signature given the data and hashing algorithm used"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Verifying a signature a straightforward process:"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Use the public key to decrypt the signature to reveal the original hash"}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Use the hashing algorithm that was used initially on the data, recreate the hash independently"}),"\n"]}),"\n",(0,n.jsxs)(t.li,{children:["\n",(0,n.jsx)(t.p,{children:"Compare the two hashes, and if they are the same the signature is valid"}),"\n"]}),"\n"]}),"\n",(0,n.jsx)(t.p,{children:"Signing data is incredibly powerful. It allows a private key holder to state that data was approved by them and not altered. It is also publicly verifiable to anyone with the document, signature, and public key. This allows many decentralized approaches to sharing data that can have its source and content verified."}),"\n",(0,n.jsxs)(t.p,{children:["Bearer tokens are an example of the power of signatures. Bearer tokens are a document that is signed by a trusted authentication system and contain data that provides information about the client presenting the token. Signing the token ensures that the content of the token has not been changed and has been endorsed by a trusted system. An example of a bearer token is a ",(0,n.jsx)(t.a,{href:"https://en.wikipedia.org/wiki/JSON_Web_Token",children:"JSON Web Token (JWT)"})]}),"\n",(0,n.jsx)(t.p,{children:"A JWT specifies the format of the bearer token as a header, payload, and signature using JSON. A client can then present a JWT to any system which can then verify that the contents are valid and from a trusted identity. As long as the signature is valid, the JWT can grant access to the client presenting it based on whatever information is inside the JWT."}),"\n",(0,n.jsx)(t.h1,{id:"closing",children:"Closing"}),"\n",(0,n.jsxs)(t.p,{children:["This article should have shed light on public-key cryptography by explaining the roles of the public and private keys. It should have also provided a glimpse at the power of encryption and digital signatures. In ",(0,n.jsx)(t.a,{href:"/docs/openziti/blog/bootstrapping-trust-part-3-certificates",children:"part three"})," we will see how key pairs can be combined with certificates!"]})]})}function p(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(l,{...e})}):l(e)}},5439:(e,t,i)=>{i.d(t,{A:()=>a});const a=i.p+"assets/images/kPJ_N4wis-c087753216fe4284e035631308a7b05c.png"},28453:(e,t,i)=>{i.d(t,{R:()=>s,x:()=>o});var a=i(96540);const n={},r=a.createContext(n);function s(e){const t=a.useContext(r);return a.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:s(e.components),a.createElement(r.Provider,{value:t},e.children)}},45558:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/bootstrapping-trust-part-2-a-primer-on-public-key-cryptography","source":"@site/blog/bootstrapping-trust-part-2.md","title":"Bootstrapping Trust Part 2 - PKI","description":"If you have read through the entire series up to here, welcome! If you have not, please consider reading the whole series:","date":"2022-06-03T12:42:37.000Z","tags":[{"inline":false,"label":"Security","permalink":"/docs/openziti/blog/tags/security","description":"Security-related posts"}],"readingTime":7.76,"hasTruncateMarker":true,"authors":[{"name":"Andrew Martinez","title":"Author","url":"https://github.com/andrewpmartinez","imageURL":"https://avatars.githubusercontent.com/andrewpmartinez","key":"AndrewMartinez","page":null}],"frontMatter":{"title":"Bootstrapping Trust Part 2 - PKI","date":"2022-06-03T12:42:37.000Z","cuid":"cl3yfsb8900joemnv4jk46g98","slug":"bootstrapping-trust-part-2-a-primer-on-public-key-cryptography","authors":["AndrewMartinez"],"image":"@site/blogs/openziti/v1654265273968/JSUhAzpL_.jpeg","imageDark":"@site/blogs/openziti/v1654265273968/JSUhAzpL_.jpeg","tags":["security"]},"unlisted":false,"prevItem":{"title":"Bootstrapping Trust Part 3 - Certificates","permalink":"/docs/openziti/blog/bootstrapping-trust-part-3-certificates"},"nextItem":{"title":"Bootstrapping Trust Part 1 - Encryption Everywhere","permalink":"/docs/openziti/blog/bootstrapping-trust-part-1-encryption-everywhere"}}')}}]);