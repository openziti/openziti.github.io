"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[6004],{88575:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>c,default:()=>p,frontMatter:()=>r,metadata:()=>t,toc:()=>l});var t=i(67923),s=i(74848),o=i(28453);const r={title:"OpenZiti Python SDK: Introduction",seoDescription:"Build your next Python application with embedded zero trust networking using OpenZiti SDK",date:new Date("2022-09-20T17:51:44.000Z"),cuid:"cl8ahtom3080fu5nv6bxr6ylc",slug:"openziti-python-sdk-introduction",authors:["EugeneKobyakov"],image:"@site/blogs/openziti/v1663698832345/Nj2I2jCi0.jpg",imageDark:"@site/blogs/openziti/v1663698832345/Nj2I2jCi0.jpg",tags:["python","opensource","sdk","openziti"]},c="Ziti Python SDK: Intro",d={authorsImageUrls:[void 0]},l=[{value:"Setup",id:"setup",level:2},{value:"Acquiring SDK",id:"acquiring-sdk",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Ziti identity enrollment",id:"ziti-identity-enrollment",level:3},{value:"Open connection to Ziti service",id:"open-connection-to-ziti-service",level:3},{value:"Host(serve) Ziti service",id:"hostserve-ziti-service",level:3},{value:"It&#39;s 2022: WDIMMOS*?!!",id:"its-2022-wdimmos",level:2},{value:"Client Side",id:"client-side",level:3},{value:"Server Side",id:"server-side",level:3},{value:"Next Steps",id:"next-steps",level:2}];function a(e){const n={a:"a",code:"code",em:"em",h2:"h2",h3:"h3",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"OpenZiti project adds security layers that make your service available without exposing incoming ports, provides identity-specific end-to-end encryption, masks your network traffic protocols/ports, and allows developers to be more agile and secure than ever in all networking scenarios."}),"\n",(0,s.jsxs)(n.p,{children:["In our previous posts, we introduced the concept of ",(0,s.jsx)(n.a,{href:"https://openziti.io/docs/reference/glossary/#zitification-zitified-zitify",children:"Zitification"})," -- taking an app and changing it to use a secure, zero-trust, overlay network -- and shared a ",(0,s.jsx)(n.a,{href:"/docs/openziti/blog/zitifying-ssh",children:"few"})," ",(0,s.jsx)(n.a,{href:"/docs/openziti/blog/zitifying-scp",children:"examples"})," we developed internally."]}),"\n",(0,s.jsxs)(n.p,{children:["This article will show how to ",(0,s.jsx)(n.em,{children:"zitify"})," your Python applications with minor code changes."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"Ziggy Loves Python.jpg",src:i(54898).A+"",width:"2770",height:"3090"})}),"\n",(0,s.jsx)(n.h2,{id:"setup",children:"Setup"}),"\n",(0,s.jsx)(n.p,{children:"There are several ways to get started with OpenZiti."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"follow instructions from previous posts"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["read ",(0,s.jsx)(n.a,{href:"https://openziti.github.io/ziti/quickstarts/quickstart-overview.html",children:"quickstart"})," docs"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["and even play in our ",(0,s.jsx)(n.a,{href:"https://zeds.openziti.org",children:"sandbox/ZEDS"})," -- fastest way to start. Ziti Edge Developer Sandbox(ZEDS) hosts a multi-tenant Ziti network."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"acquiring-sdk",children:"Acquiring SDK"}),"\n",(0,s.jsxs)(n.p,{children:["OpenZiti Python SDK is published to Python Package Index(PyPI) so just go ahead with standard install, or add it to your application's ",(0,s.jsx)(n.code,{children:"requirements.txt"})]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-pycon",children:"$ pip install openziti\n"})}),"\n",(0,s.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,s.jsxs)(n.p,{children:["In the following code examples the following is assumed (read more about Ziti ",(0,s.jsx)(n.a,{href:"https://openziti.io/docs/learn/core-concepts/identities/overview",children:"identities"})," and ",(0,s.jsx)(n.a,{href:"https://openziti.io/docs/learn/core-concepts/services/overview",children:"services"}),"):"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"id.jwt"})," - enrollment token file"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"id.json"})," - ziti identity file"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"best-service-ever"})," - name of the ziti service"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"ziti-identity-enrollment",children:"Ziti identity enrollment"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-pycon",children:"$ python -m openziti enroll --jwt id.jwt --identity id.json\n"})}),"\n",(0,s.jsx)(n.h3,{id:"open-connection-to-ziti-service",children:"Open connection to Ziti service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import openziti\n\n# load ziti context, provide full path to identity file if needed\nztx = openziti.load('id.json')\n\nconn = ztx.connect('best-service-ever')\n\n# do cool stuff here with conn (socket)\n"})}),"\n",(0,s.jsxs)(n.p,{children:["you can also connect with an intercepted address (each service may have one or more standard network address ",(0,s.jsx)(n.code,{children:"[protocol, host, port]"}),"):"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"conn = ztx.connect(('httpbin.ziti', 80))\n"})}),"\n",(0,s.jsx)(n.h3,{id:"hostserve-ziti-service",children:"Host(serve) Ziti service"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import openziti\n\nztx = openziti.load(ziti_id)\nserver = ztx.bind(service)\nserver.listen()\n\nwhile True:\n    # conn is the incoming connection(socket)\n    # peer is a tuple (connecting identity, 0)\n    conn, peer = server.accept()\n    \n    # do some cool interaction with your client\n"})}),"\n",(0,s.jsx)(n.h2,{id:"its-2022-wdimmos",children:"It's 2022: WDIMMOS*?!!"}),"\n",(0,s.jsxs)(n.p,{children:["*",(0,s.jsx)(n.code,{children:"WDIMMOS"}),": why do I manage my own sockets"]}),"\n",(0,s.jsx)(n.p,{children:"Obviously when you develop your cool Python application you probably would not start with writing your own networking layer. Instead, you'd use excellent networking capabilities of Python standard library or other modules to do networking for you. The good news is that you can use OpenZiti SDK with other networking modules."}),"\n",(0,s.jsx)(n.h3,{id:"client-side",children:"Client Side"}),"\n",(0,s.jsxs)(n.p,{children:["For example, let's say you want to make an HTTP request with ",(0,s.jsx)(n.code,{children:"requests"}),", ",(0,s.jsx)(n.code,{children:"urllib3"}),", or even ",(0,s.jsx)(n.code,{children:"urllib"}),":"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import requests\n\nr = requests.get('http://httpbin.org/json')\nprint(r.headers)\nprint(r.json())\n"})}),"\n",(0,s.jsxs)(n.p,{children:["In order to make ",(0,s.jsx)(n.code,{children:"requests"})," library use Ziti socket, we ",(0,s.jsx)(n.a,{href:"https://en.wikipedia.org/wiki/Monkey_patch",children:(0,s.jsx)(n.code,{children:"monkeypatch"})})," the code. In this case you can ",(0,s.jsx)(n.code,{children:"request"}),"(get it?) with an intercepted address."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"import requests\nimport openziti\n\nztx = openziti.load('id.json')\n\nwith openziti.monkeypatch():\n    # FIY, httpbin.ziti is a common service you can use in our sandbox\n    r = requests.get('http://httpbin.ziti/json')\n    print(r.headers)\n    print(r.json())\n"})}),"\n",(0,s.jsx)(n.h3,{id:"server-side",children:"Server Side"}),"\n",(0,s.jsxs)(n.p,{children:["On the hosting server side we need inform the monkey patching code what it needs to do when underlying networking code binds to an address. This is done via ",(0,s.jsx)(n.code,{children:"bindings"})," parameter to the ",(0,s.jsx)(n.code,{children:"monkeypatch()"})," method. The value must be a map from network address(host, port) to the Ziti context/service -- like this:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import sys\nfrom http.server import BaseHTTPRequestHandler, HTTPServer\nimport openziti\n\nclass MyServer(BaseHTTPRequestHandler):\n    def do_GET(self):\n        self.send_response(200)\n        self.send_header("Content-type", "application/json")\n        self.end_headers()\n        msg = """{"msg": "Hello! Have some ziti!"}"""\n        self.wfile.write(bytes(msg, "utf-8"))\n\nif __name__ == "__main__":\n    bind_addr = (\'localhost\', 8080)\n    srv_addr = {\n        ztx: \'id.json\',\n        service: \'best-service-ever\'\n    }\n    # map network bind address to Ziti Service target\n    bind_map = { bind_addr: srv_addr }\n\n    openziti.monkeypatch(bindings=bind_map)\n    webServer = HTTPServer(bind_addr, MyServer)\n    webServer.serve_forever(poll_interval=600)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsxs)(n.p,{children:["We would love to hear from you about your applications and if decide that ",(0,s.jsx)(n.a,{href:"https://github.com/openziti/ziti",children:"OpenZiti"})," is the right fit to secure them."]}),"\n",(0,s.jsx)(n.p,{children:"Checkout some of our projects that use OpenZiti Python SDK:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"./my-intern-assignment-call-a-dark-webhook-from-aws-lambda",children:"Call a Dark Webhook from AWS Lambda"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/openziti-test-kitchen/ansible-paramikoz-demo",children:"Zitified Ansible/Paramiko"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Follow us:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Python SDK ",(0,s.jsx)(n.a,{href:"https://github.com/openziti/ziti-sdk-py",children:"repo"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Main OpenZiti ",(0,s.jsx)(n.a,{href:"https://github.com/openziti/ziti",children:"repo"})," - give us a star!"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Join ",(0,s.jsx)(n.a,{href:"https://openziti.discourse.group/",children:"discussion"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Follow ",(0,s.jsx)(n.a,{href:"https://twitter.com/openziti",children:"@openziti"})]}),"\n"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},54898:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/aDQdNSiXW-ef4991ee3099cd94fdcdb31343b1d192.jpg"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(96540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}},67923:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/openziti-python-sdk-introduction","source":"@site/blog/openziti-python-sdk-introduction.md","title":"OpenZiti Python SDK: Introduction","description":"OpenZiti project adds security layers that make your service available without exposing incoming ports, provides identity-specific end-to-end encryption, masks your network traffic protocols/ports, and allows developers to be more agile and secure than ever in all networking scenarios.","date":"2022-09-20T17:51:44.000Z","tags":[{"inline":false,"label":"Python","permalink":"/docs/openziti/blog/tags/python","description":"Python content"},{"inline":false,"label":"Open Source","permalink":"/docs/openziti/blog/tags/opensource","description":"Open Source content"},{"inline":false,"label":"SDK","permalink":"/docs/openziti/blog/tags/sdk","description":"Software Development Kits"},{"inline":false,"label":"OpenZiti","permalink":"/docs/openziti/blog/tags/openziti","description":"OpenZiti related content"}],"readingTime":3.61,"hasTruncateMarker":true,"authors":[{"name":"Eugene Kobyakov","title":"Author","url":"https://github.com/ekoby","imageURL":"https://avatars.githubusercontent.com/ekoby","key":"EugeneKobyakov","page":null}],"frontMatter":{"title":"OpenZiti Python SDK: Introduction","seoDescription":"Build your next Python application with embedded zero trust networking using OpenZiti SDK","date":"2022-09-20T17:51:44.000Z","cuid":"cl8ahtom3080fu5nv6bxr6ylc","slug":"openziti-python-sdk-introduction","authors":["EugeneKobyakov"],"image":"@site/blogs/openziti/v1663698832345/Nj2I2jCi0.jpg","imageDark":"@site/blogs/openziti/v1663698832345/Nj2I2jCi0.jpg","tags":["python","opensource","sdk","openziti"]},"unlisted":false,"prevItem":{"title":"OpenZiti is Participating in Hacktoberfest, Prost!","permalink":"/docs/openziti/blog/openziti-is-participating-in-hacktoberfest-prost"},"nextItem":{"title":"Free Secure Access to NAS From Anywhere","permalink":"/docs/openziti/blog/free-secure-access-to-nas-from-anywhere"}}')}}]);