"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[754],{79811:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>l});const s=JSON.parse('{"id":"guides/troubleshooting/agent","title":"Interprocess Communication Agent","description":"The controller and router provide an IPC agent for administration. The agent listens on a Unix domain socket. Here\'s an example for querying the controller\'s agent for statistics.","source":"@site/docs/guides/troubleshooting/15-agent.mdx","sourceDirName":"guides/troubleshooting","slug":"/guides/troubleshooting/agent","permalink":"/docs/guides/troubleshooting/agent","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/troubleshooting/15-agent.mdx","tags":[],"version":"current","lastUpdatedAt":1757339600000,"sidebarPosition":15,"frontMatter":{"title":"Interprocess Communication Agent","sidebar_label":"Agent"},"sidebar":"docsSidebar","previous":{"title":"Troubleshooting","permalink":"/docs/category/troubleshooting"},"next":{"title":"Circuit Create Error Codes","permalink":"/docs/guides/troubleshooting/circuit-create-error-codes"}}');var i=t(74848),o=t(28453);const r={title:"Interprocess Communication Agent",sidebar_label:"Agent"},c=void 0,a={},l=[{value:"Accessing the Agent on Linux",id:"accessing-the-agent-on-linux",level:2},{value:"Accessing the Agent in Docker",id:"accessing-the-agent-in-docker",level:2},{value:"Accessing the Agent in Kubernetes",id:"accessing-the-agent-in-kubernetes",level:2}];function d(e){const n={code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.p,{children:"The controller and router provide an IPC agent for administration. The agent listens on a Unix domain socket. Here's an example for querying the controller's agent for statistics."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"ziti agent stats\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-buttonless",metastring:'title="Output"',children:"goroutines: 50\nOS threads: 22\nGOMAXPROCS: 16\nnum CPU: 16\n"})}),"\n",(0,i.jsx)(n.h2,{id:"accessing-the-agent-on-linux",children:"Accessing the Agent on Linux"}),"\n",(0,i.jsxs)(n.p,{children:["On Linux, the agent is listening inside the filesystem namespace managed by ",(0,i.jsx)(n.code,{children:"systemd"}),". You can enter the namespace with ",(0,i.jsx)(n.code,{children:"nsenter"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"systemctl show -p MainPID --value ziti-router.service \\\n| xargs -rIPID sudo nsenter --target PID --mount -- \\\n    ziti agent --help\n"})}),"\n",(0,i.jsx)(n.h2,{id:"accessing-the-agent-in-docker",children:"Accessing the Agent in Docker"}),"\n",(0,i.jsxs)(n.p,{children:["In Docker, the agent is listening inside the container filesystem. You can access the agent by running ",(0,i.jsx)(n.code,{children:"ziti"})," inside the running container."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:"docker compose exec ziti-controller ziti agent --help\n"})}),"\n",(0,i.jsx)(n.h2,{id:"accessing-the-agent-in-kubernetes",children:"Accessing the Agent in Kubernetes"}),"\n",(0,i.jsx)(n.p,{children:"Like Docker, the agent listens inside the container filesystem when running on Kubernetes."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-text",children:'kubectl -n ziti get pods --selector app.kubernetes.io/name=ziti-controller --output jsonpath="{.items[0].metadata.name}" \\\n| xargs -IPOD kubectl -n ziti -c ziti-controller exec POD -- \\\n    ziti agent --help\n'})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>c});var s=t(96540);const i={},o=s.createContext(i);function r(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(o.Provider,{value:n},e.children)}}}]);