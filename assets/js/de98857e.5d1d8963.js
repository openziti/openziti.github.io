"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[38396],{64356:(e,o,t)=>{t.r(o),t.d(o,{assets:()=>h,contentTitle:()=>a,default:()=>d,frontMatter:()=>i,metadata:()=>n,toc:()=>l});var n=t(61377),r=t(74848),s=t(28453);const i={title:"The Python zrok SDK",date:new Date("2024-02-29T20:30:28.000Z"),cuid:"clt7ojqne000009l55fwz4dgu",slug:"the-python-zrok-sdk",authors:["CameronOtts"],image:"@site/blogs/openziti/v1701893161134/a2cd088f-0260-4ce7-9ea2-26a1a97a23db.webp",imageDark:"@site/blogs/openziti/v1701893161134/a2cd088f-0260-4ce7-9ea2-26a1a97a23db.webp",tags:["python","openziti","zrok"]},a=void 0,h={authorsImageUrls:[void 0]},l=[{value:"Expanding into Python",id:"expanding-into-python",level:2},{value:"Why <strong>Though</strong>?",id:"why-though",level:2},{value:"Moving Forward",id:"moving-forward",level:2}];function c(e){const o={a:"a",br:"br",code:"code",h2:"h2",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(o.p,{children:["If you are reading this, hopefully, you are familiar with ",(0,r.jsx)(o.code,{children:"zrok"}),": an open source solution for easy and secure sharing\nbuilt on OpenZiti. If not you can check out this post ",(0,r.jsxs)(o.a,{href:"/docs/openziti/blog/introducing-zrok",children:["introducing ",(0,r.jsx)(o.code,{children:"zrok"})]}),".\nIf you have then that's great news! You might be familiar with the Golang SDK that was\n",(0,r.jsx)(o.a,{href:"/docs/openziti/blog/the-zrok-sdk",children:"recently released"}),"."]}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsx)(o.code,{children:"zrok"})," is built to enable developers to seamlessly and securely share their applications. We are expanding that philosophy by supporting a Python SDK. Using just a little code enables you to share your app through ",(0,r.jsx)(o.code,{children:"zrok"}),"'s robust network."]}),"\n",(0,r.jsxs)(o.p,{children:["Today we'll be talking about the exciting news of the ",(0,r.jsx)(o.code,{children:"zrok"})," python SDK! We will be spinning up an http server using flask and waitress to be served up via ",(0,r.jsx)(o.code,{children:"zrok"}),"! If you want to follow along you'll need to have a ",(0,r.jsx)(o.code,{children:"zrok"})," environment set up. If you don't want to self host you can sign up for a free account at ",(0,r.jsx)(o.a,{href:"https://zrok.io",children:"https://zrok.io"}),"."]}),"\n",(0,r.jsxs)(o.p,{children:["Check out the ",(0,r.jsx)(o.a,{href:"https://docs.zrok.io/docs/getting-started/",children:"Getting Started"})," guide for more information."]}),"\n",(0,r.jsx)(o.p,{children:(0,r.jsx)(o.img,{src:t(15370).A+"",width:"269",height:"326"})}),"\n",(0,r.jsx)(o.h2,{id:"expanding-into-python",children:"Expanding into Python"}),"\n",(0,r.jsxs)(o.p,{children:["Here is all it takes to spin up a ",(0,r.jsx)(o.code,{children:"zrok"})," enabled server using flask and waitress:"]}),"\n",(0,r.jsx)(o.pre,{children:(0,r.jsx)(o.code,{className:"language-python",children:'from flask import Flask\nimport sys\nimport zrok\nfrom zrok.model import ShareRequest\nimport atexit\n\napp = Flask(__name__)\nzrok_opts = {}\nbindPort = 18081\n\n\n@zrok.decor.zrok(opts=zrok_opts)\ndef runApp():\n    from waitress import serve\n    # the port is only used to integrate Zrok with frameworks that expect a "hostname:port" combo\n    serve(app, port=bindPort)\n\n\n@app.route(\'/\')\ndef hello_world():\n    print("received a request to /")\n    return "Look! It\'s zrok!"\n\n\nif __name__ == \'__main__\':\n    root = zrok.environment.root.Load()\n    try:\n        shr = zrok.share.CreateShare(root=root, request=ShareRequest(\n            BackendMode=zrok.model.TCP_TUNNEL_BACKEND_MODE,\n            ShareMode=zrok.model.PUBLIC_SHARE_MODE,\n            Frontends=[\'public\'],\n            Target="http-server"\n        ))\n        shrToken = shr.Token\n        print("Access server at the following endpoints: ", "\\n".join(shr.FrontendEndpoints))\n\n        def removeShare():\n            zrok.share.DeleteShare(root=root, shr=shr)\n            print("Deleted share")\n        atexit.register(removeShare)\n    except Exception as e:\n        print("unable to create share", e)\n        sys.exit(1)\n\n    zrok_opts[\'cfg\'] = zrok.decor.Opts(root=root, shrToken=shrToken, bindPort=bindPort)\n\n    runApp()\n'})}),"\n",(0,r.jsx)(o.p,{children:"Just a few calls and we're running! Let's quickly go over what's happening here:"}),"\n",(0,r.jsxs)(o.p,{children:["The ",(0,r.jsx)(o.code,{children:"zrok"})," decorator takes a config dictionary to allow users to easily input their own settings. Taking in the root config, share token, and the bind port and you're off to the races."]}),"\n",(0,r.jsxs)(o.p,{children:["We create a share (and setup a callback to clean up after ourselves once the server closes) which we then use to populate our options struct for our decorator. Thats it! That share is then accessed via some sort of share. In this case we're using a public share which you can find if on ",(0,r.jsx)(o.a,{href:"./the-zrok-oauth-public-frontend",children:"here"}),"."]}),"\n",(0,r.jsx)(o.p,{children:"To expand from here you would declare any routes your app wants to expose and it's just like producing a typical web server. No additional complications!"}),"\n",(0,r.jsxs)(o.h2,{id:"why-though",children:["Why ",(0,r.jsx)(o.strong,{children:"Though"}),"?"]}),"\n",(0,r.jsxs)(o.p,{children:["Well, the big reason is we want this to be easy above all else. Sharing what you make should be painless. You develop the application and let ",(0,r.jsx)(o.code,{children:"zrok"})," handle the rest."]}),"\n",(0,r.jsxs)(o.p,{children:["Plus you can deploy your application anywhere. So long as the environment can reach out to the ",(0,r.jsx)(o.code,{children:"zrok"})," host controller it can be wherever you need it to be. It can live in a container, cloud hosted, or even running nicely at home."]}),"\n",(0,r.jsx)(o.h2,{id:"moving-forward",children:"Moving Forward"}),"\n",(0,r.jsxs)(o.p,{children:["Moving forward we want ",(0,r.jsx)(o.code,{children:"zrok"})," to be as accesible as possible, both in options and ease of use. Support for more languages is coming! If you would like to talk about languages to support, or friction points then please reach out to us on ",(0,r.jsx)(o.a,{href:"https://openziti.discourse.group/c/zrok/24",children:"Discourse"}),"!"]}),"\n",(0,r.jsxs)(o.p,{children:[(0,r.jsxs)(o.a,{href:"https://openziti.discourse.group/c/zrok/24",children:[(0,r.jsx)(o.br,{}),"\n"]}),"Also if you like ",(0,r.jsx)(o.code,{children:"zrok"})," or OpenZiti and want to support it then please drop a star on ",(0,r.jsx)(o.a,{href:"https://github.com/openziti/zrok",children:"Github (zrok)"})," / ",(0,r.jsx)(o.a,{href:"https://github.com/openziti/ziti",children:"Github (OpenZiti)"}),". It really means a lot!"]})]})}function d(e={}){const{wrapper:o}={...(0,s.R)(),...e.components};return o?(0,r.jsx)(o,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},15370:(e,o,t)=>{t.d(o,{A:()=>n});const n=t.p+"assets/images/3adab72c-f78a-4cfc-b4e3-d4c645a70376-632369df831d16241b595459b179ddf5.png"},28453:(e,o,t)=>{t.d(o,{R:()=>i,x:()=>a});var n=t(96540);const r={},s=n.createContext(r);function i(e){const o=n.useContext(s);return n.useMemo((function(){return"function"==typeof e?e(o):{...o,...e}}),[o,e])}function a(e){let o;return o=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:i(e.components),n.createElement(s.Provider,{value:o},e.children)}},61377:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/the-python-zrok-sdk","source":"@site/blog/the-python-zrok-sdk.md","title":"The Python zrok SDK","description":"If you are reading this, hopefully, you are familiar with zrok: an open source solution for easy and secure sharing","date":"2024-02-29T20:30:28.000Z","tags":[{"inline":false,"label":"Python","permalink":"/docs/openziti/blog/tags/python","description":"Python content"},{"inline":false,"label":"OpenZiti","permalink":"/docs/openziti/blog/tags/openziti","description":"OpenZiti related content"},{"inline":false,"label":"zrok","permalink":"/docs/openziti/blog/tags/zrok","description":"zrok related content"}],"readingTime":3.18,"hasTruncateMarker":true,"authors":[{"name":"Cameron Otts","title":"Author","url":"https://github.com/camotts","imageURL":"https://avatars.githubusercontent.com/camotts","key":"CameronOtts","page":null}],"frontMatter":{"title":"The Python zrok SDK","date":"2024-02-29T20:30:28.000Z","cuid":"clt7ojqne000009l55fwz4dgu","slug":"the-python-zrok-sdk","authors":["CameronOtts"],"image":"@site/blogs/openziti/v1701893161134/a2cd088f-0260-4ce7-9ea2-26a1a97a23db.webp","imageDark":"@site/blogs/openziti/v1701893161134/a2cd088f-0260-4ce7-9ea2-26a1a97a23db.webp","tags":["python","openziti","zrok"]},"unlisted":false,"prevItem":{"title":"The zrok SOCKS Backend","permalink":"/docs/openziti/blog/the-zrok-socks-backend"},"nextItem":{"title":"Securing a Dedicated  Palworld Server For My Family with zrok","permalink":"/docs/openziti/blog/securing-dedicated-palworld-server-with-zrok"}}')}}]);