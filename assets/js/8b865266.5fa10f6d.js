"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[5194],{63426:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>a,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"learn/core-concepts/clients/process-sequences/ServiceDial","title":"Service Dial","description":"Steps","source":"@site/docs/learn/core-concepts/clients/process-sequences/ServiceDial.md","sourceDirName":"learn/core-concepts/clients/process-sequences","slug":"/learn/core-concepts/clients/process-sequences/ServiceDial","permalink":"/docs/learn/core-concepts/clients/process-sequences/ServiceDial","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/learn/core-concepts/clients/process-sequences/ServiceDial.md","tags":[],"version":"current","lastUpdatedAt":1747058214000,"frontMatter":{},"sidebar":"docsSidebar","previous":{"title":"Endpoint Registration","permalink":"/docs/learn/core-concepts/clients/process-sequences/EndpointRegistration"},"next":{"title":"Ziti Identities","permalink":"/docs/learn/core-concepts/identities/overview"}}');var r=n(74848),s=n(28453);const o={},a="Service Dial",c={},l=[{value:"Steps",id:"steps",level:2}];function d(e){const t={a:"a",h1:"h1",h2:"h2",header:"header",li:"li",mermaid:"mermaid",ol:"ol",p:"p",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"service-dial",children:"Service Dial"})}),"\n",(0,r.jsx)(t.mermaid,{value:"sequenceDiagram\ntitle Service Dial (TCP)\n\nparticipant Application Client\nparticipant Ziti DNS\nparticipant Ziti SDK\nparticipant Controller\nparticipant Edge Router 1\nparticipant Edge Router 2\nparticipant Application Server\n\n\nApplication Client->Ziti DNS : DNS Query\nZiti DNS ->Application Client : DNS Response (100.64.0.0)\nApplication Client ->Ziti SDK : TCP Connection (3 way handshake)\nnote over Ziti SDK : Edge Router Selection\nZiti SDK ->Controller : Dial Request\n\nZiti SDK -> Controller :Initiating Edge Router's\\nSession Token\\nService ID\\nDial Options\n\n\n\nnote over Controller : Route calculation\n\n\nController ->Edge Router 1 : Route Request\n\nController-> Edge Router 2 : Route Request\nEdge Router 1 ->Controller : Route Response\nEdge Router 2 ->Application Server : TCP Connection (3 way handshake)\nEdge Router 2 ->Controller : Route Response\nController->Ziti SDK : Dial Reponse\n\n\n\n\n\nnote over Application Client,Application Server : Data Flow"}),"\n",(0,r.jsx)(t.h2,{id:"steps",children:"Steps"}),"\n",(0,r.jsxs)(t.ol,{children:["\n",(0,r.jsx)(t.li,{children:"If the service being dialed is a DNS named service, rather than just an IP, the system will look perform a DNS query to resolve the name.  Otherwise, skip to step 3."}),"\n",(0,r.jsx)(t.li,{children:"The Ziti DNS resolver will respond with an IP in the 100.64.0.0 range to steer the traffic into the software."}),"\n",(0,r.jsx)(t.li,{children:"The client will then make a TCP connection with the SDK.  This may be done in a number of ways, a tunneler client on the host, a gateway tunneler or edge router within the LAN, or it may be skipped, and a direct socket opend using one of the SDKs.  Assuming there is TCP involved for this example, the TCP handshake occurs.\nom4. The SDK will selectt he best edge router to initiate the fabric circuit from it's choices.  The primary selection criteria is latency.  The SDK constantly polls the Edge Routers it has awareness of, and monitors the latency of the messaging.  The least latenct router available for this service will be selected."}),"\n",(0,r.jsx)(t.li,{children:"The SDK will issue a Dial Request to the Controller.  This message will include the service being dialed, the selected initial Edge Router, and authentication information"}),"\n",(0,r.jsx)(t.li,{children:"Following authentication, the Controller will begin detemining the current best path for the circuit across the fabric.  The actual routing path is calculated using the Dijkstra algorithm, similar to OSPF and other IP routing protocols.  That process ends with the least cost path in terms of latency.  That path cost is added to the static, dynamic, and precedence costs associated with the service terminators.  Precedence is a configuration option in a hot standby redundancy configuration, static costs are mapped via config, and dynamic costs are the result of successes and failures in previous setups.  Once all the terminators are costed, the minimum cost value will determine the best path and be returned."}),"\n",(0,r.jsx)(t.li,{children:"Once the best path has been computed, the Controller will send requests to the Edge Routers to create the actual path.  Each edge router will complete the necessary steps and respond.  If the terminating edge router is a combined router/tunneler, and the end service requires a TCP connection, this will be created before a successful message is sent, to ensure connectivity."}),"\n",(0,r.jsx)(t.li,{children:"The response messages from the routers, once all recieved, indicate the circuit is configure, and ready for traffic."}),"\n",(0,r.jsx)(t.li,{children:"A dial response to the initial edge router then begins the flow of data."}),"\n"]}),"\n",(0,r.jsxs)(t.p,{children:["There are a number of error codes associated with Service Dials.  Messages can time out, the end server may not respond to the TCP SYN packet, or send a RST, terminators can be in an unavailable state, and others.  Error codes for the fabric circuit creation process are available on ",(0,r.jsx)(t.a,{href:"/docs/guides/troubleshooting/circuit-create-error-codes",children:"Circuit Dial Error Codes"})]})]})}function h(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>o,x:()=>a});var i=n(96540);const r={},s=i.createContext(r);function o(e){const t=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:t},e.children)}}}]);