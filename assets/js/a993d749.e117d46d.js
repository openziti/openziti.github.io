"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[5079],{39525:(e,n,t)=>{t.d(n,{Ay:()=>d,RM:()=>s});var i=t(74848),o=t(28453);const s=[{value:"For Tunnelers",id:"for-tunnelers",level:4},{value:"For BrowZer",id:"for-browzer",level:4},{value:"For Ziti Admin Console (ZAC)",id:"for-ziti-admin-console-zac",level:4}];function r(e){const n={a:"a",code:"code",h4:"h4",p:"p",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The ",(0,i.jsx)(n.a,{href:"https://oauth.net/2/pkce/",children:"Authorization Code Flow with PKCE or PKCE flow"})," requires configuring callback URLs the\r\nIdentity Provider (IdP) will allow redirecting to. If the URL for a specific client is not specifically listed, the IdP\r\nwill deny the authentication request. Depending on the technology used to authenticate to the OpenZiti Network,\r\ndifferent URLs need to be specified. More than one URL is allowed to be configured. Decide if you are configuring the\r\nIdP for use with tunnelers, with BrowZer or with both and add the appropriate callback urls."]}),"\n",(0,i.jsx)(n.p,{children:'In the Auth0 dashboard, with the application selected, choose the "Settings" tab and scroll down to the "Application\r\nURIs" section and add the URLs.'}),"\n",(0,i.jsx)(n.h4,{id:"for-tunnelers",children:"For Tunnelers"}),"\n",(0,i.jsxs)(n.p,{children:["Tunnelers require an allowed callback URL of: ",(0,i.jsx)(n.code,{children:"http://localhost:20314/auth/callback"}),"."]}),"\n",(0,i.jsx)(n.h4,{id:"for-browzer",children:"For BrowZer"}),"\n",(0,i.jsxs)(n.p,{children:["The URL to configure for BrowZer will vary depending on the BrowZer configuration. BrowZer requires a wildcard\r\ncertificate in order to be deployed and all services are delivered from this wildcard domain. You will need to add\r\nthe configured ",(0,i.jsx)(n.a,{href:"/docs/learn/quickstarts/browzer/example/#get-a-wildcard-certificate",children:"wildcard domain"})," as the\r\ncallback url."]}),"\n",(0,i.jsx)(n.h4,{id:"for-ziti-admin-console-zac",children:"For Ziti Admin Console (ZAC)"}),"\n",(0,i.jsxs)(n.p,{children:["The URL to configure an IdP for so that ZAC will be able to authenticate will depend on how you deploy your ZAC. The\r\ncurrent method recommended to deploy ZAC will deploy it on the same URL as the controller. For example:\r\n",(0,i.jsx)(n.a,{href:"https://controller.example.com/zac/callback",children:"https://controller.example.com/zac/callback"})]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(r,{...e})}):r(e)}},92992:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>d,metadata:()=>i,toc:()=>c});const i=JSON.parse('{"id":"guides/external-auth/identity-providers/cognito","title":"AWS Cognito","description":"This section illustrates where the expected values are found within","source":"@site/docs/guides/external-auth/identity-providers/cognito.mdx","sourceDirName":"guides/external-auth/identity-providers","slug":"/guides/external-auth/identity-providers/cognito","permalink":"/docs/guides/external-auth/identity-providers/cognito","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/external-auth/identity-providers/cognito.mdx","tags":[],"version":"current","lastUpdatedAt":1754509313000,"frontMatter":{"title":"AWS Cognito","sidebar_label":"Cognito","hide_table_of_contents":true},"sidebar":"docsSidebar","previous":{"title":"Authentik","permalink":"/docs/guides/external-auth/identity-providers/authentik"},"next":{"title":"dex","permalink":"/docs/guides/external-auth/identity-providers/dex"}}');var o=t(74848),s=t(28453),r=t(39525);const d={title:"AWS Cognito",sidebar_label:"Cognito",hide_table_of_contents:!0},l="AWS Cognito",a={},c=[{value:"Create a User Pool",id:"create-a-user-pool",level:2},{value:"Add Callback URL",id:"add-callback-url",level:2},{value:"Callback URLs",id:"callback-urls",level:3},...r.RM,{value:"Edit Login Pages",id:"edit-login-pages",level:2},{value:"Add Additional Callback URL",id:"add-additional-callback-url",level:2}];function h(e){const n={a:"a",admonition:"admonition",code:"code",div:"div",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.header,{children:(0,o.jsx)(n.h1,{id:"aws-cognito",children:"AWS Cognito"})}),"\n",(0,o.jsx)("img",{src:"/icons/logo-cognito.svg",alt:"AWS Cognito logo",height:"100px"}),"\n",(0,o.jsxs)(n.p,{children:["This section illustrates where the expected values are found within\n",(0,o.jsx)(n.a,{href:"https://docs.aws.amazon.com/cognito/",children:"the Cognito dashboard"}),". For a more detailed guide on enabling Cognito with\nOpenZiti, see below. Use these values to configure an external JWT signer. All of these values are found from the\nAWS Cognito dashboard for the corresponding ",(0,o.jsx)(n.strong,{children:"User Pool"})," screen or via the OpenID discovery endpoint located at:"]}),"\n",(0,o.jsx)(n.div,{className:"code-section",children:(0,o.jsxs)(n.div,{className:"code-section-code",children:[(0,o.jsx)(n.p,{children:(0,o.jsx)(n.strong,{children:"Example Cognito OpenID Discovery Endpoint"})}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-text",children:"https://cognito-idp.{region}.amazonaws.com/{userPoolId}/.well-known/openid-configuration\n"})})]})}),"\n",(0,o.jsx)(n.admonition,{title:"notes about cognito",type:"note",children:(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:["By default, Cognito will only work with ",(0,o.jsx)(n.strong,{children:"ID"})," tokens. You'll likely need to change the ext-jwt-signer token type\nfrom ",(0,o.jsx)(n.strong,{children:"Access"})," to ",(0,o.jsx)(n.strong,{children:"ID"}),"."]}),"\n",(0,o.jsxs)(n.li,{children:["Cognito's access token will not contain the user's email nor an audience. The audience field is mandatory as\nOpenZiti validates this claim within the JWT. ",(0,o.jsx)(n.strong,{children:(0,o.jsx)(n.a,{href:"https://aws.amazon.com/blogs/security/how-to-customize-access-tokens-in-amazon-cognito-user-pools/",children:"This blog from AWS security"})}),"\nillustrates how one can modify access tokens and add an audience."]}),"\n"]})}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Field"}),(0,o.jsx)(n.th,{children:"Where to Find the Value in the Cognito UI"}),(0,o.jsx)(n.th,{children:"Example"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"Issuer"})}),(0,o.jsxs)(n.td,{children:["From the OpenID discovery endpoint, the ",(0,o.jsx)(n.strong,{children:"issuer"})," field"]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY",children:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"Client ID"})}),(0,o.jsxs)(n.td,{children:["Shown on the ",(0,o.jsx)(n.strong,{children:"Applications -> App clients"})," overview page in the ",(0,o.jsx)(n.strong,{children:"Client ID"})," column"]}),(0,o.jsx)(n.td,{children:"5eac6vbnu75cems4pen2taggvr"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"Audience"})}),(0,o.jsxs)(n.td,{children:["Unless overridden, the same value as the ",(0,o.jsx)(n.strong,{children:"Client ID"})]}),(0,o.jsx)(n.td,{children:"5eac6vbnu75cems4pen2taggvr"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"External Auth URL"})}),(0,o.jsxs)(n.td,{children:["The same value as the ",(0,o.jsx)(n.strong,{children:"Issuer"})]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY",children:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"JWKS Endpoint"})}),(0,o.jsxs)(n.td,{children:["Shown on the ",(0,o.jsx)(n.strong,{children:"Overview"})," page of the user pool as the as the ",(0,o.jsx)(n.strong,{children:"Token signing key URL"})]}),(0,o.jsx)(n.td,{children:(0,o.jsx)(n.a,{href:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY/.well-known/jwks.json",children:"https://cognito-idp.us-east-2.amazonaws.com/us-east-2_6X1AbJGPY/.well-known/jwks.json"})})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"Claims Property"})}),(0,o.jsxs)(n.td,{children:["Often ",(0,o.jsx)(n.code,{children:"email"}),", but can also be ",(0,o.jsx)(n.code,{children:"sub"})," or any other claim contained in the JWT"]}),(0,o.jsx)(n.td,{children:"email"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.strong,{children:"Scopes"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"openid"})," is always included. Often ",(0,o.jsx)(n.code,{children:"email"})," but ",(0,o.jsx)(n.code,{children:"profile"})," or any standard or custom scope"]}),(0,o.jsx)(n.td,{children:"profile"})]})]})]}),"\n",(0,o.jsx)(n.hr,{}),"\n",(0,o.jsx)(n.h2,{id:"create-a-user-pool",children:"Create a User Pool"}),"\n",(0,o.jsxs)(n.p,{children:["Begin by creating a User Pool within Cognito. When prompted, choose a ",(0,o.jsx)(n.strong,{children:"Single-page application (SPA)"}),". Enter a name\nfor the application and select ",(0,o.jsx)(n.strong,{children:"email"})," when configuring options. For required attributes for sign-up, also choose email."]}),"\n",(0,o.jsx)(n.admonition,{title:"Create a User Pool",type:"info",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"create app with provider",src:t(16032).A+"",width:"1066",height:"835"})})}),"\n",(0,o.jsx)(n.h2,{id:"add-callback-url",children:"Add Callback URL"}),"\n",(0,o.jsxs)(n.p,{children:["Add the callback you want to enable and click ",(0,o.jsx)(n.strong,{children:"Create user directory"}),"."]}),"\n",(0,o.jsx)(n.h3,{id:"callback-urls",children:"Callback URLs"}),"\n",(0,o.jsx)(r.Ay,{}),"\n",(0,o.jsx)(n.admonition,{title:"Add Callback URL",type:"info",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(86300).A+"",width:"1060",height:"279"})})}),"\n",(0,o.jsx)(n.h2,{id:"edit-login-pages",children:"Edit Login Pages"}),"\n",(0,o.jsxs)(n.p,{children:["To enable BrowZer (or conversely, OpenZiti tunnelers), go back to the Cognito App client overview page. From there\nfind the ",(0,o.jsx)(n.strong,{children:"Login pages"})," tab and choose ",(0,o.jsx)(n.strong,{children:"Edit"}),"."]}),"\n",(0,o.jsx)(n.admonition,{title:"Edit Login Pages",type:"info",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(48740).A+"",width:"1396",height:"846"})})}),"\n",(0,o.jsx)(n.h2,{id:"add-additional-callback-url",children:"Add Additional Callback URL"}),"\n",(0,o.jsxs)(n.p,{children:["On the ",(0,o.jsx)(n.strong,{children:"Edit"})," page, first click ",(0,o.jsx)(n.strong,{children:"Add another URL"})," and then enter the second callback URL to allow."]}),"\n",(0,o.jsx)(n.admonition,{title:"Add Additional Callback URL",type:"info",children:(0,o.jsx)(n.p,{children:(0,o.jsx)(n.img,{alt:"img",src:t(84684).A+"",width:"1292",height:"498"})})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},48740:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/add-callback-url-2a-de1e2f1ec3e2f6c4d10fffec8d26f9da.png"},84684:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/add-callback-url-2b-ec0d023061c568f3595647b1e1287bab.png"},86300:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/add-callback-url-2d7ea556b622858310109d5946e7abae.png"},16032:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/create-user-pool-4b33000da69d0c370bed059c8fb08f47.png"},28453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>d});var i=t(96540);const o={},s=i.createContext(o);function r(e){const n=i.useContext(s);return i.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:r(e.components),i.createElement(s.Provider,{value:n},e.children)}}}]);