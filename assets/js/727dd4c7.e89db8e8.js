"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[3675],{76869:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>p,frontMatter:()=>c,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"guides/deployments/docker/console","title":"Deploy the Console","description":"This article is about enabling the console on a controller that is running in a container.","source":"@site/docs/guides/deployments/20-docker/30-console.mdx","sourceDirName":"guides/deployments/20-docker","slug":"/guides/deployments/docker/console","permalink":"/docs/guides/deployments/docker/console","draft":false,"unlisted":false,"editUrl":"https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/deployments/20-docker/30-console.mdx","tags":[],"version":"current","lastUpdatedAt":1743170232000,"sidebarPosition":30,"frontMatter":{"title":"Deploy the Console","sidebar_label":"Console"},"sidebar":"docsSidebar","previous":{"title":"Router","permalink":"/docs/guides/deployments/docker/router"},"next":{"title":"Kubernetes","permalink":"/docs/category/kubernetes"}}');var s=i(74848),o=i(28453),r=i(38615);const c={title:"Deploy the Console",sidebar_label:"Console"},l=void 0,a={},d=[{value:"Upgrade",id:"upgrade",level:2},{value:"Authenticate with an Admin Client Certificate",id:"authenticate-with-an-admin-client-certificate",level:2},...r.RM];function h(e){const n={a:"a",code:"code",h2:"h2",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.p,{children:"This article is about enabling the console on a controller that is running in a container."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure the controller"}),"\n",(0,s.jsxs)(n.p,{children:["The console's ",(0,s.jsx)(n.code,{children:"zac"})," binding must be on the same web listener as the controller's management API, i.e., the ",(0,s.jsx)(n.code,{children:"edge-management"})," binding."]}),"\n",(0,s.jsx)("br",{}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"      - binding: zac\n        options:\n          location: /ziti-console\n          indexFile: index.html\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"location"})," is the filesystem path to the static files of the console. In the controller container, the usual path is ",(0,s.jsx)(n.code,{children:"/ziti-console"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"indexFile"})," property is the entry point to the console."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"To apply the changes, the controller must be restarted."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Visit the console at ",(0,s.jsx)(n.code,{children:"/zac/"})," on the controller's address."]}),"\n",(0,s.jsxs)(n.p,{children:["The console is now available at ",(0,s.jsx)(n.code,{children:"https://<fqdn>:<port>/zac/"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Log in to the console."}),"\n",(0,s.jsx)(n.p,{children:"The only available authentication method for the console SPA is username and password."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Console certificate option - The console is served from the controller's API and can be used with the default API certificate. The controller can be configured to present a different certificate for the console when the API is accessed by a distinct URL for the console. For more information about using alternative server certs with the controller, see: ",(0,s.jsxs)(n.a,{href:"/docs/reference/configuration/conventions#identity",children:["the configuration reference for the ",(0,s.jsx)(n.code,{children:"identity"})," property"]}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"upgrade",children:"Upgrade"}),"\n",(0,s.jsx)(n.p,{children:"The controller container includes the latest version of the console. You can instead mount console versions >= 3.0.0."}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Download a release."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"wget https://github.com/openziti/ziti-console/releases/latest/download/ziti-console.zip\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Unzip the static files and set read and list permission."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"unzip -d ./ziti-console ./ziti-console.zip\nchmod -R a+rX ./ziti-console\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Mount the console files read-only on the controller container."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"services:\n  ziti-controller:\n    volumes:\n      - ./ziti-console:/ziti-console:ro\n"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Restart the controller service to apply the changes."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"docker compose up ziti-controller --force-recreate\n"})}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"authenticate-with-an-admin-client-certificate",children:"Authenticate with an Admin Client Certificate"}),"\n",(0,s.jsx)(r.Ay,{})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},38615:(e,n,i)=>{i.d(n,{Ay:()=>c,RM:()=>o});var t=i(74848),s=i(28453);const o=[];function r(e){const n={a:"a",code:"code",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Enroll an admin identity. ",(0,t.jsx)(n.a,{href:"/docs/reference/command-line/login",children:"Link to instructions"})]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Unwrap the JSON file to obtain the certificate and private key."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"ziti ops unwrap admin2.json\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Compose a keystore from the certificate and private key. The ",(0,t.jsx)(n.code,{children:"-legacy"})," flag is necessary when importing the keystore into some versions of macOS Keychain Access."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"openssl pkcs12 -export -in admin2.cert -inkey admin2.key -out admin2.p12 -name \"admin2\" -legacy -password 'pass:mypassword'\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Import the keystore:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"macOS: Import into System Keychain via Keychain Access application for Google Chrome. You can run a terminal command or double-click the keystore file or drag it onto the login keychain to import it."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-text",children:"security import admin2.p12 -k ~/Library/Keychains/login.keychain -T /Applications/Google\\ Chrome.app -P 'mypass'\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Windows: Import into the Windows Certificate Store (Personal store) via certmgr.msc."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Linux: Import into your browser's certificate store or system certificate store (e.g., Chrome Settings > Privacy and Security > Security > Manage certificates)."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Visit the console in your web browser. The browser will prompt with a list of imported client certificates. Select the one you imported in the previous step."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:'Press the "LOGIN" button without entering a password.'}),"\n"]}),"\n"]})}function c(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(r,{...e})}):r(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(96540);const s={},o=t.createContext(s);function r(e){const n=t.useContext(o);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(o.Provider,{value:n},e.children)}}}]);