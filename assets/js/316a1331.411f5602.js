"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[21476],{75243:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>d,contentTitle:()=>a,default:()=>h,frontMatter:()=>s,metadata:()=>t,toc:()=>c});var t=n(54864),o=n(74848),r=n(28453);const s={title:"Put some Ziti in your Caddy",date:new Date("2023-10-24T12:29:14.000Z"),cuid:"clo4aztln000e08l82w2lb5fg",slug:"put-some-ziti-in-your-caddy",authors:["EugeneKobyakov"],image:"@site/blogs/openziti/v1698150167579/59e96908-6587-4f29-b51b-73e523108133.png",imageDark:"@site/blogs/openziti/v1698150167579/59e96908-6587-4f29-b51b-73e523108133.png",tags:["caddy","openziti","zerotrust","securenetworks"]},a="What is Caddy Server",d={authorsImageUrls:[void 0]},c=[];function l(e){const i={a:"a",blockquote:"blockquote",code:"code",h1:"h1",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(i.p,{children:["In this post I'll continue showing the power of OpenZiti and its SDK. This time I'll show you how we ",(0,o.jsx)(i.a,{href:"https://openziti.io/docs/reference/glossary/#zitification-zitified-zitify",children:"zitified"})," ",(0,o.jsx)(i.a,{href:"https://caddyserver.com/",children:"Caddy Server"}),"."]}),"\n",(0,o.jsxs)(i.p,{children:["If you're a regular reader of this blog, the concept of ",(0,o.jsx)(i.code,{children:"zitification"}),", i.e. embedding OpenZiti SDK into you application, should be familiar to you. We've covered this topic before -- here are some links if you're new to this blog, or missed them:"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"/docs/openziti/blog/zitifying-ssh",children:"Zitifying SSH"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"/docs/openziti/blog/securing-nodejs-applications",children:"Securing NodeJS Apps"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"/docs/openziti/blog/got-5-minutes-secure-your-python-website-with-zero-trust",children:"Secure Python Website"})}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"Zitification allows you as a developer to achieve a true end-to-end secure overlay connectivity between your applications."}),"\n",(0,o.jsxs)(i.blockquote,{children:["\n",(0,o.jsx)(i.p,{children:"Caddy 2 is a powerful, enterprise-ready, open source web server with automatic HTTPS written in Go"}),"\n"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsx)(i.li,{children:"Caddy simplifies your infrastructure. It takes care of TLS certificate renewals, OCSP stapling, static file serving, reverse proxying, Kubernetes ingress, and more."}),"\n",(0,o.jsx)(i.li,{children:"Its modular architecture means you can do more with a single, static binary that compiles for any platform."}),"\n"]}),"\n",(0,o.jsx)(i.p,{children:"These two bullet points are really important. I will show how zitifying Caddy Server simplifies your infrastructure, and how easy it was to do it with caddy server's approach to extensibility."}),"\n",(0,o.jsx)(i.h1,{id:"simplifying-infrastructure",children:"Simplifying Infrastructure"}),"\n",(0,o.jsxs)(i.p,{children:["Typically, if you have a website or a web application in a data center (or at home/office), and you want to protect it from outside traffic (no open Internet ports) you need to deploy some kind of proxy agent (like ",(0,o.jsx)(i.a,{href:"https://openziti.io/docs/reference/tunnelers/linux/",children:"Ziti Edge Tunnel"}),") that would connect to the overlay network, accept service connection requests and proxy them to your target server. This means that"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"you need to maintain another piece of networking machinery"}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"the last mile (or a few feet) of your connection goes over an unprotected overlay"}),"\n"]}),"\n"]}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"common deployment with Ziti Edge Tunnel"}),"\n",(0,o.jsx)(i.img,{alt:"Common OpenZiti Host Access deployment",src:n(97932).A+"",width:"1318",height:"865"})]}),"\n",(0,o.jsx)(i.p,{children:"By embedding OpenZiti SDK into your server, you solve both problems at the same time."}),"\n",(0,o.jsxs)(i.p,{children:[(0,o.jsx)(i.strong,{children:"app-embedded deployment"}),"\n",(0,o.jsx)(i.img,{alt:"Zitified Caddyserver deployment",src:n(19550).A+"",width:"944",height:"714"})]}),"\n",(0,o.jsx)(i.h1,{id:"caddy-server-plugin",children:"Caddy Server plugin"}),"\n",(0,o.jsxs)(i.p,{children:["OpenZiti project published a ",(0,o.jsx)(i.a,{href:"https://github.com/openziti-test-kitchen/ziti-caddy",children:"Caddy plugin"})," that makes it all very easy."]}),"\n",(0,o.jsxs)(i.p,{children:["All you have to do is ",(0,o.jsx)(i.a,{href:"https://github.com/openziti-test-kitchen/ziti-caddy/blob/main/cmd/ziti-caddy/main.go#L8",children:"import"})," ",(0,o.jsx)(i.code,{children:"ziti-caddy"})," plugin in your Caddy Server main. Caddy Server plugin framework takes care of bootstrapping OpenZiti SDK (driven by configuration in ",(0,o.jsx)(i.code,{children:"Caddyfile"}),")"]}),"\n",(0,o.jsxs)(i.p,{children:["Github project has a ",(0,o.jsx)(i.a,{href:"https://github.com/openziti-test-kitchen/ziti-caddy/tree/main/sample",children:"sample configuration and bootstrap"}),", but in short steps are like this:"]}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["deploy an ",(0,o.jsx)(i.a,{href:"https://openziti.io/docs/learn/quickstarts/",children:"OpenZiti network"})]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsxs)(i.p,{children:["create ",(0,o.jsx)(i.a,{href:"https://openziti.io/docs/learn/core-concepts/services/overview",children:"service"})," and ",(0,o.jsx)(i.a,{href:"https://openziti.io/docs/learn/core-concepts/identities/overview",children:"identity"})]}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:"configure Caddy Server"}),"\n"]}),"\n"]}),"\n",(0,o.jsx)(i.pre,{children:(0,o.jsx)(i.code,{className:"language-bash",children:"http:// {\n\t# ziti address format: ziti/<service_name>[/<terminator>]@<ziti_identity_file>\n\tbind ziti/caddy-service@caddy-host.json\n\n\tfile_server {\n\t    root /usr/share/doc\n\t\tbrowse\n\t}\n}\n"})}),"\n",(0,o.jsx)(i.p,{children:"There you have it, two lines of code -- one in the your Go file, and one in configuration -- and you website is only accessible on OpenZiti network."}),"\n",(0,o.jsx)(i.h1,{id:"next-steps",children:"Next Steps"}),"\n",(0,o.jsxs)(i.p,{children:["Try it out and give us feedback on ",(0,o.jsx)(i.a,{href:"https://openziti.discourse.group/",children:"Discourse"}),"."]}),"\n",(0,o.jsx)(i.p,{children:"Further reading:"}),"\n",(0,o.jsxs)(i.ul,{children:["\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"./securing-web-apis-with-openziti",children:"Securing Web APIs With OpenZiti"})}),"\n"]}),"\n",(0,o.jsxs)(i.li,{children:["\n",(0,o.jsx)(i.p,{children:(0,o.jsx)(i.a,{href:"./zrok-with-the-power-of-caddy",children:"zrok with the Power of Caddy"})}),"\n"]}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,o.jsx)(i,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},97932:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/244e5ebb-8767-4477-98ae-3350e99d68e0-080dc5aa080db2cc9ba009e0db1a3ceb.png"},19550:(e,i,n)=>{n.d(i,{A:()=>t});const t=n.p+"assets/images/f8a81c74-df47-4870-8644-2082ebd8bfec-511d1b55c7ef07be2a7e77b9e5ec6473.png"},28453:(e,i,n)=>{n.d(i,{R:()=>s,x:()=>a});var t=n(96540);const o={},r=t.createContext(o);function s(e){const i=t.useContext(r);return t.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),t.createElement(r.Provider,{value:i},e.children)}},54864:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/put-some-ziti-in-your-caddy","source":"@site/blog/put-some-ziti-in-your-caddy.md","title":"Put some Ziti in your Caddy","description":"In this post I\'ll continue showing the power of OpenZiti and its SDK. This time I\'ll show you how we zitified Caddy Server.","date":"2023-10-24T12:29:14.000Z","tags":[{"inline":false,"label":"Caddy","permalink":"/docs/openziti/blog/tags/caddy","description":"Caddy server"},{"inline":false,"label":"OpenZiti","permalink":"/docs/openziti/blog/tags/openziti","description":"OpenZiti related content"},{"inline":false,"label":"Zero Trust","permalink":"/docs/openziti/blog/tags/zerotrust","description":"Zero Trust Networking"},{"inline":false,"label":"Secure Networks","permalink":"/docs/openziti/blog/tags/securenetworks","description":"Secure networking"}],"readingTime":2.82,"hasTruncateMarker":true,"authors":[{"name":"Eugene Kobyakov","title":"Author","url":"https://github.com/ekoby","imageURL":"https://avatars.githubusercontent.com/ekoby","key":"EugeneKobyakov","page":null}],"frontMatter":{"title":"Put some Ziti in your Caddy","date":"2023-10-24T12:29:14.000Z","cuid":"clo4aztln000e08l82w2lb5fg","slug":"put-some-ziti-in-your-caddy","authors":["EugeneKobyakov"],"image":"@site/blogs/openziti/v1698150167579/59e96908-6587-4f29-b51b-73e523108133.png","imageDark":"@site/blogs/openziti/v1698150167579/59e96908-6587-4f29-b51b-73e523108133.png","tags":["caddy","openziti","zerotrust","securenetworks"]},"unlisted":false,"prevItem":{"title":"zrok Drives (an Early Preview)","permalink":"/docs/openziti/blog/zrok-drives-an-early-preview"},"nextItem":{"title":"The zrok OAuth Public Frontend","permalink":"/docs/openziti/blog/the-zrok-oauth-public-frontend"}}')}}]);