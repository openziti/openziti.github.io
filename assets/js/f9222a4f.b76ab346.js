"use strict";(self.webpackChunkdocusaurus_3=self.webpackChunkdocusaurus_3||[]).push([[97601],{34099:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>o,toc:()=>r});var o=n(13125),t=n(74848),s=n(28453);const l={title:"Ziti Shell Auto-Complete",seoTitle:"openziti command shell auto-complete",seoDescription:"How to set up auto-complete for the ziti command",date:new Date("2023-02-22T15:47:45.000Z"),cuid:"clefun9ff000009jj6du9fwil",slug:"auto-complete",authors:["KennethBingham"],image:"@site/blogs/openziti/v1677080778065/71fdf983-8355-486e-bb8a-fb57861ea45a.png",imageDark:"@site/blogs/openziti/v1677080778065/71fdf983-8355-486e-bb8a-fb57861ea45a.png",ogimage:"/blogs/openziti/v1677080756391/8f849497-c588-4a59-bf63-108bd522d8f0.png",tags:["bash","zsh","autocomplete"]},a=void 0,c={authorsImageUrls:[void 0]},r=[{value:"Install <code>ziti</code>",id:"install-ziti",level:2},{value:"BASH",id:"bash",level:2},{value:"Enable Completions in BASH",id:"enable-completions-in-bash",level:3},{value:"Install <code>ziti</code> Completions for BASH",id:"install-ziti-completions-for-bash",level:3},{value:"BASH <code>ziti</code> Alias",id:"bash-ziti-alias",level:3},{value:"ZSH",id:"zsh",level:2},{value:"Enable Completions in ZSH",id:"enable-completions-in-zsh",level:3},{value:"Install <code>ziti</code> Completions for ZSH",id:"install-ziti-completions-for-zsh",level:3},{value:"ZSH <code>ziti</code> Alias",id:"zsh-ziti-alias",level:3},{value:"Which shell am I running?",id:"which-shell-am-i-running",level:2}];function h(e){const i={a:"a",code:"code",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(i.p,{children:["This one's for the shell ninjas. The ",(0,t.jsx)(i.code,{children:"ziti"})," CLI comes with auto-complete! You can use completions in any shell\nsupported by ",(0,t.jsx)(i.a,{href:"https://cobra.dev/#generating-bash-completions",children:"Cobra"}),". This post will distill the Cobra instructions\nwith correct examples for ",(0,t.jsx)(i.code,{children:"ziti"})," in BASH and ZSH."]}),"\n",(0,t.jsxs)(i.h2,{id:"install-ziti",children:["Install ",(0,t.jsx)(i.code,{children:"ziti"})]}),"\n",(0,t.jsxs)(i.p,{children:["First, make sure you have the ",(0,t.jsx)(i.code,{children:"ziti"})," CLI. You can ",(0,t.jsx)(i.a,{href:"https://github.com/openziti/ziti/releases/latest",children:"download the latest executable for your OS from GitHub"}),"."]}),"\n",(0,t.jsx)(i.h2,{id:"bash",children:"BASH"}),"\n",(0,t.jsx)(i.h3,{id:"enable-completions-in-bash",children:"Enable Completions in BASH"}),"\n",(0,t.jsxs)(i.p,{children:["You must install ",(0,t.jsx)(i.code,{children:"bash-completion"})," to enable completions for BASH. This is a standard package name for Homebrew, Apt, and Yum/DNF."]}),"\n",(0,t.jsxs)(i.h3,{id:"install-ziti-completions-for-bash",children:["Install ",(0,t.jsx)(i.code,{children:"ziti"})," Completions for BASH"]}),"\n",(0,t.jsxs)(i.p,{children:["BASH completions are loaded directly into the shell's environment with the ",(0,t.jsx)(i.code,{children:"source"})," command like this:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"source <(ziti completion bash)\n"})}),"\n",(0,t.jsxs)(i.p,{children:["That's it! You're done setting up completion in your currently-running BASH shell. Now you can type ",(0,t.jsx)(i.code,{children:"ziti"})," (followed by a space) and hit the TAB key to auto-complete subcommands and options."]}),"\n",(0,t.jsxs)(i.p,{children:["To install this configuration permanently, add the same ",(0,t.jsx)(i.code,{children:"source"})," command to your BASH configuration file, e.g., ",(0,t.jsx)(i.code,{children:"~/.bashrc"}),"."]}),"\n",(0,t.jsxs)(i.h3,{id:"bash-ziti-alias",children:["BASH ",(0,t.jsx)(i.code,{children:"ziti"})," Alias"]}),"\n",(0,t.jsxs)(i.p,{children:["What if you want to save some typing and say ",(0,t.jsx)(i.code,{children:"z"}),", instead of ",(0,t.jsx)(i.code,{children:"ziti"}),", to run a command? Unfortunately, this breaks BASH completion, but it's easily fixed. You must add a completion alias to your BASH config file like this:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"alias z=ziti\ncomplete -o default -F __start_ziti z\n"})}),"\n",(0,t.jsx)(i.h2,{id:"zsh",children:"ZSH"}),"\n",(0,t.jsx)(i.h3,{id:"enable-completions-in-zsh",children:"Enable Completions in ZSH"}),"\n",(0,t.jsxs)(i.p,{children:["You must load ",(0,t.jsx)(i.code,{children:"compinit"})," to enable completion in ZSH. You can run this command to test and then add the same command to your ZSH config, e.g., ",(0,t.jsx)(i.code,{children:"~/.zshrc"}),"to auto-configure future shells."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"autoload -U compinit\ncompinit\n"})}),"\n",(0,t.jsxs)(i.h3,{id:"install-ziti-completions-for-zsh",children:["Install ",(0,t.jsx)(i.code,{children:"ziti"})," Completions for ZSH"]}),"\n",(0,t.jsxs)(i.p,{children:["ZSH completions work with the ",(0,t.jsx)(i.code,{children:"$fpath"})," environment variable and you must generate the completion script and install it with the correct filename in any one of the directories listed in your ",(0,t.jsx)(i.code,{children:"$fpath"}),"."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"# assuming ~/.zsh/completion/ is in $fpath\nziti completion zsh > ~/.zsh/completion/_ziti\n"})}),"\n",(0,t.jsxs)(i.h3,{id:"zsh-ziti-alias",children:["ZSH ",(0,t.jsx)(i.code,{children:"ziti"})," Alias"]}),"\n",(0,t.jsx)(i.p,{children:"Good news! Shell aliases work automatically with ZSH completions."}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:'alias z=ziti\n# now you can say "z" (space) and tab auto-complete "ziti" commands!\n'})}),"\n",(0,t.jsx)(i.h2,{id:"which-shell-am-i-running",children:"Which shell am I running?"}),"\n",(0,t.jsxs)(i.p,{children:["If you didn't change your shell on purpose, you're probably running ZSH on macOS and BASH on Linux (including Windows Subsystem for Linux [WSL]). You can try these two commands to see if the ",(0,t.jsx)(i.code,{children:"ps"})," command can tell you which shell you're using."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"$ ps -p$$ -ocommand=\n/usr/bin/zsh\n\n# try this variant if the first one gave you an error\n$ ps -p$$ -ocmd=\n/usr/bin/zsh\n"})}),"\n",(0,t.jsxs)(i.p,{children:["With the command ",(0,t.jsx)(i.code,{children:"chsh"}),", you may change your default shell for all future terminal sessions in macOS or Linux."]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"# use zsh for future shells \nchsh -s /usr/bin/zsh\n"})})]})}function d(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}},28453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>a});var o=n(96540);const t={},s=o.createContext(t);function l(e){const i=o.useContext(s);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function a(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(s.Provider,{value:i},e.children)}},13125:e=>{e.exports=JSON.parse('{"permalink":"/docs/openziti/blog/auto-complete","source":"@site/blog/ziti-shell-auto-complete.md","title":"Ziti Shell Auto-Complete","description":"This one\'s for the shell ninjas. The ziti CLI comes with auto-complete! You can use completions in any shell","date":"2023-02-22T15:47:45.000Z","tags":[{"inline":false,"label":"Bash","permalink":"/docs/openziti/blog/tags/bash","description":"Bash shell content"},{"inline":false,"label":"Zsh","permalink":"/docs/openziti/blog/tags/zsh","description":"Z shell content"},{"inline":false,"label":"Autocomplete","permalink":"/docs/openziti/blog/tags/autocomplete","description":"Autocomplete features"}],"readingTime":2.25,"hasTruncateMarker":true,"authors":[{"name":"Kenneth Bingham","title":"Author","url":"https://github.com/qrkourier","imageURL":"https://avatars.githubusercontent.com/qrkourier","key":"KennethBingham","page":null}],"frontMatter":{"title":"Ziti Shell Auto-Complete","seoTitle":"openziti command shell auto-complete","seoDescription":"How to set up auto-complete for the ziti command","date":"2023-02-22T15:47:45.000Z","cuid":"clefun9ff000009jj6du9fwil","slug":"auto-complete","authors":["KennethBingham"],"image":"@site/blogs/openziti/v1677080778065/71fdf983-8355-486e-bb8a-fb57861ea45a.png","imageDark":"@site/blogs/openziti/v1677080778065/71fdf983-8355-486e-bb8a-fb57861ea45a.png","ogimage":"/blogs/openziti/v1677080756391/8f849497-c588-4a59-bf63-108bd522d8f0.png","tags":["bash","zsh","autocomplete"]},"unlisted":false,"prevItem":{"title":"The Road Ahead for zrok","permalink":"/docs/openziti/blog/the-road-ahead-for-zrok"},"nextItem":{"title":"Introducing zrok","permalink":"/docs/openziti/blog/introducing-zrok"}}')}}]);