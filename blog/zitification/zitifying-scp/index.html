<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.2.0">
<title data-rh="true">Zitifying SCP | OpenZiti</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openziti.github.io/blog/zitification/zitifying-scp"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" property="og:title" content="Zitifying SCP | OpenZiti"><meta data-rh="true" name="description" content="In the previous post we talked about how we could take a well-known application and improve its security by zitifying it, producing zssh. The logical next step after zitifying ssh would be to extend the functionality of zssh to cover moving files securely as well, enter zscp. A zitified scp effectively creates a more secure command line tool for sending and receiving files between ziti-empowered devices. Once zitified, we can use zscp using ziti identity names just like we did in zitifying ssh. I recommend reading the previous article) if you haven&#x27;t to learn more about the benefits of zitifying tools like ssh and scp."><meta data-rh="true" property="og:description" content="In the previous post we talked about how we could take a well-known application and improve its security by zitifying it, producing zssh. The logical next step after zitifying ssh would be to extend the functionality of zssh to cover moving files securely as well, enter zscp. A zitified scp effectively creates a more secure command line tool for sending and receiving files between ziti-empowered devices. Once zitified, we can use zscp using ziti identity names just like we did in zitifying ssh. I recommend reading the previous article) if you haven&#x27;t to learn more about the benefits of zitifying tools like ssh and scp."><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-12-20T21:26:26.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dovholuknf"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://openziti.github.io/blog/zitification/zitifying-scp"><link data-rh="true" rel="alternate" href="https://openziti.github.io/blog/zitification/zitifying-scp" hreflang="en"><link data-rh="true" rel="alternate" href="https://openziti.github.io/blog/zitification/zitifying-scp" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OpenZiti RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OpenZiti Atom Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-THVRRJ3GLE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-THVRRJ3GLE",{anonymize_ip:!0})</script>




<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.d79fd695.css">
<link rel="preload" href="/assets/js/runtime~main.b124592a.js" as="script">
<link rel="preload" href="/assets/js/main.23d1d9ae.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="root_VOM9"><span style="color:whitesmoke">Star us on GitHub </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="OpenZiti Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/ziti-logo-light.svg" alt="OpenZiti Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a><a class="navbar__item navbar__link" href="/docs/introduction/">Docs</a><a class="navbar__item navbar__link" href="/api/">APIs</a><a class="navbar__item navbar__link" href="/guides/">Guides</a><a class="navbar__item navbar__link" href="/glossary/">Glossary</a><a class="navbar__item navbar__link" href="/operations/controller">Ops</a></div><div class="navbar__items navbar__items--right"><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_eExm"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/articles">Articles</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/c-sdk-on-beaglebone">Building the Ziti C SDK and Sample Apps for arm (BeagleBone)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bootstrapping-trust/part-01.encryption-everywhere">Bootstrapping Trust</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bootstrapping-trust/part-02.a-primer-on-public-key-cryptography">Bootstrapping Trust</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/blog/bootstrapping-trust/part-03.certificates">Bootstrapping Trust</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="title_f1Hy" itemprop="headline">Zitifying SCP</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-12-20T21:26:26.000Z" itemprop="datePublished">December 20, 2022</time> · <!-- -->5 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dovholuknf" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo" src="https://avatars.githubusercontent.com/u/46322585?v=4" alt="Clint Dovholuk"></a><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/dovholuknf" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Clint Dovholuk</span></a></div><small class="avatar__subtitle" itemprop="description">OpenZiti Maintainer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>In the <a href="/blog/zitification/zitifying-ssh/">previous post</a> we talked about how we could take a well-known application and improve its security by zitifying it, producing <code>zssh</code>. The logical next step after zitifying <code>ssh</code> would be to extend the functionality of <code>zssh</code> to cover moving files securely as well, enter <code>zscp</code>. A zitified <code>scp</code> effectively creates a more secure command line tool for sending and receiving files between ziti-empowered devices. Once zitified, we can use <code>zscp</code> using ziti identity names just like we did in <a href="/blog/zitification/zitifying-ssh/">zitifying ssh</a>. I recommend reading the <a href="/blog/zitification/zitifying-ssh/">previous article</a>) if you haven&#x27;t to learn more about the benefits of zitifying tools like <code>ssh</code> and <code>scp</code>.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="first-things-first">First Things First<a class="hash-link" href="#first-things-first" title="Direct link to heading">​</a></h2><p><code>zscp</code> functions with the same prerequisites as <code>zssh</code>:</p><ul><li>Establish a <a href="/docs/quickstarts/network/hosted">Ziti Network</a></li><li>Create and enroll two Ziti Endpoints (one for our <code>ssh</code> server, one for the client)<ul><li>the <code>sshd</code> server will run <code>ziti-tunnel</code> for this demonstration. Conveniently it will run on the same machine I used to setup the <a href="/docs/introduction/">Ziti Network</a>.</li><li>the client, in this case, is my local machine and I&#x27;ll <code>zscp</code> files both to and from both the remote machine.</li></ul></li><li>Create the <a href="/docs/core-concepts/services/overview">Ziti Service</a> we&#x27;ll use and authorize the two endpoints to use this service</li><li>Use the <code>zscp</code> binary from the client side and the <code>ziti-tunnel</code> binary from the serving side to connect</li><li>Harden <code>sshd</code> further by removing port 22 from any internet-based firewall configuration (for example, from within the security-groups wizard in AWS) or by forcing <code>sshd</code> to only listen on <code>localhost/127.0.0.1</code></li></ul><p>After ensuring these steps are complete, you will have the ability to copy files across your Ziti Network. The traffic will be even more secure since now a Ziti Network is required for the connection, requiring that strong identity before even being able to access the <code>sshd</code> server. And of course now <code>sshd</code> is &#x27;dark&#x27; - it no longer needs the typical port 22 to be exposed to any network.</p><p>Given all the prerequisites are satisfied, we can put <code>zscp</code> to use. Simply download the binary for your platform:</p><ul><li><a href="https://github.com/openziti-incubator/zssh/releases/latest/download/zscp-linux-amd64" target="_blank" rel="noopener noreferrer">linux</a></li><li><a href="https://github.com/openziti-incubator/zssh/releases/latest/download/zscp-windows-amd64.exe" target="_blank" rel="noopener noreferrer">windows</a></li><li><a href="https://github.com/openziti-incubator/zssh/releases/latest/download/zscp-macos-amd64" target="_blank" rel="noopener noreferrer">MacOs</a></li></ul><span></span><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="sending-and-receiving-files-with-zscp">Sending and Receiving Files with Zscp<a class="hash-link" href="#sending-and-receiving-files-with-zscp" title="Direct link to heading">​</a></h2><p>Once you have the executable downloaded, make sure it is named <code>zscp</code> and for simplicity&#x27;s sake we&#x27;ll assume it&#x27;s on the path. Just like <code>zssh</code> to <code>ssh</code>, <code>zscp</code> provides the same basic functionality as <code>scp</code>. As with most tooling, executing the binary with no arguments will display the expected usage.</p><p>There are two main functions of <code>zscp</code>. Just like <code>scp</code> you can send and receive from the remote host.</p><p>To send files we use this basic syntax:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./zscp LOCAL_FILEPATHS</span><span class="token punctuation" style="color:#393A34">..</span><span class="token plain">. </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">REMOTE_USERNAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">@TARGET_IDENTITY:REMOTE_FILEPATH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Then, to retrieve remote files we use a similar syntax:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./zscp </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">REMOTE_USERNAME</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">@TARGET_IDENTITY:REMOTE_FILEPATH LOCAL_FILEPATH</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Below is a working example of using <code>zscp</code> to send a file to a remote machine. In this case the remote username is not the same as my local username. Just like with <code>scp</code>, I&#x27;ll need to supply the username in my command and it will use the same syntax that regular <code>scp</code> uses. Here I am <code>zscp&#x27;ing</code> as username <code>ubuntu</code> to the remote computer that is joined to the Ziti Network using the identity named <code>ziti-tunnel-aws</code>.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">./zscp local/1.txt ubuntu@ziti-tunnel-aws:remote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    connection to edge router using token 6c2e8b79-ce8e-483e-a9f8-a930530e706a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/1.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/1.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>This is only a basic example on how we can use <code>zscp</code> to send a singular file to a remote computer. In the next section, we will go over how to use <code>zscp</code> flags for extended functionality.</p><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="zscp-flags">Zscp Flags<a class="hash-link" href="#zscp-flags" title="Direct link to heading">​</a></h2><p>Just like <code>zssh</code>, <code>zscp</code> has the same flags to pass in: ssh key, ziti configuration file, service name, and one to toggle debug logging. All the defaults are the same as with <code>zssh</code>, thus both <code>zscp</code> and <code>zssh</code> will work without the <code>-i</code> and <code>-c</code> flag providing the files exist at the default locations. Refer to <!-- -->[<!-- -->zitifying-ssh<!-- -->]<!-- -->[<!-- -->2<!-- -->]<!-- --> for instructions on how to use the flags below.</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    -i, --SshKeyPath string   Path to </span><span class="token function" style="color:#d73a49">ssh</span><span class="token plain"> key. default: </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/.ssh/id_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -c, --ZConfig string      Path to ziti config file. default: </span><span class="token environment constant" style="color:#36acaa">$HOME</span><span class="token plain">/.ziti/zssh.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -d, --debug               pass to </span><span class="token builtin class-name">enable</span><span class="token plain"> additional debug information</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    -s, --service string      </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> name. </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">default </span><span class="token string" style="color:#e3116c">&quot;zssh&quot;</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>In addition to the flags above, <code>zscp</code> has a flag to enable recursive copying:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    -r, --recursive           pass to </span><span class="token builtin class-name">enable</span><span class="token plain"> recursive </span><span class="token function" style="color:#d73a49">file</span><span class="token plain"> transfer</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>To use the recursive flag, you must input a directory into the <code>LOCAL_FILEPATH</code> argument. Just like <code>scp</code>, <code>zscp</code> will copy all file contents under the provided directory. You can see below how we can use the <code>-r</code> flag to send all contents of <code>big_directory</code>.</p><p>Contents of <code>big_directory</code> on local computer:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">tree </span><span class="token builtin class-name">local</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token builtin class-name">local</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── big_directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── small_directory1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── small_directory2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── small_directory3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Here is the command and output:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ zscp -r big_directory ubuntu@ziti-tunnel-aws:remote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    connection to edge router using token d6c268ee-e4f5-4836-bd38-2fc1558257aa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/1.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/1.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/2.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/2.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/3.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/3.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/small_directory1/4.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/small_directory1/4.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/small_directory2/5.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/small_directory2/5.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">INFO    sent file: /Users/name/local/big_directory/small_directory3/6.txt </span><span class="token operator" style="color:#393A34">==</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> /home/ubuntu/remote/big_directory/small_directory3/6.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>After <code>zssh&#x27;ing</code> to the remote machine, we can prove that all files have been transferred to remote device:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ubuntu@IP:~$ tree remote/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remote/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└── big_directory</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">1</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">2</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── </span><span class="token number" style="color:#36acaa">3</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── small_directory1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── </span><span class="token number" style="color:#36acaa">4</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├── small_directory2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   └── </span><span class="token number" style="color:#36acaa">5</span><span class="token plain">.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └── small_directory3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        └── </span><span class="token number" style="color:#36acaa">6</span><span class="token plain">.txt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Recursive copying also works to retrieve all contents of a directory on the remote machine.</p><hr><p>I hope this post has helped you get familiar with another ziti-empowered developer&#x27;s tool and hopefully it&#x27;s becoming more clear why zitifying your application will make it more resilient to attack and make the act of connecting to remote services trivial.</p><p>Have a look at the code over at <a href="https://github.com/openziti-incubator/zssh/tree/main/zssh/zscp" target="_blank" rel="noopener noreferrer">GitHub</a> or continue reading on to the next zitification - <a href="/blog/zitification/kubernetes/">kubectl</a>!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/blog/zitification/prometheus/part3"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">Scraping Anything, Anywhere in Action</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/blog/zitification/zitifying-scp/zscp-cheatsheat"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">`zscp` Cheat Sheet</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#first-things-first" class="table-of-contents__link toc-highlight">First Things First</a></li><li><a href="#sending-and-receiving-files-with-zscp" class="table-of-contents__link toc-highlight">Sending and Receiving Files with Zscp</a></li><li><a href="#zscp-flags" class="table-of-contents__link toc-highlight">Zscp Flags</a></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 NetFoundry Inc. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.b124592a.js"></script>
<script src="/assets/js/main.23d1d9ae.js"></script>
</body>
</html>