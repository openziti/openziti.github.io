<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-learn/core-concepts/pki" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Public Key Infrastructure (PKI) | OpenZiti</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openziti.io/docs/learn/core-concepts/pki"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="index, follow"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Public Key Infrastructure (PKI) | OpenZiti"><meta data-rh="true" name="description" content="All networks leverage Public Key Infrastructure (PKI) to"><meta data-rh="true" property="og:description" content="All networks leverage Public Key Infrastructure (PKI) to"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://openziti.io/docs/learn/core-concepts/pki"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/learn/core-concepts/pki" hreflang="en"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/learn/core-concepts/pki" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-5SF399H3",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.febbdfed.css">
<script src="/assets/js/runtime~main.4d3c031a.js" defer="defer"></script>
<script src="/assets/js/main.882d5677.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF399H3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>




<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/ziti-logo-dark.svg"><link rel="preload" as="image" href="/img/ziti-logo-light.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="root_VOM9"><span style="color:whitesmoke">Star us on GitHub </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://openziti.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ziti-logo-light.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/downloads">Downloads</a><a href="https://blog.openziti.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li class=""><div class="text-divider"><p>Socials</p></div></li><li class=""><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/yt.svg">YouTube</span></a></li><li class=""><a href="https://x.com/OpenZiti" target="_blank" title="OpenZiti on X(formerly Twitter)"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/twit.svg">Twitter</span></a></li><li class=""><a href="https://www.reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/reddit-logo.png">Reddit</span></a></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/ziggy.png"><a href="https://x.com/OpenZiggy" target="_blank" title="OpenZiggy on Twitter">Ziggy</a></span></li><li class=""><div class="text-divider"><p>Other</p></div></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/blog-icon.png"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/oz-test-kitchen.png"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_eExm"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/learn/introduction/">LEARN</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/introduction/">What is OpenZiti?</a><button aria-label="Expand sidebar category &#x27;What is OpenZiti?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/quickstarts/">Quickstarts</a><button aria-label="Expand sidebar category &#x27;Quickstarts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/core-concepts">Core Concepts</a><button aria-label="Collapse sidebar category &#x27;Core Concepts&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/clients/choose">Clients</a><button aria-label="Expand sidebar category &#x27;Clients&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/identities/overview">Identities</a><button aria-label="Expand sidebar category &#x27;Identities&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn/core-concepts/services/overview">Services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/config-store/overview">Configuration Store</a><button aria-label="Expand sidebar category &#x27;Configuration Store&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/metrics/overview">Metrics</a><button aria-label="Expand sidebar category &#x27;Metrics&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/zero-trust-models/overview">Zero Trust Models</a><button aria-label="Expand sidebar category &#x27;Zero Trust Models&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/learn/core-concepts/data-flow-explainer">Data Flow Explainer</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/learn/core-concepts/security/overview">Security</a><button aria-label="Expand sidebar category &#x27;Security&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/learn/core-concepts/pki">PKI</a></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learn/identity-providers/">Identity Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/reference/">REFERENCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/configuration/conventions">Configuration</a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/reference/ha/overview">Controller Clustering</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/tunnelers/">Tunnelers</a><button aria-label="Expand sidebar category &#x27;Tunnelers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/command-line/login">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/logging">Logging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/config-types/">Config Types</a><button aria-label="Expand sidebar category &#x27;Config Types&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/events">Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/developer/">Developer</a><button aria-label="Expand sidebar category &#x27;Developer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/guides/">GUIDES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/deployments">Deployments</a><button aria-label="Expand sidebar category &#x27;Deployments&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/external-auth/">Configuring OIDC</a><button aria-label="Expand sidebar category &#x27;Configuring OIDC&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/hsm/">Hardware Keys</a><button aria-label="Expand sidebar category &#x27;Hardware Keys&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/topologies">Topologies</a><button aria-label="Expand sidebar category &#x27;Topologies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/core-concepts"><span itemprop="name">Core Concepts</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">PKI</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Public Key Infrastructure (PKI)</h1></header><p>All networks leverage <a href="https://en.wikipedia.org/wiki/Public_key_infrastructure" target="_blank" rel="noopener noreferrer">Public Key Infrastructure (PKI)</a> to
provide secure network connections.  This page is not intended to be a comprehensive guide. What it is, is a set of
rules that must be followed to properly configure a network. If there are issues when connecting any portion
of a network to another - this page should serve as a starting point of understanding.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>This article is about managing your own PKI. There&#x27;s a guide for using public CA certificates.</p></div></div>
<p>The network allows the operator to declare any trust anchors as valid. This means Ziti does not need to be
configured with a full chain of certificates which link fully back to a root CA. A configuration using a full chain back
to a root CA is of course supported but it is not explicitly required.  This allows the operator to configure a Ziti
Network using one or more chains of trust back to the provided trust anchors.  The sections below will describe where
these trust anchors can be configured.</p>
<p>Ziti Network components are required to present a certificate to other network components during the connection
establishment. This certificate will need to be valid per the configured trust anchor store being connected to.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ziti-controller">Ziti Controller<a href="#ziti-controller" class="hash-link" aria-label="Direct link to Ziti Controller" title="Direct link to Ziti Controller">​</a></h3>
<p>The controller has three distinct sections related to PKI: <code>identity</code>, <code>edge.api.identity</code>,
<code>edge.enrollment.signingCert</code>. The <code>edge.api.identity</code> configuration section is optional and is provided to allow the external
REST endpoint to present a certificate that is different than the one configured in the identity section.</p>
<p>Connections to the controller are considered valid if the certificate presented during connection is signed by a
trust anchor declared within the identity.ca configuration or if the certificate presented is signed by the certificate
specified in the <code>edge.enrollment.signingCert</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pki-configuration">PKI Configuration<a href="#pki-configuration" class="hash-link" aria-label="Direct link to PKI Configuration" title="Direct link to PKI Configuration">​</a></h4>
<p>The identity section of the controller configuration is used by the controller when connections are
established to or from other components of a network. There are four sections in the identity block:
<code>cert</code>, <code>server_cert</code>, <code>key</code>, <code>ca</code>.</p>
<p><strong>ca</strong>: A file representing a group of certificates with one or more certificate chains terminating at a trust anchor.
When a network component connects to the controller and offers a certificate for validation the incoming
connection is checked to see if it signed by a trust anchor specified in this file.</p>
<p><strong>key</strong>: Also referred to as the <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm" target="_blank" rel="noopener noreferrer">private key</a>. It is generated
first and used to produce the certificates specified in the <code>cert</code> and <code>server_cert</code> fields of the controller
configuration file.</p>
<p><strong>cert</strong>: The certificate presented to other network components during connection establishment.</p>
<p><strong>server_cert</strong>: The certificate returned by the controller when other network components attempt to
communicate to the controller over the IP and port specified in the <code>ctrl.listener</code> or <code>mgmt.listener</code> fields of the controller
configuration file. If an edge section is present in the configuration file and no edge.api.identity section exists this
certificate is also returned to incoming connections to the <code>edge.api.advertise</code> endpoint.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="edge-router">Edge Router<a href="#edge-router" class="hash-link" aria-label="Direct link to Edge Router" title="Direct link to Edge Router">​</a></h3>
<p>An edge router has one section related to PKI: <code>identity</code>. It is important to note that an edge router will
manage its own PKI. Allowing the edge router to manage its own PKI is almost certainly desired. The
only setting that an operator may wish to provide is the <code>key</code> field of the identity. This field is treated differently
than the other values specified.  If the <code>key</code> specified does not exist a new key will be generated. If the <code>key</code>
provided exists the edge router will use it and the other fields will be <strong>regenerated and overwritten</strong> as necessary.</p>
<p>The certificate generated will be signed by the controller using the certificate specified in <code>edge.enrollment.signingCert</code>.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="pki-configuration-1">PKI Configuration<a href="#pki-configuration-1" class="hash-link" aria-label="Direct link to PKI Configuration" title="Direct link to PKI Configuration">​</a></h4>
<p>The <code>identity</code> section of the edge router configuration is used by the edge router when connections are
established to or from the other components of a network. There are four sections in the identity block:
<code>cert</code>, <code>server_cert</code>, <code>key</code>, <code>ca</code>.</p>
<p><strong>ca</strong>: A file representing a group of certificates with one or more certificate chains terminating at a trust anchor.
When a network component connects to the edge router and offers a certificate for validation the incoming
connection is checked to see if it signed by a trust anchor specified in this file.</p>
<p><strong>key</strong>: Also referred to as the <a href="https://en.wikipedia.org/wiki/Symmetric-key_algorithm" target="_blank" rel="noopener noreferrer">private key</a>. It is generated
first and used to produce the certificates specified in the <code>cert</code> and <code>server_cert</code> fields of the Edge Router
configuration file.</p>
<p><strong>cert</strong>: The certificate presented to other network components during connection establishment.</p>
<p><strong>server_cert</strong>: The certificate returned by the edge router when other network components attempt to
communicate to the edge router over the IP and port specified in the <code>ctrl.listener</code> or <code>mgmt.listener</code> fields of the Edge Router
configuration file.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="third-party-ca-optional">Third Party CA (optional)<a href="#third-party-ca-optional" class="hash-link" aria-label="Direct link to Third Party CA (optional)" title="Direct link to Third Party CA (optional)">​</a></h3>
<p>A third party CA is one which is maintained and managed entirely outside of the network. This is an important
feature for organizations wishing to administer and maintain the certificates used by the different pieces of the Ziti
Network. A network is capable of using third party PKIs as the trust mechanism for enrollment and authentication of
clients for a network.</p>
<p>With the PKI being managed externally a network is never in possession of the private key. This means the Ziti
Network cannot maintain nor distribute certificates necessary for creating secure connections. The network is
only capable of verifying if the certificate presented was signed by the externally managed PKI.</p>
<p>Maintaining a PKI outside of the network is a more complex configuration. If a PKI is already established
and maintained externally setting up a network with a third party CA may be desired.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="registering-the-ca">Registering the CA<a href="#registering-the-ca" class="hash-link" aria-label="Direct link to Registering the CA" title="Direct link to Registering the CA">​</a></h4>
<p>A network will not trust any third party CA implicitly. Before a third party CA can be used for enrollment and
authentication of clients in a network it must be registered with the controller to ensure certificates signed
by the third party CA can be trusted.</p>
<p>Registering a third party CA is done by using the REST endpoint <code>/cas</code> from the controller. To register a third
party CA the following information is required to be posted to the endpoint:</p>
<ul>
<li><strong>name</strong>: the desired name of the CA</li>
<li><strong>isEnrollmentEnabled</strong>: a boolean value indicating if the CA can be used for enrollment. Defaults to true. Set to false
to prevent further enrollments using this CA</li>
<li><strong>isAuthEnabled</strong>: a boolean value indicating if the CA can be used for authentication. Defaults to true. Set to false to
prevent all authentication from endpoints signed by this certificate</li>
</ul>
<p>Assuming the create request was well formed and successful, the response from this invocation will contain a field
representing the <code>id</code> of the third party CA at <code>data.id</code>. The id of the third party CA will be needed when validating
the third party CA.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="validating-the-ca">Validating the CA<a href="#validating-the-ca" class="hash-link" aria-label="Direct link to Validating the CA" title="Direct link to Validating the CA">​</a></h4>
<p>After being submitted to the controller, the third party CA will have the isCsrValidated field set to false
indicating it is not yet ready for use. A second step is needed to ensure the third party CA is setup properly as a CA.
This step ensures the third party CA provided is capable of fulfilling CSR requests. Clients attempting to connect to a
Ziti Network using the third party CA will be rejected.</p>
<p>To validate the third party CA a CSR must be generated and fulfilled by the third party CA to generate a certificate
with the common name (CN) field set to a value assigned by the controller. The controller <code>/cas</code>
REST endpoint can be interrogated to retrieve the details for a specific third party CA. The field necessary to validate
the third party CA is <code>data.verificationToken</code> and is obtained at this endpoint. A certificate is then created and
signed by the third party CA with the common name field set to the verificationToken.</p>
<p>To finish verifying the third party CA, the certificate created with the verificationToken is posted back to the Ziti
Controller at <code>/cas/${id}/verify</code>. The <code>id</code> is also obtained during the creation process. After posting the certificate
with the <code>verificationToken</code> as the common name the third party CA will change from <code>isVerified=false</code> to <code>isVerified=true</code>.</p>
<p>Configuring a network&#x27;s PKI can be confusing. Validating a single side of a mutual TLS connection is
straightforward it becomes tedious to ensure all the certificates and cas in use are valid when you have a fully
configured network. It&#x27;s the goal of this page to make diagnosing PKI issues easier.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3>
<p>The following steps are <a href="https://en.wikipedia.org/wiki/Bash_(Unix_shell)" target="_blank" rel="noopener noreferrer">bash-based</a> functions and use the
<a href="https://www.openssl.org/" target="_blank" rel="noopener noreferrer">openssl</a>, <a href="https://stedolan.github.io/jq/" target="_blank" rel="noopener noreferrer">jq</a> and <a href="https://www.ruby-lang.org/en/" target="_blank" rel="noopener noreferrer">ruby</a>
commands. If you don&#x27;t have bash, openssl and ruby - this page is not for you! Do your best to follow along with the
scripts and guidance herein or just make sure bash, openssl, ruby, and jq are installed. All of which are widely
available on linux/MacOS/Windows.</p>
<p>The <code>ruby</code> and <code>jq</code> commands are not strictly required. They are used to make it easy for you to copy/paste these
commands. The <code>ruby</code> command is used to translate yaml into json while the <code>jq</code> command is used to pull the specific
values out of the given files. You can certainly do the same manually (without <code>ruby</code> and <code>jq</code>) if you choose.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="define-the-verifycertagainstpool-function">Define the verifyCertAgainstPool Function<a href="#define-the-verifycertagainstpool-function" class="hash-link" aria-label="Direct link to Define the verifyCertAgainstPool Function" title="Direct link to Define the verifyCertAgainstPool Function">​</a></h4>
<p>In your bash prompt copy and paste these two functions:</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    function yaml2json()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ruby -ryaml -rjson -e &#x27;puts JSON.pretty_generate(YAML.load(ARGF))&#x27; $*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    function verifyCertAgainstPool()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if [[ &quot;&quot; == &quot;$1&quot; ]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;Usage: verifyCertAgainstPool [cert to test] [ca pool to use]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if [[ &quot;&quot; == &quot;$2&quot; ]]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;Usage: verifyCertAgainstPool [cert to test] [ca pool to use]&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            return 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;    Verifying that this certificate:&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;        - $1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;    is valid for this ca pool:&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;        - $2&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        openssl verify -partial_chain -CAfile &quot;$2&quot; &quot;$1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if [ $? -eq 0 ]; then</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;============      SUCCESS!      ============&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            echo &quot;============ FAILED TO VALIDATE ============&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        fi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="validating-the-pki">Validating the PKI<a href="#validating-the-pki" class="hash-link" aria-label="Direct link to Validating the PKI" title="Direct link to Validating the PKI">​</a></h3>
<p>Every connection in a network is mutually authenticated via X509 certificates. It is easiest to first identify the
two components trying to communicate to isolate and minimize the configuration and files that need to be inspected.
Below you will find sections relevant to each of the pieces of Ziti which connect.</p>
<p>Each section will refer to a bash variable that is expected to be established before running the command. This variable
is intended to make it easier for you to simply copy/paste the command and determine if the configuration is valid or
not.</p>
<p>Using the provided bash function above - you will see one of two results:</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="success">Success<a href="#success" class="hash-link" aria-label="Direct link to Success" title="Direct link to Success">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool /path/to/cert-to-test.cert /path/to/capool.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Verifying that this certificate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /path/to/cert-to-test.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        is valid for this ca pool:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /path/to/capool.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /path/to/cert-to-test.cert: OK</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ============      SUCCESS!      ============</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="failure">Failure<a href="#failure" class="hash-link" aria-label="Direct link to Failure" title="Direct link to Failure">​</a></h4>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool /path/to/cert-to-test.cert /path/to/capool.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Verifying that this certificate:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /path/to/cert-to-test.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        is valid for this ca pool:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            - /path/to/capool.pem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    C = US, ST = NC, L = Charlotte, O = NetFoundry, OU = Ziti, CN = 87f8cee9-b288-49f1-ab90-b664af29e17a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error 20 at 0 depth lookup: unable to get local issuer certificate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    error /path/to/cert-to-test.cert: verification failed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ============ FAILED TO VALIDATE ============</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ziti-edge-router-to-controller">Ziti Edge Router to Controller<a href="#ziti-edge-router-to-controller" class="hash-link" aria-label="Direct link to Ziti Edge Router to Controller" title="Direct link to Ziti Edge Router to Controller">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables-to-establish-manually">Variables to Establish Manually<a href="#variables-to-establish-manually" class="hash-link" aria-label="Direct link to Variables to Establish Manually" title="Direct link to Variables to Establish Manually">​</a></h4>
<p>These two variables represent the edge router configuration file and the Controller configuration file.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    controller_config_file=~/.config/ziti/ziti-controller/ziti_controller.yml</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    edge_router_config_file=~/.config/ziti/ziti-router/ziti_router.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables---copypaste">Variables - Copy/Paste<a href="#variables---copypaste" class="hash-link" aria-label="Direct link to Variables - Copy/Paste" title="Direct link to Variables - Copy/Paste">​</a></h4>
<p>These commands extract the files specified in the configuration and store them into the assigned variables.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    edge_router_cert=$(yaml2json $edge_router_config_file | jq -j .identity.cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signing_cert=$(yaml2json $controller_config_file | jq -j .edge.enrollment.signingCert.cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_cert=$(yaml2json $controller_config_file | jq -j .identity.cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    edge_router_ca=$(yaml2json $edge_router_config_file | jq -j .identity.ca)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="commands-to-verify-pki-configuration">Commands to Verify PKI Configuration<a href="#commands-to-verify-pki-configuration" class="hash-link" aria-label="Direct link to Commands to Verify PKI Configuration" title="Direct link to Commands to Verify PKI Configuration">​</a></h4>
<p>Both of these commands should report SUCCESS.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool $edge_router_cert $signing_cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool $controller_cert $edge_router_ca</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ziti-client-to-controller---api">Ziti Client to Controller - API<a href="#ziti-client-to-controller---api" class="hash-link" aria-label="Direct link to Ziti Client to Controller - API" title="Direct link to Ziti Client to Controller - API">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables-to-establish-manually-1">Variables to Establish Manually<a href="#variables-to-establish-manually-1" class="hash-link" aria-label="Direct link to Variables to Establish Manually" title="Direct link to Variables to Establish Manually">​</a></h4>
<p>These two variables represent the identity file in json for a Ziti client and the Controller configuration file.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    identity_file=/path/to/enrolled-identity.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_config_file=~/.config/ziti/ziti-controller/ziti_controller.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables---copypaste-1">Variables - Copy/Paste<a href="#variables---copypaste-1" class="hash-link" aria-label="Direct link to Variables - Copy/Paste" title="Direct link to Variables - Copy/Paste">​</a></h4>
<p>These commands will extract the cert and ca from the enrolled identity file and put it into a file in the /tmp folder</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    jq -j .id.cert $identity_file | cut -d &quot;:&quot; -f2 &gt; /tmp/identity.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jq -j .id.ca $identity_file | cut -d &quot;:&quot; -f2 &gt; /tmp/identity.ca</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>These commands extract the files specified in the configuration and store them into the assigned variables.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    controller_cert=$(yaml2json $controller_config_file | jq -j .identity.cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    signing_cert=$(yaml2json $controller_config_file | jq -j .edge.enrollment.signingCert.cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    controller_api_server_cert=$(yaml2json $controller_config_file | jq -j .edge.api.identity.server_cert)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if [[ &quot;null&quot; == &quot;$controller_api_server_cert&quot; ]]; then controller_api_server_cert=$(yaml2json $controller_config_file | jq -j .identity.server_cert); fi</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="commands-to-verify-pki-configuration-1">Commands to Verify PKI Configuration<a href="#commands-to-verify-pki-configuration-1" class="hash-link" aria-label="Direct link to Commands to Verify PKI Configuration" title="Direct link to Commands to Verify PKI Configuration">​</a></h4>
<p>Both of these commands should report SUCCESS.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool /tmp/identity.cert $signing_cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool $controller_api_server_cert /tmp/identity.ca</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<hr>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="ziti-client-to-ziti-edge-router---data">Ziti Client to Ziti Edge Router - Data<a href="#ziti-client-to-ziti-edge-router---data" class="hash-link" aria-label="Direct link to Ziti Client to Ziti Edge Router - Data" title="Direct link to Ziti Client to Ziti Edge Router - Data">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables-to-establish-manually-2">Variables to Establish Manually<a href="#variables-to-establish-manually-2" class="hash-link" aria-label="Direct link to Variables to Establish Manually" title="Direct link to Variables to Establish Manually">​</a></h4>
<p>These two variables represent the identity file in json for a Ziti client and the Controller configuration file.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    identity_file=/path/to/enrolled-identity.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    edge_router_config_file=~/.config/ziti/ziti-router/ziti_router.yml</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="variables---copypaste-2">Variables - Copy/Paste<a href="#variables---copypaste-2" class="hash-link" aria-label="Direct link to Variables - Copy/Paste" title="Direct link to Variables - Copy/Paste">​</a></h4>
<p>This command will extract the ca from the enrolled identity file and put it into a file in the /tmp folder</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    jq -j .id.ca $identity_file | cut -d &quot;:&quot; -f2 &gt; /tmp/identity.ca</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>This command extracts the file specified in the configuration and stores it into the assigned variable.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    edge_router_cert=$(yaml2json $edge_router_config_file | jq -j .identity.cert)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="commands-to-verify-pki-configuration-2">Commands to Verify PKI Configuration<a href="#commands-to-verify-pki-configuration-2" class="hash-link" aria-label="Direct link to Commands to Verify PKI Configuration" title="Direct link to Commands to Verify PKI Configuration">​</a></h4>
<p>The following command should report SUCCESS.</p>
<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    verifyCertAgainstPool $edge_router_cert /tmp/identity.ca</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/learn/core-concepts/pki.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-03-26T22:12:55.000Z" itemprop="dateModified">Mar 26, 2025</time></b></span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/learn/core-concepts/security/sessions"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Session Types</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/learn/identity-providers/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Identity Providers</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#ziti-controller" class="table-of-contents__link toc-highlight">Ziti Controller</a></li><li><a href="#edge-router" class="table-of-contents__link toc-highlight">Edge Router</a></li><li><a href="#third-party-ca-optional" class="table-of-contents__link toc-highlight">Third Party CA (optional)</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#validating-the-pki" class="table-of-contents__link toc-highlight">Validating the PKI</a></li><li><a href="#ziti-edge-router-to-controller" class="table-of-contents__link toc-highlight">Ziti Edge Router to Controller</a></li><li><a href="#ziti-client-to-controller---api" class="table-of-contents__link toc-highlight">Ziti Client to Controller - API</a></li><li><a href="#ziti-client-to-ziti-edge-router---data" class="table-of-contents__link toc-highlight">Ziti Client to Ziti Edge Router - Data</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a class="footer__link-item" href="/policies/CODE_OF_CONDUCT">Policies</a><span class="footer__link-separator">·</span><a href="https://netfoundry.io/products/netfoundry-platform/netfoundry-cloud-for-openziti/" target="_blank" rel="noopener noreferrer" class="footer__link-item">NetFoundry Cloud</a><span class="footer__link-separator">·</span><a href="https://blog.openziti.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 NetFoundry Inc.</div></div></div></footer></div>
</body>
</html>