<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true"></title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="robots" content="index, follow"><meta data-rh="true" property="og:title" content="Tunneling VoIP over OpenZiti | OpenZiti"><meta data-rh="true" name="description" content="In this article we will look at what is VoIP (voice over IP), why it is inherently vulnerable to network based attacks,"><meta data-rh="true" property="og:description" content="In this article we will look at what is VoIP (voice over IP), why it is inherently vulnerable to network based attacks,"><meta data-rh="true" property="og:image" content="http://localhost:3000/@site/blogs/openziti//EAmibi9_df.jpeg"><meta data-rh="true" name="twitter:image" content="http://localhost:3000/@site/blogs/openziti//EAmibi9_df.jpeg"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-08-05T15:43:13.000Z"><meta data-rh="true" property="article:author" content="https://github.com/scareything"><meta data-rh="true" property="article:tag" content="Security,Networking,VoIP"><meta data-rh="true" data-rh="true" name="nf-layout-version" content="0.0.168"><meta data-rh="true" name="twitter:card" content="summary_large_image"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti"><link data-rh="true" rel="alternate" href="http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti","mainEntityOfPage":"http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti","url":"http://localhost:3000/docs/openziti/blog/tunneling-voip-over-openziti","headline":"Tunneling VoIP over OpenZiti","name":"Tunneling VoIP over OpenZiti","description":"In this article we will look at what is VoIP (voice over IP), why it is inherently vulnerable to network based attacks,","datePublished":"2022-08-05T15:43:13.000Z","author":{"@type":"Person","name":"Shawn Carey","description":"Author","url":"https://github.com/scareything","image":"https://avatars.githubusercontent.com/scareything"},"image":{"@type":"ImageObject","@id":"http://localhost:3000/@site/blogs/openziti//EAmibi9_df.jpeg","url":"http://localhost:3000/@site/blogs/openziti//EAmibi9_df.jpeg","contentUrl":"http://localhost:3000/@site/blogs/openziti//EAmibi9_df.jpeg","caption":"title image for the blog post: Tunneling VoIP over OpenZiti"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"http://localhost:3000/docs/openziti/blog","name":"Blog"}}</script><script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:3576473,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script>
<link rel="alternate" type="application/rss+xml" href="/docs/openziti/blog/rss.xml" title="OpenZiti RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/openziti/blog/atom.xml" title="OpenZiti Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-5SF399H3",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.273075c6.css">
<script src="/assets/js/runtime~main.5c8b5ad4.js" defer="defer"></script>
<script src="/assets/js/main.f686f705.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF399H3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/ziti-logo-dark.svg"><link rel="preload" as="image" href="/img/ziti-logo-light.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/scareything"><link rel="preload" href="https://i.ytimg.com/vi/ygHTixbra6A/hqdefault.jpg" as="image"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ziti-logo-light.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://netfoundry.io/products/netfoundry-cloud-30-day-free-trial/" target="_blank">NetFoundry</a></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/openziti/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/openziti/downloads">Downloads</a><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://blog.openziti.io/" target="_blank">Blog</a></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li class=""><div class="text-divider"><p>Socials</p></div></li><li class=""><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/yt.svg" alt="YouTube logo">YouTube</span></a></li><li class=""><a href="https://x.com/OpenZiti" target="_blank" title="OpenZiti on X(formerly Twitter)"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/twit.svg" alt="X/Twitter logo">X (Twitter)</span></a></li><li class=""><a href="https://www.reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/reddit-logo.png" alt="Reddit logo">Reddit</span></a></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/ziggy.png" alt="X/Twitter Ziggy logo"><a href="https://x.com/OpenZiggy" target="_blank" title="OpenZiggy on X(formerly Twitter)">Ziggy</a></span></li><li class=""><div class="text-divider"><p>Other</p></div></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/blog-icon.png" alt="OpenZiti blog logo"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/oz-test-kitchen.png" alt="OpenZiti Test Kitchen logo"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="styles-module_starUsRoot__hMNZp"><span style="color:whitesmoke">Star Us on GitHub<!-- --> </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><div class="main-wrapper NetFoundryLayout-module_ozLayoutMainWrapper__a2vwh"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-zrok-10">Introducing zrok 1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-unleashed-top-10-uses-explored">zrok Unleashed: Top 10 Uses Explored</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-ziti-identities-with-hsmtpm">Securing Ziti Identities with HSM/TPM</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-custom-domains">zrok Custom Domains</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-oop">Golang Aha! Moments: OOP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-safest-way-to-make-portainer-internet-accessible">The safest way to make Portainer Internet accessible</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/multifactor-zero-trust-ssh">Multifactor Zero Trust ssh</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-sshclient">Zero Trust *ssh.Client</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/effortless-docker-management-with-private-web-access">Effortless Docker Management</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-is-growing-up">zrok is Growing Up</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-vpn-linux-service">Easy Steps to Install a Private VPN on Linux with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/jitsi-meet-zrok">Jitsi, meet zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/extend-access-to-a-private-s3-bucket-using-python">Extend Access to a Private S3 Bucket Using Python</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/why-we-verify-github-commits">Why We Verify GitHub Commits</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/limitless-zrok-with-docker">Limitless zrok with Docker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/how-to-prevent-path-traversal-attacks-with-openziti-browzer">How to Prevent Path Traversal Attacks with OpenZiti BrowZer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-vpn">zrok VPN</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/deploy-openziti-in-kubernetes-with-ease-using-k3d">Deploy OpenZiti in Kubernetes with Ease Using k3d</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/signing-executables-from-github-actions">Signing Executables From GitHub Actions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-nodejs-zrok-sdk">The NodeJS zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/no-listening-ports">No Listening Ports?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/announcing-openziti-v1">Announcing OpenZiti v1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/pixy-dust-for-web-applications-pkce">Pixy Dust For Web Applications</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/secure-remote-development-with-zrok-and-jetbrains">Secure Remote Development with zrok and JetBrains</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-permission-modes">zrok Permission Modes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-socks-backend">The zrok SOCKS Backend</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-python-zrok-sdk">The Python zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-dedicated-palworld-server-with-zrok">Securing a Dedicated  Palworld Server For My Family with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/fun-with-adaptive-rate-limiting">Fun with Adaptive Rate Limiting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-drives-cli-preview">The zrok Drives CLI Preview</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/minecraft-over-zrok">Minecraft Over zrok</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/go-is-amazing-for-zero-trust">Go is Amazing for Zero Trust</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-frontdoor">zrok frontdoor</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/business-rule-driven-just-in-time-network-access">Business Rule Driven Just-in-Time Network Access</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-drives-an-early-preview">zrok Drives (an Early Preview)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/put-some-ziti-in-your-caddy">Put some Ziti in your Caddy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-oauth-public-frontend">The zrok OAuth Public Frontend</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-azure-openai-applications-with-openziti">Securing Azure OpenAI Applications with OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-zero-trust-iot-wi-fi-gateway">OpenZiti Zero Trust IoT Wi-Fi Gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-with-the-power-of-caddy">zrok with the Power of Caddy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-sdk">The zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/got-5-minutes-secure-your-python-website-with-zero-trust">Got 5 Minutes? Secure Your Python Website with Zero Trust.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/announcing-the-zrok-public-beta">Announcing the zrok Public Beta!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-v040-released">zrok v0.4.0 Released!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/commercial-open-source-and-ethical-and-practical-community-engagement">Commercial Open Source and Ethical (and practical) Community Engagement</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/my-pi-day-journey-with-go-64-bit-alignment">My Pi Day Journey with Go 64-bit alignment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/private-dns-on-windows">Private DNS on Windows</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/websockets-over-zrok">Websockets over zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openapi-python-clients">OpenAPI Python Clients</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/postman-mgmt">Postman and the Management API</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-road-ahead-for-zrok">The Road Ahead for zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/auto-complete">Ziti Shell Auto-Complete</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-zrok">Introducing zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/connecting-to-local-development-environment-from-cloud-hosts-with-zrok">Connecting to Local Development Environment from Cloud Hosts with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/lessons-learned-writing-a-zero-trust-nginx-module">Lessons Learned Writing a Zero Trust NGINX Module</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-monitoring-with-openziti">Zero Trust Monitoring with OpenZiti</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/its-a-zitiful-life">It&#x27;s A Zitiful Life</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/nginx-zerotrust-api-security">NGINX &amp; ZeroTrust API Security</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/using-ebpf-tc-to-securely-mangle-packets-in-the-kernel-and-pass-them-to-my-secure-networking-application">Using eBPF-TC to securely mangle packets in the kernel, and pass them to my secure networking application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/browzer-gateway-fqdn-certs">OpenZiti BrowZer Gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-authentication-api-integrations">OpenZiti Authentication API Integrations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/high-level-publicprivate-cryptography">High-Level Public/Private Cryptography</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/set-up-a-secure-multiplayer-minecraft-server">Set Up a Secure Multiplayer Minecraft Server</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/setting-up-oracle-cloud-to-host-openziti">Setting Up Oracle Cloud To Host OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/integrating-ziti-is-easy">Integrating Ziti is Easy! How we got our app tested with go-httpbin</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-generics">Golang Aha! Moments: Generics</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-nodejs-applications">Securing NodeJS Applications — An Introduction to the OpenZiti SDK for NodeJS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-is-participating-in-hacktoberfest-prost">OpenZiti is Participating in Hacktoberfest, Prost!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-python-sdk-introduction">OpenZiti Python SDK: Introduction</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/free-secure-access-to-nas-from-anywhere">Free Secure Access to NAS From Anywhere</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-openziti-browzer">Introducing OpenZiti BrowZer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-channels">Golang Aha! Moments: Channels</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-overlay-network-to-access-homeassistant">I Created a Zero Trust Overlay Network to Access HomeAssistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/my-intern-assignment-call-a-dark-webhook-from-aws-lambda">My Intern Assignment - Call a Dark Webhook from AWS Lambda</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/extrovert-wednesday">Extrovert Wednesday</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-web-apis-with-openziti">Securing Web APIs With OpenZiti — Zero Trust For Web APIs</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/docs/openziti/blog/tunneling-voip-over-openziti">Tunneling VoIP over OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-5-bootstrapping-trust">Bootstrapping Trust Part 5</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-4-certificate-authorities-chains-of-trust">Bootstrapping Trust Part 4</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-3-certificates">Bootstrapping Trust Part 3 - Certificates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-2-a-primer-on-public-key-cryptography">Bootstrapping Trust Part 2 - PKI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-1-encryption-everywhere">Bootstrapping Trust Part 1 - Encryption Everywhere</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/configuring-openziti-to-enable-prometheus">Configuring OpenZiti to Enable Prometheus</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere">Prometheus - Scrape Anything from Anywhere</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/scraping-anything-anywhere-in-action">Scraping Anything, Anywhere in Action</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/kubernetes">Tunneling Ingress to Kubernetes Workloads</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitifying-scp">Zitifying SCP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitifying-ssh">Zitifying SSH</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitification">Zitification</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2020</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/mobile-point-of-sale-mpos-app-ziti-android-java-sdk-integration">Mobile Point of Sale (mPOS) app – embed zero trust networking</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Tunneling VoIP over OpenZiti</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-08-05T15:43:13.000Z">August 5, 2022</time> · <!-- -->15 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/scareything" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/scareything" alt="Shawn Carey"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/scareything" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Shawn Carey</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p>In this article we will look at what is VoIP (voice over IP), why it is inherently vulnerable to network based attacks,
and how we can stop these attacks by closing inbound ports using open-source OpenZiti.</p>
<p>This will include a how-to guide on standing up an OpenZiti network and using OpenZiti tunnelers to connect IP phones
from anywhere in the world using a Asterisk PBX server.</p>
<p>&quot;VoIP&quot; is an acronym for &quot;voice over IP&quot;. It refers to a collection of protocols for coordinating calls between multiple phones and transferring the call data (e.g. voice, video, screen share, etc) - including making calls directly from data-driven devices (a <a href="https://explore.zoom.us/en/what-is-voip-phone/" target="_blank" rel="noopener noreferrer">VoIP phone</a>, your computer, etc.)</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="my-voip-is-working-perfectly-right-now-whats-the-problem">My VoIP is working perfectly right now… what’s the problem?<a href="#my-voip-is-working-perfectly-right-now-whats-the-problem" class="hash-link" aria-label="Direct link to My VoIP is working perfectly right now… what’s the problem?" title="Direct link to My VoIP is working perfectly right now… what’s the problem?">​</a></h2>
<p><img decoding="async" loading="lazy" alt="voip-vulnerability-architecture.png" src="/assets/images/HCbn-iFaF-2c2101db6088ba961452bb849fd8d00b.png" width="764" height="301" class="img_ev3q"></p>
<p>VoIP inherently relies on a strong and stable internet connection with low latency. Any disruption can impact performance and service availability. VoIP systems have critical components which need to be open to networks to operate – including SIP servers, SBCs, IP-PBX, proxies and TURN servers. By being exposed to the network (and internet) these systems are vulnerable to external attack, including DoS/DDoS. In 2021 we saw an <a href="https://www.techradar.com/news/ddos-attack-takes-yet-another-voip-provider-offline" target="_blank" rel="noopener noreferrer">upsurge in the number of damaging DoS, DDoS and ransomware type cyberattacks</a> against VoIP systems.</p>
<p>While not a problem for all VoIP users, some have stringent availability requirements – e.g., a critical services call – where any disruption causes business downtime. We have mitigation techniques which help, but they are inherently limited – e.g., attacks against VoIP providers in 2021, <a href="https://netfoundry.io/why-ddos-and-dos-targets-voip-and-how-zero-trust-can-mitigate-the-threat/" target="_blank" rel="noopener noreferrer">mitigation techniques</a> only provided limited and temporary respite. What if we could deploy our VoIP systems and not have them exposed to the network… particularly the approximately 4.3 billion IPs on the public internet?</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="invisible-voip">Invisible VoIP<a href="#invisible-voip" class="hash-link" aria-label="Direct link to Invisible VoIP" title="Direct link to Invisible VoIP">​</a></h2>
<p>We created OpenZiti to provide the next generation of secure, open-source networking for any application. It allows you to easily apply zero-trust principles, and high-performance mesh networking on any Internet connection, without VPNs.</p>
<p><img decoding="async" loading="lazy" alt="secure-voip-architecture.png" src="/assets/images/vwC0Tlg8z-0713d5fb82c999b2e9b4e41fcec2c283.png" width="471" height="270" class="img_ev3q"></p>
<p>Both sides of the application, VoIP in this case, use strong identity (X.509 certificate; bi-directionally authenticated and authorized) to build outbound-only overlays – we call this <!-- --></p><article class="yt-lite" data-title="YouTube video" style="background-image:url(https://i.ytimg.com/vi/ygHTixbra6A/hqdefault.jpg);--aspect-ratio:56.25%"><button type="button" class="lty-playbtn" aria-label="Watch YouTube video"></button></article>. As a result, our critical components do not need to be exposed to the internet - closed inbound ports or deny all inbound on the firewall.<br>
<!-- -->An application using a Ziti Network configured with a truly zero-trust mindset will be IMMUNE to the &quot;expand/multiply&quot; phases of classic ransomware attacks.<p></p>
<p>We must remember though that VoIP is sensitive to having a stable and performant network. Luckily we built in features such as high throughput and smart routing into the mesh overlay which allows VoIP to operate without the traditional limitations associated with VPNs.</p>
<p>In this article we’ll show you how to use OpenZiti tunnelers to connect IP phones from anywhere in the world to an Asterisk server that doesn&#x27;t expose any ports to the Internet. The protocols that we&#x27;ll set up ziti services for today are SIP (<a href="https://en.wikipedia.org/wiki/Session_Initiation_Protocol" target="_blank" rel="noopener noreferrer">session initiation protocol</a>) for call coordination, and RTP (<a href="https://en.wikipedia.org/wiki/Real-time_Transport_Protocol" target="_blank" rel="noopener noreferrer">real time transport protocol</a>) for voice audio streams.</p>
<p>We would like to get your feedback on our solution and experience. A great place for questions and conversation is in our <a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer">discourse community</a>.</p>
<h1>OpenZiti Setup</h1>
<p>The Ziti network that is shown in this article consists of a Ziti controller and a single Ziti edge router. Check out one of the <a href="https://openziti.github.io/ziti/quickstarts/quickstart-overview.html" target="_blank" rel="noopener noreferrer">Ziti Quickstarts</a> for some guides on setting up a Ziti network of your own.</p>
<p>In addition to the Ziti network, we also need <a href="https://openziti.github.io/ziti/clients/tunneler.html" target="_blank" rel="noopener noreferrer">Ziti Tunnelers</a> installed on the Asterisk and soft phone hosts to proxy SIP and RTP packets to/from the Ziti network.</p>
<p>--------------------- --------------------- --------------------- | Linphone | | Asterisk | | Linphone | | _____ | | ,__ | | _____ | | (.---.)-.<em>.-. | | ( * ) | | (.---.)-.</em>.-. | | /:::\ _.---&#x27; | | ``&#x27; | | /:::\ _.---&#x27; | | &#x27;-----&#x27; | | | | &#x27;-----&#x27; | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | | /\ | | /\ | | /\ | | //\ | | //\ | | //\ | | \// | | \// | | \// | | / | | / | | / | | | | | | | | Ziti Desktop Edge | | ziti-edge-tunnel | | Ziti Desktop Edge | | for macOS | | for Linux | | for Windows | --------------------- --------------------- ---------------------</p>
<p>___________ / ___ /<br>
<!-- -->| | ________________/</p>
<p>------------------- ------------------- | /\ | | /\ | | //\ | | //\ | | \// | | \// | | / | | / | | | | | | ziti-controller | | ziti-router | ------------------- -------------------</p>
<p>Once the Ziti controller is up and running we can create the Ziti service along with identities and policies.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="identities">Identities<a href="#identities" class="hash-link" aria-label="Direct link to Identities" title="Direct link to Identities">​</a></h2>
<p>Ziti identities are the basis for authentication to a Ziti network. You can think of Ziti identities as user accounts. See <a href="https://openziti.io/docs/learn/core-concepts/identities/overview" target="_blank" rel="noopener noreferrer">the Ziti docs</a> for more information on identities.</p>
<p>We&#x27;ll create three identities for our VoIP system: one to represent the Asterisk server and two more to represent connected IP phones:</p>
<p>$ ziti edge create identity device asterisk --role-attributes &#x27;asterisk-voip-server&#x27; -o asterisk.jwt $ ziti edge create identity device ext6001 --role-attributes &#x27;asterisk-voip-client&#x27; -o ext6001.jwt $ ziti edge create identity device ext6002 --role-attributes &#x27;asterisk-voip-client&#x27; -o ext6002.jwt</p>
<p>Keep track of the JWT files that are created here. They&#x27;ll be used to enroll the identities with the network when the tunnelers are installed. The role attributes will be used when we define the service policies.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="service-configuration">Service Configuration<a href="#service-configuration" class="hash-link" aria-label="Direct link to Service Configuration" title="Direct link to Service Configuration">​</a></h2>
<p>The asterisk server will handle SIP messages as well as proxy RTP packets between phones. SIP is accessed at port 5060 and the RTP port range is defined in the Asterisk configuration (rtp.conf). The Ziti service configuration shown here assumes the default RTP port range of 10000-20000.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ ziti edge create config asterisk-voip.intercept.v1 intercept.v1 &#x27;{ &quot;protocols&quot;: \[ &quot;udp&quot; \], &quot;addresses&quot;: \[ &quot;192.168.8.1&quot; \], &quot;portRanges&quot;: \[ { &quot;low&quot;: 5060, &quot;high&quot;: 5060 }, { &quot;low&quot;: 10000, &quot;high&quot;: 20000 } \] }&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ziti edge create config asterisk-voip.host.v1 host.v1 &#x27;{ &quot;protocol&quot;: &quot;udp&quot;, &quot;address&quot;: &quot;127.0.0.1&quot;, &quot;forwardPort&quot;: true, &quot;allowedPortRanges&quot;: \[ { &quot;low&quot;: 5060, &quot;high&quot;: 5060 }, { &quot;low&quot;: 10000, &quot;high&quot;: 20000 } \] }&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">$ ziti edge create service asterisk-voip -c asterisk-voip.intercept.v1,asterisk-voip.host.v1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="policies">Policies<a href="#policies" class="hash-link" aria-label="Direct link to Policies" title="Direct link to Policies">​</a></h2>
<p>Ziti policies determine which identities can access which Ziti services.</p>
<p>Identities with the &quot;asterisk-voip-server&quot; identity role will be able to host the services, and those with the &quot;asterisk-voip-client&quot; role will be able to dial the service:</p>
<p>$ ziti edge create service-policy asterisk-voip-client Dial<br>
<!-- -->--identity-roles &#x27;#asterisk-voip-client&#x27;<br>
<!-- -->--service-roles &#x27;@asterisk-voip&#x27;</p>
<p>$ ziti edge create service-policy asterisk-voip-server Bind<br>
<!-- -->--identity-roles &#x27;#asterisk-voip-server&#x27;<br>
<!-- -->--service-roles &#x27;@asterisk-voip&#x27;</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="tunneler-installation">Tunneler Installation<a href="#tunneler-installation" class="hash-link" aria-label="Direct link to Tunneler Installation" title="Direct link to Tunneler Installation">​</a></h2>
<p>Install the Ziti tunnelers on any hosts that will participate in your VoIP network. This article uses macOS, Windows, and Linux tunnelers. See <a href="https://openziti.github.io/ziti/clients/tunneler.html" target="_blank" rel="noopener noreferrer">https://openziti.github.io/ziti/clients/tunneler.html</a> for more info on tunnelers and how to install them.</p>
<p>Once installed, you&#x27;ll use the tunnelers &quot;Add Identity&quot; (on &quot;enroll&quot;) function to register the identity JWT file that was created above.</p>
<h1>Asterisk Setup</h1>
<p>I installed Asterisk on Fedora with the following command:</p>
<p>$ sudo dnf install -y asterisk asterisk-pjsip asterisk-sounds-core-en-wav</p>
<p>These packages installed some sample configuration files in /etc/asterisk. For this article, I moved the pjsip and extensions example configuration files out of the way before creating my own.</p>
<p>$ sudo mv /etc/asterisk/pjsip.conf /etc/asterisk/pjsip.conf.orig $ sudo mv /etc/asterisk/externsions.conf /etc/asterisk/extensions.conf.orig</p>
<p>The complete pjsip.conf and extensions.conf that I used for the setup in this article are attached below for reference. Here I&#x27;ll point out a few details that are relevant to tunneling SIP and RTP.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="darkness">Darkness<a href="#darkness" class="hash-link" aria-label="Direct link to Darkness" title="Direct link to Darkness">​</a></h2>
<p>One benefit of connecting applications with Ziti is that all application components, including servers that accept incoming connections from clients, can be hidden behind a completely closed firewall. We&#x27;ll configure Asterisk to listen for connections on the loopback interface. This is possible because the tunneler that connects Asterisk to our Ziti network is running on the same host as Asterisk. So not only is our Asterisk server inaccessible from the Internet; it&#x27;s also inaccessible from the LAN.</p>
<p>Here&#x27;s the bit from pjsip.conf that sets the bind address:</p>
<p>;===============TRANSPORT [transport-udp] type=transport protocol=udp bind=127.0.0.1</p>
<p>Notice that the <code>host.v1</code> service configuration above must agree with the Asterisk listen address that&#x27;s specified here. Specifically, the <code>bind</code> address in <em>/etc/asterisk/pjsip.conf</em> must match the <code>host.v1</code> &quot;address&quot; field, and the <code>rtpstart</code> and <code>rtpend</code> ports in <em>/etc/asterisk/rtp.conf</em> must be included in the <code>inttercept.v1</code> &quot;portRanges&quot; and <code>host.v1</code> &quot;allowedPortRanges&quot; fields.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="address-translation">Address Translation<a href="#address-translation" class="hash-link" aria-label="Direct link to Address Translation" title="Direct link to Address Translation">​</a></h2>
<p>We need to take special care in the Asterisk configuration so that it works correctly and reliably with Ziti tunnelers. The main issues that we need to deal with stem from the fact that the phones cannot connect to each other directly, and Asterisk cannot initiate connections to phones.</p>
<ol>
<li>
<p>Asterisk provides IP phones with addresses that the phones will use to connect to Asterisk. We need to make sure that Asterisk always provides the address in the <code>intercept.v1</code> Ziti service configuration, so connections are made to Asterisk instead of other phones. Note that we are working on a feature that makes it possible for IP phones to connect each other&#x27;s media streams directly - avoiding the extra hop through Asterisk. Take a look at <a href="https://github.com/openziti/ziti-tunnel-sdk-c/issues/443" target="_blank" rel="noopener noreferrer">https://github.com/openziti/ziti-tunnel-sdk-c/issues/443</a> for more details, and please do let me know in the comments (here or on the github issue) if direct media connections are something that is important to you.</p>
</li>
<li>
<p>Asterisk cannot initiate connections to the IP phones, so we need to make sure that the inbound connections from IP phones stay open to serve as a return path to the phones.</p>
</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sip">SIP<a href="#sip" class="hash-link" aria-label="Direct link to SIP" title="Direct link to SIP">​</a></h3>
<p>SIP is a http-like protocol that is used for phone registration and setting up calls between phones. SIP agents (including IP phones and Asterisk) add a <code>Via</code> header to outbound SIP messages. Each agent that initiates or proxies a SIP message adds its own <code>Via</code> with an address (protocol:ip<!-- -->:port<!-- -->) that the recipient should use when sending SIP responses.</p>
<p>By default, Asterisk populates <code>Via</code> with the destination IP address of the inbound connection from the client This makes sense sometimes, particularly if there is no address translation (NAT) between the clients and the Asterisk server. But in our case we&#x27;ve chosen to lock down the Asterisk transport, so all inbound connections to Asterisk are going to 127.0.0.1. This means that phones will try to send SIP responses to themselves (127.0.0.1) unless we do something to change that! Fortunately the pjsip module supports the <code>external_signaling_address</code> configuration setting so that we can force the intercept address for our SIP service into the <code>Via</code> header of SIP messages that Asterisk sends to phones.</p>
<p>; provide ziti intercepted IP to clients external_signaling_address=192.168.8.1 ;; use when populating SDP fields</p>
<p>Asterisk also needs to be able to send unsolicited SIP messages to phones, for example a SIP <code>INVITE</code> is sent to the receiving phone when another phone initiates a call. Asterisk sends SIP messages to phones at the source IP<!-- -->:port<!-- --> from the phone&#x27;s most recent inbound SIP message by default. This behavior will work for us if we can ensure that UDP connections (for SIP) between the hosting tunneler and the Asterisk server stay alive to serve as a return path to the phone.</p>
<p>To keep the SIP/UDP connections alive at the hosting tunneler we need to defeat logic in the client tunneler&#x27;s that kills intercepted UDP connections when they&#x27;ve been idle for 30 seconds. We can use the <code>qualify_frequency</code> configuration setting in <em>pjsip.conf</em> to make sure that bytes move frequently enough to prevent the client&#x27;s connection (and by extension the Ziti connection and the UDP connection at the hosting tunneler) from going idle:</p>
<p>; prevent client tunnelers from closing SIP/UDP connections due to 30s idle timeout. qualify_frequency=20</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="rtp">RTP<a href="#rtp" class="hash-link" aria-label="Direct link to RTP" title="Direct link to RTP">​</a></h3>
<p>SIP is used for setting up calls between phones, RTP carries the &quot;media&quot; (e.g. voice data) of VoIP calls. Each IP phone that participates in a call provides the address that other phones can connect to for the outbound media stream. Typically, the media stream consists of RTP packets. The important point is that each phone&#x27;s media stream is carried on a discrete connection, and the phone provides the address for that media connection in the SIP <code>INVITE</code> and <code>OK</code> messages that were exchange when the call was set up.</p>
<p>Of course, unless two phones are on the same network then it is unlikely that the phones will be able to produce an address that is routable from the other phones. This is why we are using Asterisk to proxy RTP connections (for now, at least). There are a few configuration options in <em>pjsip.conf</em> that we can use to ensure phones receive routable addresses for connecting to other phones:</p>
<table><thead><tr><th>Configuration Item</th><th>Description</th></tr></thead><tbody><tr><td><code>external_media_address</code></td><td>Address to use when populating SDP payloads. This will match the Ziti intercept address.</td></tr><tr><td><code>direct_media=no</code></td><td>Always use <code>external_media_address</code> in SDP content of outbound SIP messages.</td></tr><tr><td><code>rtp_symmetric=yes</code></td><td>Asterisk returns RTP packets to the source IP<!-- -->:port<!-- --> of incoming RTP messages.</td></tr></tbody></table>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sipsdp-conversation">SIP/SDP Conversation<a href="#sipsdp-conversation" class="hash-link" aria-label="Direct link to SIP/SDP Conversation" title="Direct link to SIP/SDP Conversation">​</a></h3>
<p>Here&#x27;s an example of a SIP/SDP INVITE conversation between a calling phone, Asterisk, and the receiving phone when everything is set up correctly:</p>
<p>ext 6001 Asterisk ext 6002 _____ _____ _____ (.---.)-.<em>.-. |=====| (.---.)-.</em>.-. /:::\ _.---&#x27; |^* | /:::\ _.---&#x27; &#x27;-----&#x27; |:::: | &#x27;-----&#x27; ______________________________________ |:::: | ______________________________________ | INVITE sip:6001@192.168.8.1 SIP/2.0 \ ---&gt; |:::: | ---&gt; | INVITE sip:6001@192.168.8.1 SIP/2.0<br>
<!-- -->| Via: SIP/2.0/UDP 100.64.0.1:52047 | | | | Via: SIP/2.0/UDP 192.168.8.1:5060 | (1) | c=IN IP4 100.64.0.1 | ------- | c=IN IP4 192.168.8.1 | (2) | m=audio 7078 RTP/AVP 96 97 98 0 ... | | m=audio 16382 RTP/AVP 0 101 | (3) --------------------------------------- ---------------------------------------</p>
<ol>
<li>
<p>The <code>Via</code> address in the message that Asterisk sends to the receiving phone is the <code>external_signaling_address</code></p>
</li>
<li>
<p>The &quot;c=&quot; media address in the SDP <code>INVITE</code> message is the <code>external_media_address</code></p>
</li>
<li>
<p>The &quot;m=&quot; audio connection port is not the phone&#x27;s audio port, but one from the configured rtp port range because <code>direct_media</code> is disabled</p>
</li>
</ol>
<h1>Linphone Configuration</h1>
<p>Setting up Linphone is pretty straightforward; you just need to create a SIP account that connects to the intercepted address that&#x27;s specified in the Ziti service:</p>
<p><img decoding="async" loading="lazy" alt="linphone-macos-setup.png" src="/assets/images/Xr1ffyp4Z-775bef24c2db44293e5f12599b1dc37b.png" width="2272" height="1560" class="img_ev3q"></p>
<p>The service will show a green checkmark if everything is working ok:</p>
<p><img decoding="async" loading="lazy" alt="linphone-macos-connected.png" src="/assets/images/aGNgDcXKZ-61bddfa5dcbcd76e4ed4207388f6f3ba.png" width="1044" height="322" class="img_ev3q"></p>
<p>If Linphone isn&#x27;t connecting for some reason, a quick look in the tunneler logs might be helpful.</p>
<p>On macOS the logs are available from the Ziti menu bar icon:</p>
<p><img decoding="async" loading="lazy" alt="ziti-macos-logs.png" src="/assets/images/ID_-s3cND-db88dc4644cc9d268e6c90c0e1776ab7.png" width="834" height="452" class="img_ev3q"></p>
<p>You&#x27;ll probably want to start with the &quot;Packet Tunnel&quot; logs.</p>
<p>On Windows you&#x27;ll want to look at the &quot;Service&quot; logs under &quot;Main Menu&quot; -&gt; &quot;Advanced Settings&quot;</p>
<p><img decoding="async" loading="lazy" alt="ziti-windows-menu.png" src="/assets/images/kw4XEmo1A-56902fd4f1687d4eb1d7a6ca38aaa978.png" width="806" height="488" class="img_ev3q"></p>
<p>On Linux the tunneler logs are visible from the console that was used to launch <code>ziti-edge-tunnel</code>, or in <code>journalctl</code> if the tunneler was started as a systemd service.</p>
<p>If the tunneler&#x27;s log level is DEBUG or higher you&#x27;ll see something like this in the client tunneler logs when SIP connections are working:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\[2022-08-03T19:09:16.081Z\] DEBUG tunnel-sdk:tunnel\_udp.c:251 recv\_udp() intercepted address\[udp:192.168.8.1:5060\] client\[udp:100.64.0.1:51446\] service\[asterisk-voip\] \[2022-08-03T19:09:16.081Z\] DEBUG tunnel-cbs:ziti\_tunnel\_cbs.c:364 ziti\_sdk\_c\_dial() service\[asterisk-voip\] app\_data\_json\[141\]=&#x27;{&quot;connType&quot;:null,&quot;dst\_protocol&quot;:&quot;udp&quot;,&quot;dst\_ip&quot;:&quot;192.168.8.1&quot;,&quot;dst\_port&quot;:&quot;5060&quot;,&quot;src\_protocol&quot;:&quot;udp&quot;,&quot;src\_ip&quot;:&quot;100.64.0.1&quot;,&quot;src\_port&quot;:&quot;51446&quot;}&#x27;</span><br></span></code></pre></div></div>
<p>The hosting tunneler logs will look like this:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">\[ 2.434\] DEBUG tunnel-cbs:ziti\_hosting.c:559 on\_hosted\_client\_connect() hosted\_service\[asterisk-voip\], client\[ext6001\]: received app\_data\_json=&#x27;{&quot;connType&quot;:null,&quot;dst\_protocol&quot;:&quot;udp&quot;,&quot;dst\_ip&quot;:&quot;192.168.8.1&quot;,&quot;dst\_port&quot;:&quot;5060&quot;,&quot;src\_protocol&quot;:&quot;udp&quot;,&quot;src\_ip&quot;:&quot;100.64.0.1&quot;,&quot;src\_port&quot;:&quot;51446&quot;}&#x27; \[ 2.434\] INFO tunnel-cbs:ziti\_hosting.c:610 on\_hosted\_client\_connect() hosted\_service\[asterisk-voip\], client\[ext6001\] dst\_addr\[udp:192.168.8.1:5060\]: incoming connection \[ 2.434\] DEBUG ziti-sdk:channel.c:211 ziti\_channel\_add\_receiver() ch\[0\] added receiver\[2\] \[ 2.463\] DEBUG tunnel-cbs:ziti\_hosting.c:338 on\_hosted\_client\_connect\_complete() hosted\_service\[asterisk-voip\] client\[ext6001\] server\[udp:127.0.0.1:5060\] connected</span><br></span></code></pre></div></div>
<p>Feel free to reach out on the OpenZiti discourse at <a href="https://openziti.discourse.group" target="_blank" rel="noopener noreferrer">https://openziti.discourse.group</a> if Linphone is not connecting and the tunneler logs aren&#x27;t helping you.</p>
<h1>Asterisk Configuration Files</h1>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="pjsipconf">pjsip.conf<a href="#pjsipconf" class="hash-link" aria-label="Direct link to pjsip.conf" title="Direct link to pjsip.conf">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">;===============TRANSPORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[transport-udp]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type=transport</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">protocol=udp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">bind=127.0.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; provide ziti intercepted IP to clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external_media_address=192.168.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">external_signaling_address=192.168.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;===============ENDPOINT TEMPLATES</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[endpoint-basic](!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type=endpoint</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">context=default</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">disallow=all</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">allow=ulaw</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; asterisk puts this in the &quot;host&quot; section of outgoing From: headers.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; without this, the source IP of the message will be used (e.g. the host&#x27;s lan ip).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">from_domain=192.168.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; don&#x27;t attempt to connect phones directly with each other.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">direct_media=no</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; return rtp packets to the hosting tunneler&#x27;s punched hole instead of the SDP c= address.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rtp_symmetric=yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[auth-userpass](!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type=auth</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth_type=userpass</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[aor-single-reg](!)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">type=aor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">max_contacts=1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">remove_existing=yes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; prevent client tunnelers from closing SIP connections due to 30s idle timeout.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">qualify_frequency=25</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;===============EXTENSION 6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6001](endpoint-basic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth=auth6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aors=6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[auth6001](auth-userpass)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=6001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6001](aor-single-reg)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;===============EXTENSION 6002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6002](endpoint-basic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth=auth6002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aors=6002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[auth6002](auth-userpass)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=6002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=6002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6002](aor-single-reg)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;===============EXTENSION 6003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6003](endpoint-basic)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">auth=auth6003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">aors=6003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[auth6003](auth-userpass)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">password=6003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">username=6003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[6003](aor-single-reg)</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="rtpconf">rtp.conf<a href="#rtpconf" class="hash-link" aria-label="Direct link to rtp.conf" title="Direct link to rtp.conf">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; RTP Configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[general]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; RTP start and RTP end configure start and end addresses</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">; Defaults are rtpstart=5000 and rtpend=31000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rtpstart=10000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">rtpend=20000</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="extensionsconf">extensions.conf<a href="#extensionsconf" class="hash-link" aria-label="Direct link to extensions.conf" title="Direct link to extensions.conf">​</a></h2>
<div class="language-plaintext codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-plaintext codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[from-internal]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exten = 100,1,Answer()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">same = n,Wait(1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">same = n,Playback(hello-world)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">same = n,Hangup()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[default]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exten=&gt;6001,1,Dial(PJSIP/6001,20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exten=&gt;6002,1,Dial(PJSIP/6002,20)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">exten=&gt;6003,1,Dial(PJSIP/6003,20)</span><br></span></code></pre></div></div></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Security-related posts" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/security">Security</a></li><li class="tag_QGVx"><a rel="tag" title="Networking related posts" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/networking">Networking</a></li><li class="tag_QGVx"><a rel="tag" title="VoIP and communications" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/voip">VoIP</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/openziti/blog/securing-web-apis-with-openziti"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Securing Web APIs With OpenZiti — Zero Trust For Web APIs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/openziti/blog/bootstrapping-trust-part-5-bootstrapping-trust"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Bootstrapping Trust Part 5</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#my-voip-is-working-perfectly-right-now-whats-the-problem" class="table-of-contents__link toc-highlight">My VoIP is working perfectly right now… what’s the problem?</a></li><li><a href="#invisible-voip" class="table-of-contents__link toc-highlight">Invisible VoIP</a></li><li><a href="#identities" class="table-of-contents__link toc-highlight">Identities</a></li><li><a href="#service-configuration" class="table-of-contents__link toc-highlight">Service Configuration</a></li><li><a href="#policies" class="table-of-contents__link toc-highlight">Policies</a></li><li><a href="#tunneler-installation" class="table-of-contents__link toc-highlight">Tunneler Installation</a></li><li><a href="#darkness" class="table-of-contents__link toc-highlight">Darkness</a></li><li><a href="#address-translation" class="table-of-contents__link toc-highlight">Address Translation</a><ul><li><a href="#sip" class="table-of-contents__link toc-highlight">SIP</a></li><li><a href="#rtp" class="table-of-contents__link toc-highlight">RTP</a></li><li><a href="#sipsdp-conversation" class="table-of-contents__link toc-highlight">SIP/SDP Conversation</a></li></ul></li><li><a href="#pjsipconf" class="table-of-contents__link toc-highlight">pjsip.conf</a></li><li><a href="#rtpconf" class="table-of-contents__link toc-highlight">rtp.conf</a></li><li><a href="#extensionsconf" class="table-of-contents__link toc-highlight">extensions.conf</a></li></ul></div></div></div></div><footer class="styles-module_ozFooter__vHkQA"><section class="styles-module_footer__Qk0iB styles-module_ozHorizontalSectionRoot__QwWz0 styles-module_ozhsContent__haNeV"><div class="styles-module_footerContainer__azQkg"><div class="styles-module_footerGrid__fsf9C"><div class="styles-module_footerColumn__tK2bv"><h3>NetFoundry</h3><p>An open source project enabling developers to embed zero trust networking directly into applications.</p><div class="styles-module_footerSocialLinks__b1FcV"><a href="https://github.com/openziti/ziti" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a><a href="https://www.linkedin.com/in/netfoundry/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 16V10.1C15.996 7.5 15.375 5.49999 12.025 5.49999C10.4 5.49999 9.325 6.39999 8.875 7.29999H8.825V5.79999H5.65V16H8.95V10.7C8.95 9.30001 9.2 7.9 10.925 7.9C12.65 7.9 12.675 9.59999 12.675 10.8V16H15.996Z"></path><path d="M0.25 5.79999H3.575V16H0.25V5.79999Z"></path><path d="M1.9 0C0.85 0 0 0.85 0 1.9C0 2.95 0.85 3.8 1.9 3.8C2.95 3.8 3.8 2.95 3.8 1.9C3.8 0.85 2.95 0 1.9 0Z"></path></svg></a><a href="https://youtube.com/openziti/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.969 4.69c-.183-1.358-1.062-2.275-2.361-2.46C12.371 2 8 2 8 2S3.629 2 2.362 2.229c-1.3.186-2.179 1.103-2.361 2.461C0 6.03 0 10 0 10s0 3.97.2 5.31c.183 1.358 1.062 2.275 2.361 2.46C3.63 18 8 18 8 18s4.371 0 5.638-.23c1.3-.185 2.178-1.102 2.361-2.46.2-1.34.2-5.31.2-5.31s0-3.97-.23-5.31zm-8.36, 8.57V6.73l3.76 2.27-3.76 2.26z"></path></svg></a><a href="https://twitter.com/openziti/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 3.038c-.59.262-1.219.44-1.885.52.677-.406 1.194-1.05 1.438-1.815-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.038-2.396-1.038-1.813 0-3.283 1.469-3.283 3.282 0 .257.03.507.085.748-2.728-.137-5.147-1.445-6.766-3.43-.282.485-.444 1.05-.444 1.651 0 1.14.58 2.143 1.46 2.732-.538-.017-1.044-.164-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.219-.276.075-.567.116-.866.116-.211 0-.416-.021-.617-.06.418 1.304 1.63 2.254 3.066 2.28-1.124.883-2.539 1.406-4.077 1.406-.265 0-.526-.015-.785-.046 1.453.933 3.178 1.475 5.032 1.475 6.038 0 9.34-5.002 9.34-9.34 0-.142-.004-.284-.01-.425.641-.463 1.198-1.039 1.638-1.696"></path></svg></a></div></div><div class="styles-module_footerColumn__tK2bv"><h3>Community</h3><ul class="styles-module_footerLinks__eOmJ9"><li><a href="https://github.com/openziti/ziti">GitHub</a></li><li><a href="https://openziti.discourse.group/">Discourse Forum</a></li><li><a href="/docs/openziti/policies/CONTRIBUTING">Contributing</a></li></ul></div><div class="styles-module_footerColumn__tK2bv"><h3>Resources</h3><ul class="styles-module_footerLinks__eOmJ9"><li><a href="https://blog.openziti.io">OpenZiti Tech Blog</a></li><li><a href="https://netfoundry.io/">NetFoundry</a></li></ul></div></div></div><div class="styles-module_footerCopyright__nWyvc"><p>© 2025 NetFoundry Inc. OpenZiti is an open source project sponsored by NetFoundry. All rights reserved.</p></div></section></footer></div></div>
</body>
</html>