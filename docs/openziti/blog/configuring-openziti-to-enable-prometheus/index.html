<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true"></title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" property="og:url" content="http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="robots" content="index, follow"><meta data-rh="true" property="og:title" content="Configuring OpenZiti to Enable Prometheus | OpenZiti"><meta data-rh="true" name="description" content="This is part two of a three-part article. This article provides the technical deep dive into the steps necessary to implement the vision outlined in part one. This article will be heavy on OpenZiti CLI commands, explaining what we are doing to configure the overlay network, and why. In the final article, we will explore what we have just created and understand what was just created"><meta data-rh="true" property="og:description" content="This is part two of a three-part article. This article provides the technical deep dive into the steps necessary to implement the vision outlined in part one. This article will be heavy on OpenZiti CLI commands, explaining what we are doing to configure the overlay network, and why. In the final article, we will explore what we have just created and understand what was just created"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-04-23T04:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/dovholuknf"><meta data-rh="true" property="article:tag" content="Kubernetes,Prometheus,Zero Trust"><meta data-rh="true" data-rh="true" name="nf-layout-version" content="0.0.168"><meta data-rh="true" name="twitter:card" content="summary_large_image"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus"><link data-rh="true" rel="alternate" href="http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus" hreflang="en"><link data-rh="true" rel="alternate" href="http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","@id":"http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus","mainEntityOfPage":"http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus","url":"http://localhost:3000/docs/openziti/blog/configuring-openziti-to-enable-prometheus","headline":"Configuring OpenZiti to Enable Prometheus","name":"Configuring OpenZiti to Enable Prometheus","description":"This is part two of a three-part article. This article provides the technical deep dive into the steps necessary to implement the vision outlined in part one. This article will be heavy on OpenZiti CLI commands, explaining what we are doing to configure the overlay network, and why. In the final article, we will explore what we have just created and understand what was just created","datePublished":"2022-04-23T04:00:00.000Z","author":{"@type":"Person","name":"Clint Dovholuk","description":"Author","url":"https://github.com/dovholuknf","image":"https://avatars.githubusercontent.com/dovholuknf"},"keywords":[],"isPartOf":{"@type":"Blog","@id":"http://localhost:3000/docs/openziti/blog","name":"Blog"}}</script><script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:3576473,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script>
<link rel="alternate" type="application/rss+xml" href="/docs/openziti/blog/rss.xml" title="OpenZiti RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/openziti/blog/atom.xml" title="OpenZiti Atom Feed">

<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-5SF399H3",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.273075c6.css">
<script src="/assets/js/runtime~main.6236f723.js" defer="defer"></script>
<script src="/assets/js/main.d05d9df4.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF399H3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>



<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/ziti-logo-dark.svg"><link rel="preload" as="image" href="/img/ziti-logo-light.svg"><link rel="preload" as="image" href="https://avatars.githubusercontent.com/dovholuknf"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ziti-logo-light.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://netfoundry.io/products/netfoundry-cloud-30-day-free-trial/" target="_blank">NetFoundry</a></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/openziti/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/openziti/downloads">Downloads</a><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://blog.openziti.io/" target="_blank">Blog</a></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li class=""><div class="text-divider"><p>Socials</p></div></li><li class=""><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/yt.svg" alt="YouTube logo">YouTube</span></a></li><li class=""><a href="https://x.com/OpenZiti" target="_blank" title="OpenZiti on X(formerly Twitter)"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/twit.svg" alt="X/Twitter logo">X (Twitter)</span></a></li><li class=""><a href="https://www.reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/reddit-logo.png" alt="Reddit logo">Reddit</span></a></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/ziggy.png" alt="X/Twitter Ziggy logo"><a href="https://x.com/OpenZiggy" target="_blank" title="OpenZiggy on X(formerly Twitter)">Ziggy</a></span></li><li class=""><div class="text-divider"><p>Other</p></div></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/blog-icon.png" alt="OpenZiti blog logo"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/docs/openziti/img/oz-test-kitchen.png" alt="OpenZiti Test Kitchen logo"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="styles-module_starUsRoot__hMNZp"><span style="color:whitesmoke">Star Us on GitHub<!-- --> </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><div class="main-wrapper NetFoundryLayout-module_ozLayoutMainWrapper__a2vwh"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_re4s thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_pO2u margin-bottom--md">All posts</div><div role="group"><h3 class="yearGroupHeading_rMGB">2025</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-zrok-10">Introducing zrok 1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-unleashed-top-10-uses-explored">zrok Unleashed: Top 10 Uses Explored</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-ziti-identities-with-hsmtpm">Securing Ziti Identities with HSM/TPM</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-custom-domains">zrok Custom Domains</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2024</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-oop">Golang Aha! Moments: OOP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-safest-way-to-make-portainer-internet-accessible">The safest way to make Portainer Internet accessible</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/multifactor-zero-trust-ssh">Multifactor Zero Trust ssh</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-sshclient">Zero Trust *ssh.Client</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/effortless-docker-management-with-private-web-access">Effortless Docker Management</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-is-growing-up">zrok is Growing Up</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-vpn-linux-service">Easy Steps to Install a Private VPN on Linux with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/jitsi-meet-zrok">Jitsi, meet zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/extend-access-to-a-private-s3-bucket-using-python">Extend Access to a Private S3 Bucket Using Python</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/why-we-verify-github-commits">Why We Verify GitHub Commits</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/limitless-zrok-with-docker">Limitless zrok with Docker</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/how-to-prevent-path-traversal-attacks-with-openziti-browzer">How to Prevent Path Traversal Attacks with OpenZiti BrowZer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-vpn">zrok VPN</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/deploy-openziti-in-kubernetes-with-ease-using-k3d">Deploy OpenZiti in Kubernetes with Ease Using k3d</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/signing-executables-from-github-actions">Signing Executables From GitHub Actions</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-nodejs-zrok-sdk">The NodeJS zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/no-listening-ports">No Listening Ports?</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/announcing-openziti-v1">Announcing OpenZiti v1.0</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/pixy-dust-for-web-applications-pkce">Pixy Dust For Web Applications</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/secure-remote-development-with-zrok-and-jetbrains">Secure Remote Development with zrok and JetBrains</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-permission-modes">zrok Permission Modes</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-socks-backend">The zrok SOCKS Backend</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-python-zrok-sdk">The Python zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-dedicated-palworld-server-with-zrok">Securing a Dedicated  Palworld Server For My Family with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/fun-with-adaptive-rate-limiting">Fun with Adaptive Rate Limiting</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-drives-cli-preview">The zrok Drives CLI Preview</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/minecraft-over-zrok">Minecraft Over zrok</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2023</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/go-is-amazing-for-zero-trust">Go is Amazing for Zero Trust</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-frontdoor">zrok frontdoor</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/business-rule-driven-just-in-time-network-access">Business Rule Driven Just-in-Time Network Access</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-drives-an-early-preview">zrok Drives (an Early Preview)</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/put-some-ziti-in-your-caddy">Put some Ziti in your Caddy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-oauth-public-frontend">The zrok OAuth Public Frontend</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-azure-openai-applications-with-openziti">Securing Azure OpenAI Applications with OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-zero-trust-iot-wi-fi-gateway">OpenZiti Zero Trust IoT Wi-Fi Gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-with-the-power-of-caddy">zrok with the Power of Caddy</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-zrok-sdk">The zrok SDK</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/got-5-minutes-secure-your-python-website-with-zero-trust">Got 5 Minutes? Secure Your Python Website with Zero Trust.</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/announcing-the-zrok-public-beta">Announcing the zrok Public Beta!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zrok-v040-released">zrok v0.4.0 Released!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/commercial-open-source-and-ethical-and-practical-community-engagement">Commercial Open Source and Ethical (and practical) Community Engagement</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/my-pi-day-journey-with-go-64-bit-alignment">My Pi Day Journey with Go 64-bit alignment</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/private-dns-on-windows">Private DNS on Windows</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/websockets-over-zrok">Websockets over zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openapi-python-clients">OpenAPI Python Clients</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/postman-mgmt">Postman and the Management API</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/the-road-ahead-for-zrok">The Road Ahead for zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/auto-complete">Ziti Shell Auto-Complete</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-zrok">Introducing zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/connecting-to-local-development-environment-from-cloud-hosts-with-zrok">Connecting to Local Development Environment from Cloud Hosts with zrok</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/lessons-learned-writing-a-zero-trust-nginx-module">Lessons Learned Writing a Zero Trust NGINX Module</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-monitoring-with-openziti">Zero Trust Monitoring with OpenZiti</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2022</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/its-a-zitiful-life">It&#x27;s A Zitiful Life</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/nginx-zerotrust-api-security">NGINX &amp; ZeroTrust API Security</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/using-ebpf-tc-to-securely-mangle-packets-in-the-kernel-and-pass-them-to-my-secure-networking-application">Using eBPF-TC to securely mangle packets in the kernel, and pass them to my secure networking application</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/browzer-gateway-fqdn-certs">OpenZiti BrowZer Gateway</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-authentication-api-integrations">OpenZiti Authentication API Integrations</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/high-level-publicprivate-cryptography">High-Level Public/Private Cryptography</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/set-up-a-secure-multiplayer-minecraft-server">Set Up a Secure Multiplayer Minecraft Server</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/setting-up-oracle-cloud-to-host-openziti">Setting Up Oracle Cloud To Host OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/integrating-ziti-is-easy">Integrating Ziti is Easy! How we got our app tested with go-httpbin</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-generics">Golang Aha! Moments: Generics</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-nodejs-applications">Securing NodeJS Applications — An Introduction to the OpenZiti SDK for NodeJS</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-is-participating-in-hacktoberfest-prost">OpenZiti is Participating in Hacktoberfest, Prost!</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/openziti-python-sdk-introduction">OpenZiti Python SDK: Introduction</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/free-secure-access-to-nas-from-anywhere">Free Secure Access to NAS From Anywhere</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/introducing-openziti-browzer">Introducing OpenZiti BrowZer</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/golang-aha-moments-channels">Golang Aha! Moments: Channels</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zero-trust-overlay-network-to-access-homeassistant">I Created a Zero Trust Overlay Network to Access HomeAssistant</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/my-intern-assignment-call-a-dark-webhook-from-aws-lambda">My Intern Assignment - Call a Dark Webhook from AWS Lambda</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/extrovert-wednesday">Extrovert Wednesday</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/securing-web-apis-with-openziti">Securing Web APIs With OpenZiti — Zero Trust For Web APIs</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/tunneling-voip-over-openziti">Tunneling VoIP over OpenZiti</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-5-bootstrapping-trust">Bootstrapping Trust Part 5</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-4-certificate-authorities-chains-of-trust">Bootstrapping Trust Part 4</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-3-certificates">Bootstrapping Trust Part 3 - Certificates</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-2-a-primer-on-public-key-cryptography">Bootstrapping Trust Part 2 - PKI</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/bootstrapping-trust-part-1-encryption-everywhere">Bootstrapping Trust Part 1 - Encryption Everywhere</a></li><li class="sidebarItem__DBe"><a aria-current="page" class="sidebarItemLink_mo7H sidebarItemLinkActive_I1ZP" href="/docs/openziti/blog/configuring-openziti-to-enable-prometheus">Configuring OpenZiti to Enable Prometheus</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere">Prometheus - Scrape Anything from Anywhere</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/scraping-anything-anywhere-in-action">Scraping Anything, Anywhere in Action</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2021</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/kubernetes">Tunneling Ingress to Kubernetes Workloads</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitifying-scp">Zitifying SCP</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitifying-ssh">Zitifying SSH</a></li><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/zitification">Zitification</a></li></ul></div><div role="group"><h3 class="yearGroupHeading_rMGB">2020</h3><ul class="sidebarItemList_Yudw clean-list"><li class="sidebarItem__DBe"><a class="sidebarItemLink_mo7H" href="/docs/openziti/blog/mobile-point-of-sale-mpos-app-ziti-android-java-sdk-integration">Mobile Point of Sale (mPOS) app – embed zero trust networking</a></li></ul></div></nav></aside><main class="col col--7"><article class=""><header><h1 class="title_f1Hy">Configuring OpenZiti to Enable Prometheus</h1><div class="container_mt6G margin-vert--md"><time datetime="2022-04-23T04:00:00.000Z">April 23, 2022</time> · <!-- -->21 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--12 authorCol_Hf19"><div class="avatar margin-bottom--sm"><a href="https://github.com/dovholuknf" target="_blank" rel="noopener noreferrer" class="avatar__photo-link"><img class="avatar__photo authorImage_XqGP" src="https://avatars.githubusercontent.com/dovholuknf" alt="Clint Dovholuk"></a><div class="avatar__intro authorDetails_lV9A"><div class="avatar__name"><a href="https://github.com/dovholuknf" target="_blank" rel="noopener noreferrer"><span class="authorName_yefp">Clint Dovholuk</span></a></div><small class="authorTitle_nd0D" title="Author">Author</small><div class="authorSocials_rSDt"></div></div></div></div></div></header><div id="__blog-post-container" class="markdown"><p><em>This is part two of a three-part article. This article provides the technical deep dive into the steps necessary to implement the vision outlined in</em> <a href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere"><em>part one.</em></a> <em>This article will be heavy on OpenZiti CLI commands, explaining what we are doing to configure the overlay network, and why. In</em> <a href="/docs/openziti/blog/scraping-anything-anywhere-in-action"><em>the final article</em></a><em>, we will explore what we have just created and understand what was just created</em></p>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="goals">Goals<a href="#goals" class="hash-link" aria-label="Direct link to Goals" title="Direct link to Goals">​</a></h2>
<ul>
<li>
<p>Incredibly easy to deploy Prometheus servers</p>
</li>
<li>
<p>No ports exposed to the internet</p>
</li>
<li>
<p>Prometheus servers can be deployed listening on the overlay, not on the underlay</p>
</li>
<li>
<p>Private Kubernetes API</p>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="zitified-prometheus">Zitified Prometheus<a href="#zitified-prometheus" class="hash-link" aria-label="Direct link to Zitified Prometheus" title="Direct link to Zitified Prometheus">​</a></h2>
<p>As described in <a href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere">the previous article</a>, Prometheus really prefers to be able to gather metrics from the targets it is monitoring. When the target is behind a firewall, you will be left with two choices.</p>
<p><img decoding="async" loading="lazy" src="/assets/images/74523233-0c1a-4a09-bb26-9eb1d5cd92c4-824b30a15bb7ceb574522a7d8a02a3aa.png" width="2000" height="695" class="img_ev3q"></p>
<p>You can choose to open a hole in the firewall granting access (a generally bad idea), or you can use a PushGateway. Even if you choose to use the PushGateway, Prometheus will still need to be able to access and pull from the PushGateway so you&#x27;ll still need some port open and listening for Prometheus to collect data.</p>
<p>What we really want is to enable Prometheus to scrape data from targets without needing to expose any ports to the internet. It would be ** even better** if we didn&#x27;t have to expose any ports at all, even to the local &quot;trusted&quot; network. This capability is something that is unique to an OpenZiti-enabled application. You can take an OpenZiti SDK and embed it into your application, and give your app zero trust superpowers! If we take an OpenZiti SDK and embed it into Prometheus, we can give Prometheus the superpower of invisibility and addressability. Embedding an OpenZiti SDK produces a zitified version of Prometheus. With an OpenZiti-powered Prometheus, no ports need to be open.</p>
<p>The OpenZiti project has done the work to produce an OpenZiti-enabled version of Prometheus. It&#x27;s also entirely open source. Check it out from the OpenZiti Test Kitchen hosted on GitHub <a href="https://github.com/openziti-test-kitchen/prometheus" target="_blank" rel="noopener noreferrer">https://github.com/openziti-test-kitchen/prometheus</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="solution-overview">Solution Overview<a href="#solution-overview" class="hash-link" aria-label="Direct link to Solution Overview" title="Direct link to Solution Overview">​</a></h2>
<p>As you&#x27;ll recall from <a href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere">part1</a>, we are trying to use Prometheus to monitor workloads in two different Kubernetes clusters. We are going to deploy one cluster which will represent a first step of an OpenZiti solution. It will use a Prometheus server that is OpenZiti-enabled, but it will still listen on the underlay network and be available to local devices on an ip<!-- -->:port<!-- -->. This Prometheus server will use OpenZiti to scrape targets which are available anywhere on the OpenZiti overlay network and we&#x27;ll refer to this as &quot;ClusterA&quot;.</p>
<p>We&#x27;ll also deploy a second OpenZiti-enabled Prometheus server, in a totally separate Kubernetes cluster. This Prometheus server will <strong>not</strong> listen on an ip<!-- -->:port<!-- -->. Instead, it will listen exclusively on the OpenZiti overlay. This Prometheus server will have no ports available to attack and will only be accessible via a properly authorized and authenticated OpenZiti client. This will be our &quot;ClusterB&quot;</p>
<p>Finally, we&#x27;ll stand up a third Prometheus server and use it to federate metrics back to a &quot;central&quot; Prometheus server. This emulates what one might do to provide a central location for humans to go to in order to visualize data or use the Prometheus server. We won&#x27;t care where this is deployed, we&#x27;ll actually deploy it in locally and then move it to a private server in AWS just to show how easy it that is.</p>
<p>This is what the solution we&#x27;ll build looks like:</p>
<p><img decoding="async" loading="lazy" src="https://github.com/dovholuknf/ziti-doc/raw/main/docusaurus/blog/zitification/prometheus/kubernetes-prometheus-after.svg" alt="after" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="digging-in">Digging In<a href="#digging-in" class="hash-link" aria-label="Direct link to Digging In" title="Direct link to Digging In">​</a></h2>
<p>Let&#x27;s get to work and build this solution. We&#x27;ll need some legwork done first.</p>
<blockquote>
<p>It&#x27;s going to get deep in this article with CLI commands. You&#x27;ll see what the OpenZiti objects are that get created and learn why. You might not want to replicate the solution on your own and instead are looking for &quot;the big reveal&quot;. If that describes you, just skim this article lightly and get on to <a href="/docs/openziti/blog/scraping-anything-anywhere-in-action">part3</a>. In part 3 we&#x27;ll explore the deployed solution and see what makes it so interesting and cool.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h3>
<ul>
<li>
<p><img decoding="async" loading="lazy" src="/assets/images/8b08379c-00c2-4e12-a2fb-cb9f0a3bc975-baff2bfe13996a1de5c6e528f9074492.png" width="2000" height="702" class="img_ev3q"></p>
<p>You have an OpenZiti overlay network available. If not, for this scenario you will want to use <a href="/docs/openziti/learn/quickstarts/network/hosted">&quot;host your own&quot;</a>. You&#x27;ll also want to have the ziti cli tool on your path</p>
</li>
<li>
<p>Two Kubernetes clusters provisioned</p>
</li>
<li>
<p>Necessary tooling installed and available on the path</p>
<ul>
<li>
<p>kubectl</p>
</li>
<li>
<p>helm</p>
</li>
</ul>
</li>
<li>
<p>bash/zsh shell - tested in bash and some commands will use variables. If you use another shell, change accordingly</p>
</li>
<li>
<p>a machine with <a href="https://docs.docker.com/get-docker/" target="_blank" rel="noopener noreferrer">docker installed</a> to run the final Prometheus sever on (your local machine is fine)</p>
</li>
<li>
<p>Ziti Desktop Edge installed on the development machine. I use <a href="https://openziti.io/docs/reference/tunnelers/windows" target="_blank" rel="noopener noreferrer">Ziti Desktop Edge for Windows</a>.</p>
</li>
<li>
<p>A temporary folder exists to house files as we need them: /tmp/prometheus</p>
</li>
</ul>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="clustera---using-ziti-host">ClusterA - Using <code>ziti-host</code><a href="#clustera---using-ziti-host" class="hash-link" aria-label="Direct link to clustera---using-ziti-host" title="Direct link to clustera---using-ziti-host">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/dovholuknf/ziti-doc/raw/main/docusaurus/blog/zitification/prometheus/clusterA.svg" alt="clusterA" class="img_ev3q"></p>
<p>We start with an empty OpenZiti network, and two empty Kubernetes clusters. Let&#x27;s start by populating ClusterA. We will deploy three pods into this Kubernetes cluster. When done, the Kubernetes cluster will look similar to the image to the right.</p>
<ul>
<li>
<p>Pod 1. <strong>ziti-host</strong>. This pod will provide what is effectively the equivalent of a Kubernetes ingress controller. We&#x27;ll install this using helm from a NetFoundry provided chart</p>
</li>
<li>
<p>Pod 2. <strong>prometheuz</strong>. This pod will be our Prometheus server with OpenZiti embedded in it. We won&#x27;t use OpenZiti to listen on the overlay network. Instead, we will follow a more traditional model of listening on the underlay at a known ip<!-- -->:port<!-- --> combination. We&#x27;ll install this pod using a chart from the OpenZiti charts repository.</p>
</li>
<li>
<p>Pod 3. <strong>reflectz</strong>. This pod represents the workload which we want to monitor. This is another chart provided by the OpenZiti chart repository and will also be installed with helm. If you are interested in viewing the source code for this project you can find it on <a href="https://github.com/nf-npieros/sdk-golang/tree/feature/reflect-prometheus" target="_blank" rel="noopener noreferrer">GitHub here</a></p>
</li>
</ul>
<blockquote>
<p>Running the ziti cli commands shown below as shown will expect you to have the ziti binary on your path. Also it is expected that all the commands run will run from the same &quot;development&quot; machine with the expected tools available. Reach out on discourse if you get stuck.</p>
</blockquote>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-1---ziti-host">Pod 1 - <code>ziti-host</code><a href="#pod-1---ziti-host" class="hash-link" aria-label="Direct link to pod-1---ziti-host" title="Direct link to pod-1---ziti-host">​</a></h3>
<p>We will start off deploying Pod 1, ziti-host, to provide access to Kubernetes ClusterA. The ziti-host pod will require a single identity to be provisioned. We will use a shortened name for the cluster and we&#x27;ll embed that name into the identity to make it easier for us to understand what identity we provisioned and why, should we ever need to reference these identities later. We&#x27;ll refer to ClusterA as simply &quot;kubeA&quot;. Let&#x27;s make the identity now. Notice we are also passing the &quot;-a&quot; attribute during creation to add a role attribute to the identity of <code>kubeA.services</code>. This will be used later when setting up policies.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-identity">Create the Identity<a href="#create-the-identity" class="hash-link" aria-label="Direct link to Create the Identity" title="Direct link to Create the Identity">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity device kubeA.ziti.id -o /tmp/prometheus/kubeA.ziti.id.jwt -a &quot;kubeA.services&quot;</span><br></span></code></pre></div></div>
<p>You should see confirmation output such as:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">New identity kubeA.ziti.id created with id: BeyyFUZFDR</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enrollment expires at 2022-04-22T01:18:53.402Z</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-ziti-host-into-clustera">Deploy <code>ziti-host</code> into ClusterA<a href="#deploy-ziti-host-into-clustera" class="hash-link" aria-label="Direct link to deploy-ziti-host-into-clustera" title="Direct link to deploy-ziti-host-into-clustera">​</a></h4>
<p>Once created, we can use helm to install the <code>ziti-host</code> pod. The jwt is a one-use token and will be useless after being consumed by <code>ziti-host</code>. As this is probably your first time running this helm chart, you will need to install it. The command is idempotent to running it over and over is of no concern. Run the following:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add netfoundry https://netfoundry.github.io/charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install ziti-host netfoundry/ziti-host --set-file enrollmentToken=&quot;/tmp/prometheus/kubeA.ziti.id.jwt&quot;</span><br></span></code></pre></div></div>
<p>You will see the confirmation output from helm. Now when you look at your Kubernetes cluster with <code>kubectl</code>, you will see a pod deployed:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                        READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti-host-db55b5c4b-rpc7f   1/1     Running   0          2m40s</span><br></span></code></pre></div></div>
<p>Awesome, we have our first deployed pod. It&#x27;s useless at the moment as we have defined no services, nor authorized any services. Right now there&#x27;s nothing to connect to, so we can simply move on and install the next pod, <code>reflectz</code>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-2---reflectz">Pod 2 - <code>reflectz</code><a href="#pod-2---reflectz" class="hash-link" aria-label="Direct link to pod-2---reflectz" title="Direct link to pod-2---reflectz">​</a></h3>
<p>The first pod we want to have access to is the <code>reflectz</code> pod. It is a workload we will deploy that will do two things. First, it will listen on the OpenZiti overlay network for connections. When a connection is made, and when bytes are sent, the workload sill simply return back to the caller whatever was sent to it adding &quot;you sent me: &quot; to the payload. It&#x27;s not much, but it&#x27;s a demo after all. The second service provided is a scrape target for Prometheus. There is one metric exposed by <code>reflectz</code> we will care about, the total number of connections established to this workload. This pod also needs an identity provisioned, and this time around we will also provision some services. We will also use the <code>ziti</code> cli to enroll this identity. This helm chart wants you to provide an enrolled identity as part of the helm command. Let&#x27;s do all this now.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-and-enroll-the-identity">Create and Enroll the Identity<a href="#create-and-enroll-the-identity" class="hash-link" aria-label="Direct link to Create and Enroll the Identity" title="Direct link to Create and Enroll the Identity">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user kubeA.reflect.id -o /tmp/prometheus/kubeA.reflect.id.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge enroll /tmp/prometheus/kubeA.reflect.id.jwt -o /tmp/prometheus/kubeA.reflect.id.json</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-configs-and-services-including-tunneling-based-access">Create Configs and Services (including Tunneling-based Access)<a href="#create-configs-and-services-including-tunneling-based-access" class="hash-link" aria-label="Direct link to Create Configs and Services (including Tunneling-based Access)" title="Direct link to Create Configs and Services (including Tunneling-based Access)">​</a></h4>
<p>The <code>reflectz</code> chart also needs two services to be declared and specified at the time of the helm chart installation. We will want to be able to test the service to ensure they work. To enable testing the services, we will create two configs of type <code>intercept.v1</code>. This will allow identities using tunneling apps to be able to access the services, this is how we&#x27;ll verify the services work. Make the configs and services now.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create intercept configs for the two services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config kubeA.reflect.svc-intercept.v1 intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeA.reflect.svc.ziti&quot;],&quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}]}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config &quot;kubeA.reflect.svc-intercept.v1.scrape&quot; intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeA.reflect.scrape.svc.ziti&quot;], &quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}], &quot;dialOptions&quot;:{&quot;identity&quot;:&quot;kubeA.reflect.id&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># create the two services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeA.reflect.svc&quot; --configs &quot;kubeA.reflect.svc-intercept.v1&quot; -a &quot;kubeA.reflect.svc.services&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeA.reflect.scrape.svc&quot; --configs &quot;kubeA.reflect.svc-intercept.v1.scrape&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorize-the-workload-and-clients">Authorize the Workload and Clients<a href="#authorize-the-workload-and-clients" class="hash-link" aria-label="Direct link to Authorize the Workload and Clients" title="Direct link to Authorize the Workload and Clients">​</a></h4>
<p>Services are not valuable if there are no identities which can use the services. The identity used in the helm installation will also need to be authorized to bind these services. Tunneling apps will need to be authorized to dial these services but also remember Prometheus servers will need to be able to dial these services too. We will now create <code>service-policies</code> to authorize the tunneling clients, Prometheus scrapes, and the <code>reflectz</code> server to bind the service.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create the bind service policies and authorize the reflect id to bind these services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.reflect.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.reflect.svc&quot; --identity-roles &quot;@kubeA.reflect.id&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.reflect.scrape.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.reflect.scrape.svc&quot; --identity-roles &quot;@kubeA.reflect.id&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># create the dial service policies and authorize the reflect id to bind these services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.reflect.svc.dial&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.reflect.svc&quot; --identity-roles &quot;#reflectz-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.reflect.svc.dial.scrape&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.reflect.scrape.svc&quot; --identity-roles &quot;#reflectz-clients&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-reflectz">Deploy <code>reflectz</code><a href="#deploy-reflectz" class="hash-link" aria-label="Direct link to deploy-reflectz" title="Direct link to deploy-reflectz">​</a></h4>
<p>With the identity enrolled, we can now install the helm chart from openziti, and install our demonstration workload: <code>reflectz</code>. Notice that to deploy <code>reflectz</code> we need to supply an identity to the workload using <code>--set-file reflectIdentity</code>. This identity will be used to &#x27;Bind&#x27; the services the workload exposes. We also need to define what the service names are we want to allow that identity to bind. We do this using the <code>--set serviceName</code> and <code>--set prometheusServiceName</code> flags.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add openziti-test-kitchen https://openziti-test-kitchen.github.io/helm-charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install reflectz openziti-test-kitchen/reflect \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file reflectIdentity=&quot;/tmp/prometheus/kubeA.reflect.id.json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set serviceName=&quot;kubeA.reflect.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set prometheusServiceName=&quot;kubeA.reflect.scrape.svc&quot;</span><br></span></code></pre></div></div>
<p>After running helm, pod 2 should be up and running. Let&#x27;s take a look using <code>kubectl</code></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kubectl get pods</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">NAME                        READY   STATUS    RESTARTS   AGE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">reflectz-775bd45d86-4sjwh   1/1     Running   0          7s</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti-host-db55b5c4b-rpc7f   1/1     Running   0          4m</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-3---prometheuz">Pod 3 - <code>Prometheuz</code><a href="#pod-3---prometheuz" class="hash-link" aria-label="Direct link to pod-3---prometheuz" title="Direct link to pod-3---prometheuz">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="overlay-work---setting-up-openziti">Overlay Work - Setting Up OpenZiti<a href="#overlay-work---setting-up-openziti" class="hash-link" aria-label="Direct link to Overlay Work - Setting Up OpenZiti" title="Direct link to Overlay Work - Setting Up OpenZiti">​</a></h4>
<p>Now we have access to the cluster and a workload to monitor. Now we want to deploy Prometheus and monitor this workload. Remember that the workload only exposes a scrape target over the OpenZiti overlay. For Prometheus to be able to scrape the workload, even when resident inside the Kubernetes cluster (!), Prometheus will need to be OpenZiti-enabled. That will require a few things. We&#x27;ll need a new identity for Prometheus, we&#x27;ll need to authorize Prometheus to access the workload&#x27;s target, and we&#x27;ll need to configure Prometheus to scrape that workload. When we create this identity we&#x27;ll assign two attributes. The <code>reflectz-clients</code> attribute gives this identity the ability to dial the two services defined above. The <code>prometheus-clients</code> attribute is currently unused. We&#x27;ll put that to use later, but we can define it now.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-and-enroll-the-identity-1">Create and Enroll the Identity<a href="#create-and-enroll-the-identity-1" class="hash-link" aria-label="Direct link to Create and Enroll the Identity" title="Direct link to Create and Enroll the Identity">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create and enroll the identity.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user kubeA.prometheus.id -o /tmp/prometheus/kubeA.prometheus.id.jwt -a &quot;reflectz-clients&quot;,&quot;prometheus-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge enroll /tmp/prometheus/kubeA.prometheus.id.jwt -o /tmp/prometheus/kubeA.prometheus.id.json</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-configs-and-services-including-tunneling-based-access-1">Create Configs and Services (including Tunneling-based Access)<a href="#create-configs-and-services-including-tunneling-based-access-1" class="hash-link" aria-label="Direct link to Create Configs and Services (including Tunneling-based Access)" title="Direct link to Create Configs and Services (including Tunneling-based Access)">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create the config and service for the kubeA prometheus server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config &quot;kubeA.prometheus.svc-intercept.v1&quot; intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeA.prometheus.svc&quot;],&quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}]}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config &quot;kubeA.prometheus.svc-host.v1&quot; host.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocol&quot;:&quot;tcp&quot;, &quot;address&quot;:&quot;prometheuz-prometheus-server&quot;,&quot;port&quot;:80}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeA.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --configs &quot;kubeA.prometheus.svc-intercept.v1&quot;,&quot;kubeA.prometheus.svc-host.v1&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorize-the-workload-and-clients-1">Authorize the Workload and Clients<a href="#authorize-the-workload-and-clients-1" class="hash-link" aria-label="Direct link to Authorize the Workload and Clients" title="Direct link to Authorize the Workload and Clients">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># grant the prometheus clients the ability to dial the service and the kubeA.prometheus.id the ability to bind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.prometheus.svc.dial&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-roles &quot;#prometheus-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeA.prometheus.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeA.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-roles &quot;@kubeA.ziti.id&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-prometheuz-1">Deploying <code>Prometheuz</code><a href="#deploying-prometheuz-1" class="hash-link" aria-label="Direct link to deploying-prometheuz-1" title="Direct link to deploying-prometheuz-1">​</a></h4>
<p>With our services, configs and service-policies in place we are now ready to start our Prometheus server. Remember this server will not listen on a the OpenZiti overlay. It&#x27;s going to listen exclusively on the underlay. We are still exploring OpenZiti, and we are not yet comfortable deploying our Prometheus server dark. We&#x27;ll change this soon, don&#x27;t worry. For now, we&#x27;ll imagine that we&#x27;re still evaluating the tech and chose to deploy it on the underlay, not on the overlay.</p>
<p>Although Prometheus is listening on the underlay, we <strong>have</strong> deployed our workload listening on the overlay network. It won&#x27;t be available on the underlay at all. The workload has <strong>no listening ports</strong>. This means that we&#x27;ll still need an OpenZiti-enabled Prometheus to access and scrape that workload. To do this we&#x27;ll use helm, and use a chart provided by the OpenZiti charts repo.</p>
<p>Some interesting things to notice below in the <code>helm install</code> command. Notice that we are passing helm two <code>--set</code> parameters. These parameters are informing the helm chart that the Prometheus server is not &quot;zitified&quot;, meaning it will be accessible via the underlay network. We&#x27;re also passing one <code>--set-file</code> parameter to tell Prometheus what identity we want to be stored in the pod (as a secret). This secret will be used when we configure Prometheus to scrape the workload. Go ahead and run this command now and run <code>kubectl get pods</code> until all the containers are running.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add openziti-test-kitchen https://openziti-test-kitchen.github.io/helm-charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install prometheuz openziti-test-kitchen/prometheus \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set server.ziti.enabled=&quot;false&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file server.scrape.id.contents=&quot;/tmp/prometheus/kubeA.prometheus.id.json&quot;</span><br></span></code></pre></div></div>
<hr>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="clusterb---fully-dark">ClusterB - Fully Dark<a href="#clusterb---fully-dark" class="hash-link" aria-label="Direct link to ClusterB - Fully Dark" title="Direct link to ClusterB - Fully Dark">​</a></h2>
<p><img decoding="async" loading="lazy" src="https://github.com/dovholuknf/ziti-doc/raw/main/docusaurus/blog/zitification/prometheus/clusterB.svg" alt="clusterB" class="img_ev3q"></p>
<p>Now that we have deployed our first Kubernetes cluster, it&#x27;s now time to deploy the second Kubernetes cluster. This time, we are going to keep our entire deployment <strong>fully dark</strong>! There will be no listening ports, not even local to the Kubernetes cluster itself. To get any traffic to this Prometheus server, you will need a strong identity and need to be authorized on the OpenZiti overlay. When complete, ClusterB will look like the image to the right.</p>
<p>This time, &quot;Pod1&quot; will be the <code>reflectz</code> workload. Since this is a <strong>fully dark</strong> deployment, listening entirely on the OpenZiti overlay, we won&#x27;t need a <code>ziti-host</code> pod. Remember, in ClusterA <code>ziti-host</code> is used to provide internal access to the Kubernetes cluster via the OpenZiti overlay. It&#x27;s similar in role to an ingress controller, but doesn&#x27;t require you to expose your workloads to the internet. While that&#x27;s pretty good we want to go fully dark this time. We&#x27;ll have no <code>ziti-host</code>. We&#x27;ll only need to deploy two pods: <code>reflectz</code> and <code>prometheuz</code>.</p>
<p>The good news is that the same commands you&#x27;ve run for ClusterA, will mostly be used for ClusterB. You will want to beware that where you used &quot;kubeA&quot; before, make sure you change those to &quot;kubeB&quot;. There will be small other changes we&#x27;ll make along the way too, we&#x27;ll see those changes and explain them below.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod1---reflectz">Pod1 - <code>reflectz</code><a href="#pod1---reflectz" class="hash-link" aria-label="Direct link to pod1---reflectz" title="Direct link to pod1---reflectz">​</a></h3>
<p>The <code>relectz</code> workload we&#x27;ll deploy for ClusterB will be nearly identical to the ClusterA workload. We will create a service for the actual &#x27;reflect&#x27; service. We will make a service for Prometheus to scrape the workload. We&#x27;ll also need another identity, so we&#x27;ll create that identity, authorize it to bind the services, and authorize clients to access the workload. Since this process is very similar to what we did for ClusterA, there&#x27;s not much to explain. Setup ClusterB&#x27;s <code>reflectz</code> now.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-identity-1">Create the Identity<a href="#create-the-identity-1" class="hash-link" aria-label="Direct link to Create the Identity" title="Direct link to Create the Identity">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user kubeB.reflect.id -o /tmp/prometheus/kubeB.reflect.id.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge enroll /tmp/prometheus/kubeB.reflect.id.jwt -o /tmp/prometheus/kubeB.reflect.id.json</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-configs-and-services-including-tunneling-based-access-2">Create Configs and Services (including Tunneling-based Access)<a href="#create-configs-and-services-including-tunneling-based-access-2" class="hash-link" aria-label="Direct link to Create Configs and Services (including Tunneling-based Access)" title="Direct link to Create Configs and Services (including Tunneling-based Access)">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create intercept configs for the two services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config kubeB.reflect.svc-intercept.v1 intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeB.reflect.svc.ziti&quot;],&quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}]}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config &quot;kubeB.reflect.svc-intercept.v1.scrape&quot; intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeB.reflect.scrape.svc.ziti&quot;], &quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}], &quot;dialOptions&quot;:{&quot;identity&quot;:&quot;kubeB.reflect.id&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># create the two services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeB.reflect.svc&quot; --configs &quot;kubeB.reflect.svc-intercept.v1&quot; -a &quot;kubeB.reflect.svc.services&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeB.reflect.scrape.svc&quot; --configs &quot;kubeB.reflect.svc-intercept.v1.scrape&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorize-the-workload-to-bind-the-services">Authorize the Workload to Bind the Services<a href="#authorize-the-workload-to-bind-the-services" class="hash-link" aria-label="Direct link to Authorize the Workload to Bind the Services" title="Direct link to Authorize the Workload to Bind the Services">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create the bind service policies and authorize the reflect id to bind these services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.reflect.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.reflect.svc&quot; --identity-roles &quot;@kubeB.reflect.id&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.reflect.scrape.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.reflect.scrape.svc&quot; --identity-roles &quot;@kubeB.reflect.id&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorize-clients-to-access-the-services">Authorize Clients to Access the Services<a href="#authorize-clients-to-access-the-services" class="hash-link" aria-label="Direct link to Authorize Clients to Access the Services" title="Direct link to Authorize Clients to Access the Services">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create the dial service policies and authorize the reflect id to bind these services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.reflect.svc.dial&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.reflect.svc&quot; --identity-roles &quot;#reflectz-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.reflect.svc.dial.scrape&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.reflect.scrape.svc&quot; --identity-roles &quot;#reflectz-clients&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploy-reflectz-1">Deploy <code>reflectz</code><a href="#deploy-reflectz-1" class="hash-link" aria-label="Direct link to deploy-reflectz-1" title="Direct link to deploy-reflectz-1">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add openziti-test-kitchen https://openziti-test-kitchen.github.io/helm-charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install reflectz openziti-test-kitchen/reflect \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file reflectIdentity=&quot;/tmp/prometheus/kubeB.reflect.id.json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set serviceName=&quot;kubeB.reflect.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set prometheusServiceName=&quot;kubeB.reflect.scrape.svc&quot;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="pod-2---prometheuz">Pod 2 - <code>Prometheuz</code><a href="#pod-2---prometheuz" class="hash-link" aria-label="Direct link to pod-2---prometheuz" title="Direct link to pod-2---prometheuz">​</a></h3>
<p>For ClusterB we want <code>Prometheuz</code> to be <strong>totally dark</strong>. It will exclusively listen on the OpenZiti overlay and there will be no listening ports on the underlay. We will need another identity, of course, and most of the configuration and commands appear the same on the surface with very subtle differences. We&#x27;ll explore these differences as we go. In this section we&#x27;ll be making an identity, <strong>one config</strong> (a difference from the ClusterA install), a service, and two service-policies. Let&#x27;s get to it.</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-the-identity-2">Create the Identity<a href="#create-the-identity-2" class="hash-link" aria-label="Direct link to Create the Identity" title="Direct link to Create the Identity">​</a></h4>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user kubeB.prometheus.id -o /tmp/prometheus/kubeB.prometheus.id.jwt -a &quot;reflectz-clients&quot;,&quot;prometheus-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge enroll /tmp/prometheus/kubeB.prometheus.id.jwt -o /tmp/prometheus/kubeB.prometheus.id.json</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="create-one-config-and-service">Create <strong>One</strong> Config and Service<a href="#create-one-config-and-service" class="hash-link" aria-label="Direct link to create-one-config-and-service" title="Direct link to create-one-config-and-service">​</a></h4>
<p>Here&#x27;s a difference from ClusterA. Since we are going to listen on the OpenZiti overlay, we are not installing <code>ziti-host</code>. That means we don&#x27;t need to create a <code>host.v1</code> config. A <code>host.v1</code> config is necessary for services which have a &#x27;Bind&#x27; configuration and are being bound by a tunneling application. We&#x27;re not doing that, here Prometheus will &#x27;Bind&#x27; this service, thus we don&#x27;t need that <code>host.v1</code> config.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># create the config and service for the kubeB prometheus server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config &quot;kubeB.prometheus.svc-intercept.v1&quot; intercept.v1 \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &#x27;{&quot;protocols&quot;:[&quot;tcp&quot;],&quot;addresses&quot;:[&quot;kubeB.prometheus.svc&quot;],&quot;portRanges&quot;:[{&quot;low&quot;:80, &quot;high&quot;:80}], &quot;dialOptions&quot;: {&quot;identity&quot;:&quot;kubeB.prometheus.id&quot;}}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># no need for the host.v1 config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service &quot;kubeB.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --configs &quot;kubeB.prometheus.svc-intercept.v1&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="authorize-clients-and-prometheus-to-bind-the-service">Authorize Clients and Prometheus to Bind the Service<a href="#authorize-clients-and-prometheus-to-bind-the-service" class="hash-link" aria-label="Direct link to Authorize Clients and Prometheus to Bind the Service" title="Direct link to Authorize Clients and Prometheus to Bind the Service">​</a></h4>
<p>At first, these commands appear identical. You need to look very closely to notice the difference between these command and the ones we ran for ClusterA, other than the obvious changes from &quot;kubeA&quot; to &quot;kubeB&quot;. Pay close attention to the supplied <code>--identity-roles</code> for the bind policy specified below. With ClusterA, we did not have Prometheus listen on the overlay and we allowed Prometheus to listen on the underlay. That meant we needed to deploy <code>ziti-host</code> into that cluster to provide access to the service, and that means the service had to be bound by the <code>ziti-host</code> identity.</p>
<p>Here we are flipping that script. We are allowing Prometheus to bind this service! That means we&#x27;ll need to authorize the <code>kubeB.prometheus.id</code> to be able to bind the service.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># grant the prometheus clients the ability to dial the service and the kubeB.prometheus.id the ability to bind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.prometheus.svc.dial&quot; Dial \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-roles &quot;#prometheus-clients&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy &quot;kubeB.prometheus.svc.bind&quot; Bind \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --service-roles &quot;@kubeB.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --identity-roles &quot;@kubeB.prometheus.id&quot;</span><br></span></code></pre></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="deploying-prometheuz">Deploying <code>Prometheuz</code><a href="#deploying-prometheuz" class="hash-link" aria-label="Direct link to deploying-prometheuz" title="Direct link to deploying-prometheuz">​</a></h4>
<p>At this point we have the OpenZiti overlay all configured. What&#x27;s left, is to deploy Prometheus into ClusterB. This command is substantially different from what we ran while deploying Prometheus into ClusterA. You&#x27;ll see that we need to supply two other identities for this installation. Remember, Prometheus will be entirely dark once deployed into ClusterB, listening only on the OpenZiti overlay. The container in the pod which monitors configmap changes won&#x27;t be able to trigger a webhook using the underlay! This <code>configmap-reloadz</code> is a second &quot;zitification&quot; we didn&#x27;t realize we were deploying in ClusterA, because we did not need it. We need it for ClusterB.</p>
<p>You&#x27;ll see for configmapReload we need to supply the identity which the container will use to hit the Prometheus webhook. We do that by passing <code>--set-file configmapReload.ziti.id.contents=&quot;/tmp/prometheus/kubeB.prometheus.id.json&quot;</code>. Then we&#x27;ll supply the service which <code>configmap-reloadz</code> will dial, and we&#x27;ll also specify what identity we expect to be hosting the service.</p>
<p>Next you&#x27;ll see we need to supply the identity to the Prometheus server we want to allow to listen on the OpenZiti overlay ( <code>-set-file server.ziti.id.contents</code>). Similar to <code>configmap-reloadz</code> we will also specify the service and identity name to bind.</p>
<p>Finally, to allow the server to scrape targets we need to supply a final identity which will be used when scraping targets with <code>--set-file server.scrape.id.contents</code>.</p>
<p>You&#x27;ll notice for simplicities sake, we are using the same identity for all three needs which is perfectly fine. If you wanted to use a different identity, you could. That choice is up to you. To keep it simple we just authorized this identity for all these purposes.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># install prometheus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo add openziti-test-kitchen https://openziti-test-kitchen.github.io/helm-charts/</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm repo update</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">helm install prometheuz openziti-test-kitchen/prometheus \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file configmapReload.ziti.id.contents=&quot;/tmp/prometheus/kubeB.prometheus.id.json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --set configmapReload.ziti.targetService=&quot;kubeB.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --set configmapReload.ziti.targetIdentity=&quot;kubeB.prometheus.id&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file server.ziti.id.contents=&quot;/tmp/prometheus/kubeB.prometheus.id.json&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --set server.ziti.service=&quot;kubeB.prometheus.svc&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       --set server.ziti.identity=&quot;kubeB.prometheus.id&quot; \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  --set-file server.scrape.id.contents=&quot;/tmp/prometheus/kubeB.prometheus.id.json&quot;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="whats-next">What&#x27;s Next<a href="#whats-next" class="hash-link" aria-label="Direct link to What&#x27;s Next" title="Direct link to What&#x27;s Next">​</a></h2>
<p>In this article we&#x27;ve done a lot of OpenZiti CLI work, run some <code>kubectl</code> and <code>helm</code> commands but we still haven&#x27;t explored what it is we are building and why it&#x27;s so cool. We&#x27;ll do that in the <a href="/docs/openziti/blog/scraping-anything-anywhere-in-action">last, and final</a> article. Hopefully, the payoff for you will be as rewarding as it was for me while building this article series.</p>
<hr>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="addendum---a-quicker-start">Addendum - a Quicker Start<a href="#addendum---a-quicker-start" class="hash-link" aria-label="Direct link to Addendum - a Quicker Start" title="Direct link to Addendum - a Quicker Start">​</a></h4>
<p>All the commands above are also available in github as <code>.sh</code> scripts. If you would prefer, you can clone the <a href="https://github.com/openziti/ziti-doc" target="_blank" rel="noopener noreferrer">ziti-doc repository</a> and access the scripts from the path mentioned below. &quot;Cleanup&quot; scripts are provided if desired.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">${checkout_root}/docusaurus/blog/zitification/prometheus/scripts</span><br></span></code></pre></div></div></div><footer class="docusaurus-mt-lg"><div class="row margin-top--sm theme-blog-footer-edit-meta-row"><div class="col"><b>Tags:</b><ul class="tags_jXut padding--none margin-left--sm"><li class="tag_QGVx"><a rel="tag" title="Kubernetes content" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/kubernetes">Kubernetes</a></li><li class="tag_QGVx"><a rel="tag" title="Prometheus monitoring" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/prometheus">Prometheus</a></li><li class="tag_QGVx"><a rel="tag" title="Zero Trust Networking" class="tag_zVej tagRegular_sFm0" href="/docs/openziti/blog/tags/zerotrust">Zero Trust</a></li></ul></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/openziti/blog/bootstrapping-trust-part-1-encryption-everywhere"><div class="pagination-nav__sublabel">Newer post</div><div class="pagination-nav__label">Bootstrapping Trust Part 1 - Encryption Everywhere</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/openziti/blog/prometheus-scrape-anything-from-anywhere"><div class="pagination-nav__sublabel">Older post</div><div class="pagination-nav__label">Prometheus - Scrape Anything from Anywhere</div></a></nav></main><div class="col col--2"><div class="tableOfContents_bqdL thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#goals" class="table-of-contents__link toc-highlight">Goals</a></li><li><a href="#zitified-prometheus" class="table-of-contents__link toc-highlight">Zitified Prometheus</a></li><li><a href="#solution-overview" class="table-of-contents__link toc-highlight">Solution Overview</a></li><li><a href="#digging-in" class="table-of-contents__link toc-highlight">Digging In</a><ul><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li></ul></li><li><a href="#clustera---using-ziti-host" class="table-of-contents__link toc-highlight">ClusterA - Using <code>ziti-host</code></a><ul><li><a href="#pod-1---ziti-host" class="table-of-contents__link toc-highlight">Pod 1 - <code>ziti-host</code></a></li><li><a href="#pod-2---reflectz" class="table-of-contents__link toc-highlight">Pod 2 - <code>reflectz</code></a></li><li><a href="#pod-3---prometheuz" class="table-of-contents__link toc-highlight">Pod 3 - <code>Prometheuz</code></a></li></ul></li><li><a href="#clusterb---fully-dark" class="table-of-contents__link toc-highlight">ClusterB - Fully Dark</a><ul><li><a href="#pod1---reflectz" class="table-of-contents__link toc-highlight">Pod1 - <code>reflectz</code></a></li><li><a href="#pod-2---prometheuz" class="table-of-contents__link toc-highlight">Pod 2 - <code>Prometheuz</code></a></li></ul></li><li><a href="#whats-next" class="table-of-contents__link toc-highlight">What&#39;s Next</a></li></ul></div></div></div></div><footer class="styles-module_ozFooter__vHkQA"><section class="styles-module_footer__Qk0iB styles-module_ozHorizontalSectionRoot__QwWz0 styles-module_ozhsContent__haNeV"><div class="styles-module_footerContainer__azQkg"><div class="styles-module_footerGrid__fsf9C"><div class="styles-module_footerColumn__tK2bv"><h3>NetFoundry</h3><p>An open source project enabling developers to embed zero trust networking directly into applications.</p><div class="styles-module_footerSocialLinks__b1FcV"><a href="https://github.com/openziti/ziti" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a><a href="https://www.linkedin.com/in/netfoundry/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 16V10.1C15.996 7.5 15.375 5.49999 12.025 5.49999C10.4 5.49999 9.325 6.39999 8.875 7.29999H8.825V5.79999H5.65V16H8.95V10.7C8.95 9.30001 9.2 7.9 10.925 7.9C12.65 7.9 12.675 9.59999 12.675 10.8V16H15.996Z"></path><path d="M0.25 5.79999H3.575V16H0.25V5.79999Z"></path><path d="M1.9 0C0.85 0 0 0.85 0 1.9C0 2.95 0.85 3.8 1.9 3.8C2.95 3.8 3.8 2.95 3.8 1.9C3.8 0.85 2.95 0 1.9 0Z"></path></svg></a><a href="https://youtube.com/openziti/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.969 4.69c-.183-1.358-1.062-2.275-2.361-2.46C12.371 2 8 2 8 2S3.629 2 2.362 2.229c-1.3.186-2.179 1.103-2.361 2.461C0 6.03 0 10 0 10s0 3.97.2 5.31c.183 1.358 1.062 2.275 2.361 2.46C3.63 18 8 18 8 18s4.371 0 5.638-.23c1.3-.185 2.178-1.102 2.361-2.46.2-1.34.2-5.31.2-5.31s0-3.97-.23-5.31zm-8.36, 8.57V6.73l3.76 2.27-3.76 2.26z"></path></svg></a><a href="https://twitter.com/openziti/" target="_blank" class="styles-module_footerSocialLink__iAElV" rel="noreferrer"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 3.038c-.59.262-1.219.44-1.885.52.677-.406 1.194-1.05 1.438-1.815-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.038-2.396-1.038-1.813 0-3.283 1.469-3.283 3.282 0 .257.03.507.085.748-2.728-.137-5.147-1.445-6.766-3.43-.282.485-.444 1.05-.444 1.651 0 1.14.58 2.143 1.46 2.732-.538-.017-1.044-.164-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.219-.276.075-.567.116-.866.116-.211 0-.416-.021-.617-.06.418 1.304 1.63 2.254 3.066 2.28-1.124.883-2.539 1.406-4.077 1.406-.265 0-.526-.015-.785-.046 1.453.933 3.178 1.475 5.032 1.475 6.038 0 9.34-5.002 9.34-9.34 0-.142-.004-.284-.01-.425.641-.463 1.198-1.039 1.638-1.696"></path></svg></a></div></div><div class="styles-module_footerColumn__tK2bv"><h3>Community</h3><ul class="styles-module_footerLinks__eOmJ9"><li><a href="https://github.com/openziti/ziti">GitHub</a></li><li><a href="https://openziti.discourse.group/">Discourse Forum</a></li><li><a href="/docs/openziti/policies/CONTRIBUTING">Contributing</a></li></ul></div><div class="styles-module_footerColumn__tK2bv"><h3>Resources</h3><ul class="styles-module_footerLinks__eOmJ9"><li><a href="https://blog.openziti.io">OpenZiti Tech Blog</a></li><li><a href="https://netfoundry.io/">NetFoundry</a></li></ul></div></div></div><div class="styles-module_footerCopyright__nWyvc"><p>© 2025 NetFoundry Inc. OpenZiti is an open source project sponsored by NetFoundry. All rights reserved.</p></div></section></footer></div></div>
</body>
</html>