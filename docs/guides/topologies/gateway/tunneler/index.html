<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/topologies/gateway/tunneler" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Use a Tunneler as a Local Gateway | OpenZiti</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openziti.io/docs/guides/topologies/gateway/tunneler"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="index, follow"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Use a Tunneler as a Local Gateway | OpenZiti"><meta data-rh="true" name="description" content="1.0 Introduction"><meta data-rh="true" property="og:description" content="1.0 Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://openziti.io/docs/guides/topologies/gateway/tunneler"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/guides/topologies/gateway/tunneler" hreflang="en"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/guides/topologies/gateway/tunneler" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Topologies","item":"https://openziti.io/docs/category/topologies"},{"@type":"ListItem","position":2,"name":"Gateway","item":"https://openziti.io/docs/category/gateway"},{"@type":"ListItem","position":3,"name":"Tunneler","item":"https://openziti.io/docs/guides/topologies/gateway/tunneler"}]}</script><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-5SF399H3",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml">

<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:3576473,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script><link rel="stylesheet" href="/assets/css/styles.f2cef296.css">
<script src="/assets/js/runtime~main.c313881b.js" defer="defer"></script>
<script src="/assets/js/main.f4bf6000.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF399H3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>




<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/ziti-logo-dark.svg"><link rel="preload" as="image" href="/img/ziti-logo-light.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="starUsRoot_Cir2"><span style="color:whitesmoke">Star us on GitHub </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" target="_self" href="/"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ziti-logo-light.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://netfoundry.io/products/netfoundry-cloud-30-day-free-trial/" target="_blank">NetFoundry</a></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/downloads">Downloads</a><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://blog.openziti.io/" target="_blank">Blog</a></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li class=""><div class="text-divider"><p>Socials</p></div></li><li class=""><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/yt.svg" alt="YouTube logo">YouTube</span></a></li><li class=""><a href="https://x.com/OpenZiti" target="_blank" title="OpenZiti on X(formerly Twitter)"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/twit.svg" alt="X/Twitter logo">X (Twitter)</span></a></li><li class=""><a href="https://www.reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/reddit-logo.png" alt="Reddit logo">Reddit</span></a></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/ziggy.png" alt="X/Twitter Ziggy logo"><a href="https://x.com/OpenZiggy" target="_blank" title="OpenZiggy on X(formerly Twitter)">Ziggy</a></span></li><li class=""><div class="text-divider"><p>Other</p></div></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/blog-icon.png" alt="OpenZiti blog logo"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/oz-test-kitchen.png" alt="OpenZiti Test Kitchen logo"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper ozLayoutMainWrapper_maOX"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/learn/introduction">LEARN</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/introduction/">What is OpenZiti?</a><button aria-label="Expand sidebar category &#x27;What is OpenZiti?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/quickstarts/">Quickstarts</a><button aria-label="Expand sidebar category &#x27;Quickstarts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/core-concepts">Core Concepts</a><button aria-label="Expand sidebar category &#x27;Core Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learn/identity-providers/">Identity Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/reference">REFERENCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/configuration/conventions">Configuration</a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/reference/ha/overview">Controller Clustering</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/tunnelers/">Tunnelers</a><button aria-label="Expand sidebar category &#x27;Tunnelers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/command-line/login">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/logging">Logging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/config-types/">Config Types</a><button aria-label="Expand sidebar category &#x27;Config Types&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/events">Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/developer/">Developer</a><button aria-label="Expand sidebar category &#x27;Developer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/guides">GUIDES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/deployments">Deployments</a><button aria-label="Expand sidebar category &#x27;Deployments&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/external-auth/">Configuring OIDC</a><button aria-label="Expand sidebar category &#x27;Configuring OIDC&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/hsm/">Hardware Keys</a><button aria-label="Expand sidebar category &#x27;Hardware Keys&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/category/topologies">Topologies</a><button aria-label="Collapse sidebar category &#x27;Topologies&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/topologies/services">Services</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/category/gateway">Gateway</a><button aria-label="Collapse sidebar category &#x27;Gateway&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/topologies/gateway/router">Router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/topologies/gateway/tunneler">Tunneler</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/topologies"><span>Topologies</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/category/gateway"><span>Gateway</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Tunneler</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Use a Tunneler as a Local Gateway</h1></header><h2 class="anchor anchorWithStickyNavbar_LWe7" id="10-introduction">1.0 Introduction<a href="#10-introduction" class="hash-link" aria-label="Direct link to 1.0 Introduction" title="Direct link to 1.0 Introduction">​</a></h2>
<p>This article is about using <code>ziti-edge-tunnel run</code> as an infrastructure gateway providing an IP route and nameserver for ziti services on a local subnet.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="11-network-description">1.1 Network Description<a href="#11-network-description" class="hash-link" aria-label="Direct link to 1.1 Network Description" title="Direct link to 1.1 Network Description">​</a></h2>
<p>For the demonstration, we will set up the network like below:</p>
<hr>
<p><img decoding="async" loading="lazy" alt="Diagram" src="/assets/images/LocalGW21-97990639d2225792cd5b074138b04ac8.png" width="827" height="676" class="img_ev3q"></p>
<hr>
<ul>
<li>There are two Ziti-Edge-Tunnels (<strong>local-tunnel</strong> and <strong>remote-tunnel</strong>) as LAN gateways.</li>
<li>The Windows machine (<strong>Windows Client</strong>) is in the same subnet (172.16.31.0/24) as Tunneler (<strong>local-tunnel</strong>).</li>
<li>The Ubuntu 22.04 server (<strong>Ubuntu Server</strong>) is in the same subnet (172.16.240.0/24) as Tunneler (<strong>remote-tunnel</strong>).</li>
<li>The data (ssh) will be passed between the Windows Client and the Ubuntu Server.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="12-prerequisite">1.2 Prerequisite<a href="#12-prerequisite" class="hash-link" aria-label="Direct link to 1.2 Prerequisite" title="Direct link to 1.2 Prerequisite">​</a></h2>
<p>Complete the following steps First.</p>
<ul>
<li>An open-ziti network should be created already. If not, please follow this quickstart <a href="/docs/learn/quickstarts/network/hosted">Host OpenZiti Anywhere</a> guide to set up a ziti network first.</li>
<li>Created two <em>tunnelers</em> already. The tunnelers should be running on <strong>Ubuntu 22.04</strong>. This demo uses Ubuntu 22.04 as an example.</li>
<li>Created one <em>windows client</em> already. Suggested Windows 10 or Windows 11. Windows servers should work fine as well.</li>
<li>Created one <em>ubuntu server</em> already. Or any Linux server capable of accepting SSH and HTTP connections.</li>
<li>We also need at least one transit router and one public edge router. The quickstart sets up a router with both transit and edge functionality. So if you used the quickstart guide, this should work already.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="20-setup-tunnelers">2.0 Setup Tunnelers<a href="#20-setup-tunnelers" class="hash-link" aria-label="Direct link to 2.0 Setup Tunnelers" title="Direct link to 2.0 Setup Tunnelers">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="21-create-tunnelers-on-the-controller">2.1 Create Tunnelers on the Controller<a href="#21-create-tunnelers-on-the-controller" class="hash-link" aria-label="Direct link to 2.1 Create Tunnelers on the Controller" title="Direct link to 2.1 Create Tunnelers on the Controller">​</a></h2>
<p>Login to your controller and create two identities named <strong>local-tunnel</strong> and <strong>remote-tunnel</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh &lt;user&gt;@68.183.139.122</span><br></span></code></pre></div></div>
<p>Then source the environmental file (only need to perform once per login).</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/.ziti/quickstart/$(hostname -s)/$(hostname -s).env</span><br></span></code></pre></div></div>
<p>Login to ziti cli.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zitiLogin</span><br></span></code></pre></div></div>
<p>Create identities and save the enrollment token to files.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity local-tunnel -o local-tunnel.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity remote-tunnel -o remote-tunnel.jwt</span><br></span></code></pre></div></div>
<p><strong>output</strong></p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge create identity local-tunnel -o local-tunnel.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New identity local-tunnel created with id: PVen7KeIY5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enrollment expires at 2023-04-26T23:02:10.200Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge create identity remote-tunnel -o remote-tunnel.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">New identity remote-tunnel created with id: LtnYRL2IY</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enrollment expires at 2023-04-26T23:06:01.955Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ls -l *jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- 1 root root 893 Apr 26 20:02 local-tunnel.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">-rw------- 1 root root 892 Apr 26 20:06 remote-tunnel.jwt</span><br></span></code></pre></div></div>
<p><strong>add attribute to the identity</strong>, now we want to update the identities to have some attribute. The local-tunnel has attribute &quot;clients&quot;. The remote-tunnel has attribute &quot;hosts&quot;.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge update identity local-tunnel -a clients</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge update identity remote-tunnel -a hosts</span><br></span></code></pre></div></div>
<p>Check to make sure both identities are created correctly with right attribute.</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list identities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬───────────────────────────┬────────┬────────────┬─────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                      │ TYPE   │ ATTRIBUTES │ AUTH-POLICY │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼───────────────────────────┼────────┼────────────┼─────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ TvWsTie6Y  │ remote-tunnel             │ User   │ hosts      │ default     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ gBWYMi26Y5 │ local-tunnel              │ User   │ clients    │ default     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ lIend76Tu  │ Default Admin             │ User   │            │ default     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xCW0lSWpcn │ LocalGWDemoNC-edge-router │ Router │            │ default     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴───────────────────────────┴────────┴────────────┴─────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-4 of 4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="22-setup-the-tunneler-for-windows-subnet">2.2 Setup the Tunneler For Windows Subnet<a href="#22-setup-the-tunneler-for-windows-subnet" class="hash-link" aria-label="Direct link to 2.2 Setup the Tunneler For Windows Subnet" title="Direct link to 2.2 Setup the Tunneler For Windows Subnet">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="221-register-identities">2.2.1 Register Identities<a href="#221-register-identities" class="hash-link" aria-label="Direct link to 2.2.1 Register Identities" title="Direct link to 2.2.1 Register Identities">​</a></h3>
<p>Login to your <strong>local-tunnel</strong> machine/VM. Follow <a href="/docs/reference/tunnelers/linux/">Install Linux Package:</a> <strong>Ubuntu Jammy 22.04</strong> section to install and register your <code>ziti-edge-tunnel</code>. Use the <strong>local-tunnel.jwt</strong> created earlier for its identity token.</p>
<p>After the tunnel is registered, check the status and make sure it is running correctly. The status should show &quot;active (running)&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziggy@local-tunnel:~$ systemctl status ziti-edge-tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">● ziti-edge-tunnel.service - Ziti Edge Tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Loaded: loaded (/etc/systemd/system/ziti-edge-tunnel.service; enabled; vendor preset: enabled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Active: active (running) since Fri 2023-04-28 18:38:41 UTC; 3 days ago</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;... output truncated ...&gt;</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="222-set-up-ufw">2.2.2 Set Up ufw<a href="#222-set-up-ufw" class="hash-link" aria-label="Direct link to 2.2.2 Set Up ufw" title="Direct link to 2.2.2 Set Up ufw">​</a></h3>
<p>The following steps turn on the ufw firewall and opens the ports for this demo.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.31.175/32 port 53 proto udp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.31.175/32 port 22 proto tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.31.175/32 port 80 proto tcp</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="223-set-up-forwarding">2.2.3 Set up Forwarding<a href="#223-set-up-forwarding" class="hash-link" aria-label="Direct link to 2.2.3 Set up Forwarding" title="Direct link to 2.2.3 Set up Forwarding">​</a></h3>
<p>First, set up IP forwarding in the Linux system.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;net.ipv4.ip_forward = 1&quot; | sudo tee /etc/sysctl.d/01-ipforward.conf &gt;/dev/null</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo sysctl -p /etc/sysctl.d/01-ipforward.conf</span><br></span></code></pre></div></div>
<p>Second, set up forwarding on the firewall from the local interface to the tun interface created by ziti (tun0).</p>
<p>Find the local interface first, if you have only one local interface, this command can help you find the name of the interface.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ip -o -4 route show to default | awk &#x27;{print $5}&#x27;</span><br></span></code></pre></div></div>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziggy@local-tunnel:~$ ip -o -4 route show to default | awk &#x27;{print $5}&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ens160</span><br></span></code></pre></div></div>
<p>Now set up forwarding with ufw</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw route allow in on ens160 out on tun0</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="23-setup-the-tunneler-for-ubuntu-server-subnet">2.3 Setup the Tunneler For Ubuntu Server Subnet<a href="#23-setup-the-tunneler-for-ubuntu-server-subnet" class="hash-link" aria-label="Direct link to 2.3 Setup the Tunneler For Ubuntu Server Subnet" title="Direct link to 2.3 Setup the Tunneler For Ubuntu Server Subnet">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="231-register-identities">2.3.1 Register Identities<a href="#231-register-identities" class="hash-link" aria-label="Direct link to 2.3.1 Register Identities" title="Direct link to 2.3.1 Register Identities">​</a></h3>
<p>Login to your <strong>remote-tunnel</strong> machine/VM. Register the tunneler by using <strong>remote-tunnel.jwt</strong> token with the instructions mentioned in <a href="#221-register-identities">this section</a>.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="232-set-up-ufw">2.3.2 Set up ufw<a href="#232-set-up-ufw" class="hash-link" aria-label="Direct link to 2.3.2 Set up ufw" title="Direct link to 2.3.2 Set up ufw">​</a></h3>
<p>For this demo, we only show the connection initiated from local-tunnel side towards remote-tunnel. The ufw rules below are not needed. If you want to have bidirectional connections, you will need to setup these rules.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.240.130/32 port 53 proto udp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.240.130/32 port 22 proto tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.240.130/32 port 80 proto tcp</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="30-setup-client-and-server">3.0 Setup Client and Server<a href="#30-setup-client-and-server" class="hash-link" aria-label="Direct link to 3.0 Setup Client and Server" title="Direct link to 3.0 Setup Client and Server">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-ubuntu-server">3.1 Ubuntu Server<a href="#31-ubuntu-server" class="hash-link" aria-label="Direct link to 3.1 Ubuntu Server" title="Direct link to 3.1 Ubuntu Server">​</a></h2>
<p>The Ubuntu Server needs to support <strong>ssh</strong> (port 22) and <strong>http</strong> (port 8000) for our demo.</p>
<p>Make sure these ports are open on the firewall.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.240.129/32 port 22 proto tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow from any to 172.16.240.129/32 port 8000 proto tcp</span><br></span></code></pre></div></div>
<p>Next, start the webserver. The web server will be listening on the port 8000.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">echo &quot;You have reached Remote Web Server.&quot; &gt;hello.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">python3 -m http.server</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-windows-client">3.2 Windows Client<a href="#32-windows-client" class="hash-link" aria-label="Direct link to 3.2 Windows Client" title="Direct link to 3.2 Windows Client">​</a></h2>
<p>There are two changes we need to make on the windows side.</p>
<p>The first one, we need to change the configuration of the preferred DNS to point to our resolver on the <strong>local-tunnel</strong>, the resolver is listening on &quot;100.64.0.2&quot;.</p>
<p><img decoding="async" loading="lazy" alt="Diagram" src="/assets/images/LocalGW24-54eb8e2a977aa2d2a56002faa31eafbd.png" width="582" height="623" class="img_ev3q"></p>
<p>The second change is to set up routing.</p>
<ul>
<li>We need to route the <strong>100.64.0.0/10</strong> traffic to our <strong>local-tunnel</strong>. Any DNS-based intercept resolved to the IP in the subnet 100.64.0.0/10.</li>
<li>We also need to route <strong>172.16.240.129/32</strong> to <strong>local-tunnel</strong>.  <strong>172.16.240.129</strong> is the IP we intended to intercept and pass through the ziti fabric.</li>
</ul>
<p>To do this, open a Windows terminal as Administrator.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">route add 100.64.0.0 mask 255.192.0.0 172.16.31.175</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">route add 172.16.240.129 mask 255.255.255.255 172.16.31.175</span><br></span></code></pre></div></div>
<p><img decoding="async" loading="lazy" alt="Diagram" src="data:image/png;base64,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" width="653" height="167" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="40-ssh-service-configuration">4.0 ssh Service Configuration<a href="#40-ssh-service-configuration" class="hash-link" aria-label="Direct link to 4.0 ssh Service Configuration" title="Direct link to 4.0 ssh Service Configuration">​</a></h2>
<p>We make all configuration changes on the controller. Login to the controller and connect to ziti cli first.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh &lt;user&gt;@68.183.139.122</span><br></span></code></pre></div></div>
<p>Example - how to start CLI with quickstart created controller:</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/.ziti/quickstart/$(hostname -s)/$(hostname -s).env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zitiLogin</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="41-create-an-interceptv1-config">4.1 Create an intercept.v1 config<a href="#41-create-an-interceptv1-config" class="hash-link" aria-label="Direct link to 4.1 Create an intercept.v1 config" title="Direct link to 4.1 Create an intercept.v1 config">​</a></h2>
<p>This config is used for local side connection. We are setting up intercept on DNS name &quot;mysimpleservice.ziti&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config ssh-intercept-config intercept.v1 &#x27;{&quot;protocols&quot;: [&quot;tcp&quot;], &quot;addresses&quot;: [&quot;mysimpleservice.ziti&quot;], &quot;portRanges&quot;: [{&quot;low&quot;: 22, &quot;high&quot;: 22}]}&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="42-create-a-hostv1-config">4.2 Create a host.v1 config<a href="#42-create-a-hostv1-config" class="hash-link" aria-label="Direct link to 4.2 Create a host.v1 config" title="Direct link to 4.2 Create a host.v1 config">​</a></h2>
<p>This config is used for remote side connection. We are setting up the address the remote server can reach. In this demo, We are dropping the traffic off at &quot;172.16.240.129&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config ssh-host-config host.v1 &#x27;{&quot;address&quot;:&quot;172.16.240.129&quot;, &quot;protocol&quot;:&quot;tcp&quot;, &quot;port&quot;:22}&#x27;</span><br></span></code></pre></div></div>
<p>If the config command were successfully, you will see two configs by using &quot;list configs&quot; command:</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────────────────────┬──────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME                 │ CONFIG TYPE  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────────────────────┼──────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2U1aRwQCQMHTdrrPTkoafR │ ssh-host-config      │ host.v1      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 6eduUGlPVvvqCruHc1V7Zd │ ssh-intercept-config │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────────────────────┴──────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="43-create-ssh-service">4.3 Create ssh Service<a href="#43-create-ssh-service" class="hash-link" aria-label="Direct link to 4.3 Create ssh Service" title="Direct link to 4.3 Create ssh Service">​</a></h2>
<p>Now we need to put these two configs into a service. We going to name the service &quot;ssh&quot; and assign an attribute &quot;tun-hosted&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service ssh -c ssh-intercept-config,ssh-host-config -a tun-hosted</span><br></span></code></pre></div></div>
<p><strong>Check Service</strong> by using &quot;list service&quot;</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────┬────────────┬─────────────────────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME │ ENCRYPTION │ TERMINATOR STRATEGY │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                        │      │  REQUIRED  │                     │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────┼────────────┼─────────────────────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 4I7PmAQZ6GhTKkzTRhN0Ac │ ssh  │ true       │ smartrouting        │ tun-hosted │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────┴────────────┴─────────────────────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-1 of 1</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="44-create-service-edge-router-policy">4.4 Create Service Edge Router Policy<a href="#44-create-service-edge-router-policy" class="hash-link" aria-label="Direct link to 4.4 Create Service Edge Router Policy" title="Direct link to 4.4 Create Service Edge Router Policy">​</a></h2>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-edge-router-policy ssh-serp --edge-router-roles &#x27;#all&#x27; --service-roles &#x27;#tun-hosted&#x27; --semantic &#x27;AnyOf&#x27;</span><br></span></code></pre></div></div>
<p>Check your service-edge-router-policy, and make sure the policy name &quot;ssh-serp&quot; is created. The automatically created one is called &quot;allSvcAllRouters&quot;.</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list service-edge-router-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────────────────┬───────────────┬───────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME             │ SERVICE ROLES │ EDGE ROUTER ROLES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────────────────┼───────────────┼───────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 5QzQPx6EUOJXT0hTm26Vuc │ allSvcAllRouters │ #all          │ #all              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 70HiRuxK2JHjz9AuuzEhBt │ ssh-serp         │ #tun-hosted   │ #all              │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────────────────┴───────────────┴───────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="45-create-bind-policies">4.5 Create Bind policies<a href="#45-create-bind-policies" class="hash-link" aria-label="Direct link to 4.5 Create Bind policies" title="Direct link to 4.5 Create Bind policies">​</a></h2>
<p>We need to specify which identity (in our case, <strong>#hosts</strong>) is going to host the service by setting up a bind service policy</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy ssh-bind Bind --identity-roles &quot;#hosts&quot; --service-roles &#x27;#tun-hosted&#x27; --semantic &#x27;AnyOf&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="46-create-dial-policies">4.6 Create Dial policies<a href="#46-create-dial-policies" class="hash-link" aria-label="Direct link to 4.6 Create Dial policies" title="Direct link to 4.6 Create Dial policies">​</a></h2>
<p>We also need to specify which identity (in this case, <strong>#clients</strong>) is going to intercept the service by setting up a dial service policy</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy ssh-dial Dial --identity-roles &quot;#clients&quot; --service-roles &#x27;#tun-hosted&#x27; --semantic &#x27;AnyOf&#x27;</span><br></span></code></pre></div></div>
<p>If both policies are setup correctly, you should see two service-policies.</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list service-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────────┬──────────┬───────────────┬────────────────┬─────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME     │ SEMANTIC │ SERVICE ROLES │ IDENTITY ROLES │ POSTURE CHECK ROLES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────────┼──────────┼───────────────┼────────────────┼─────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 5hzzeiQBcao4VpQWv645Al │ ssh-bind │ AnyOf    │ #tun-hosted   │ #hosts         │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 5zLKYSfTSXojhZGhFC8uYF │ ssh-dial │ AnyOf    │ #tun-hosted   │ #clients       │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────────┴──────────┴───────────────┴────────────────┴─────────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="47-create-edge-router-policy-and-public-edge-router">4.7 Create Edge Router Policy and Public Edge Router<a href="#47-create-edge-router-policy-and-public-edge-router" class="hash-link" aria-label="Direct link to 4.7 Create Edge Router Policy and Public Edge Router" title="Direct link to 4.7 Create Edge Router Policy and Public Edge Router">​</a></h2>
<p>The tunnelers need to connect to a public edge router to pass traffic as depicted in the <a href="#11-network-description">network diagram</a>.</p>
<ul>
<li>There should be at least one edge router with the role &quot;#public&quot;.</li>
<li>One policy (named &quot;allEdgeRouters&quot;) with &quot;edge router roles&quot; of &quot;#public&quot; and &quot;identity roles&quot; of &quot;#all&quot;.</li>
</ul>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬───────────────────────────┬────────┬───────────────┬──────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                      │ ONLINE │ ALLOW TRANSIT │ COST │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼───────────────────────────┼────────┼───────────────┼──────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xCW0lSWpcn │ LocalGWDemoNC-edge-router │ false  │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴───────────────────────────┴────────┴───────────────┴──────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-1 of 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list edge-router-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬───────────────────────────────┬────────────────────────────┬────────────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME                          │ EDGE ROUTER ROLES          │ IDENTITY ROLES             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼───────────────────────────────┼────────────────────────────┼────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 1obfCQ6vhYabkXb61DqjU  │ allEdgeRouters                │ #public                    │ #all                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xCW0lSWpcn             │ edge-router-xCW0lSWpcn-system │ @LocalGWDemoNC-edge-router │ @LocalGWDemoNC-edge-router │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴───────────────────────────────┴────────────────────────────┴────────────────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<p>If you need to create a public router, you can follow this guide: <a href="#a1-create-public-edge-router">Create Public Edge Router</a>. If you need to create an edge-router-policy, you can follow this guide: <a href="#a2-create-edge-router-policy">Create edge-router-policy</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="48-test-the-service">4.8 Test the service<a href="#48-test-the-service" class="hash-link" aria-label="Direct link to 4.8 Test the service" title="Direct link to 4.8 Test the service">​</a></h2>
<p>Connect to the Windows Client machine, open a cmd window.</p>
<p>First, try to <strong>nslookup mysimpleservice.ziti</strong>. This should resolve to a 100.64.0.* address.</p>
<p>Then you should be able ssh to mysimpleservice.ziti.</p>
<p><img decoding="async" loading="lazy" alt="Diagram" src="/assets/images/LocalGW31-523b26c9da45f0722f1fa19629707c90.png" width="463" height="478" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="50-http-service-configuration">5.0 http Service Configuration<a href="#50-http-service-configuration" class="hash-link" aria-label="Direct link to 5.0 http Service Configuration" title="Direct link to 5.0 http Service Configuration">​</a></h2>
<p>In the previous section, we showed how to configure a DNS based intercept via open-ziti. In this section, we going to show how to setup interception via IP address. If you followed the instruction in the <a href="#32-windows-client">3.2 Windows Client</a> section, the routing for the intercept traffic to local-tunnel node is ready set. (<em>route add 172.16.240.129 mask 255.255.255.255 172.16.31.175</em>)</p>
<p>We can log in to the controller to perform the configurations.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ssh &lt;user&gt;@68.183.139.122</span><br></span></code></pre></div></div>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">source ~/.ziti/quickstart/$(hostname -s)/$(hostname -s).env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zitiLogin</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="51-create-an-interceptv1-config">5.1 Create an intercept.v1 config<a href="#51-create-an-interceptv1-config" class="hash-link" aria-label="Direct link to 5.1 Create an intercept.v1 config" title="Direct link to 5.1 Create an intercept.v1 config">​</a></h2>
<p>Create intercept config on IP: 172.16.240.129 and port <strong>80</strong> for http traffic.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config http-intercept-config intercept.v1 &#x27;{&quot;protocols&quot;: [&quot;tcp&quot;], &quot;addresses&quot;: [&quot;172.16.240.129&quot;], &quot;portRanges&quot;: [{&quot;low&quot;: 80, &quot;high&quot;: 80}]}&#x27;</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="52-create-a-hostv1-config">5.2 Create a host.v1 config<a href="#52-create-a-hostv1-config" class="hash-link" aria-label="Direct link to 5.2 Create a host.v1 config" title="Direct link to 5.2 Create a host.v1 config">​</a></h2>
<p>Create Host config on IP: 172.16.240.129 and port <strong>8000</strong>. As you can see, we have redirected traffic intended for port 80 (from client) to port 8000 (on the host).</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config http-host-config host.v1 &#x27;{&quot;address&quot;:&quot;172.16.240.129&quot;, &quot;protocol&quot;:&quot;tcp&quot;, &quot;port&quot;:8000}&#x27;</span><br></span></code></pre></div></div>
<p>If the command finished successfully, you will see two more configs created, their names start with &quot;http&quot;:</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬───────────────────────┬──────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME                  │ CONFIG TYPE  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼───────────────────────┼──────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2U1aRwQCQMHTdrrPTkoafR │ ssh-host-config       │ host.v1      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 3raxTxDn1IRBKcgAEi5ZbM │ http-host-config      │ host.v1      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 6eduUGlPVvvqCruHc1V7Zd │ ssh-intercept-config  │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 7M6TQ3Rlw2XP6dI2fas7fC │ http-intercept-config │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴───────────────────────┴──────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-4 of 4</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="53-create-http-service">5.3 Create HTTP Service<a href="#53-create-http-service" class="hash-link" aria-label="Direct link to 5.3 Create HTTP Service" title="Direct link to 5.3 Create HTTP Service">​</a></h2>
<p>Put these two configs into a service. We going to name the service &quot;http&quot; and assign an attribute &quot;tun-hosted&quot;</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service http -c http-intercept-config,http-host-config -a tun-hosted</span><br></span></code></pre></div></div>
<p><strong>Check Service</strong></p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# ziti edge list services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────┬────────────┬─────────────────────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME │ ENCRYPTION │ TERMINATOR STRATEGY │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                        │      │  REQUIRED  │                     │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────┼────────────┼─────────────────────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 3OUoCk9Oo7xfOxaUZjhzUq │ http │ true       │ smartrouting        │ tun-hosted │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 4I7PmAQZ6GhTKkzTRhN0Ac │ ssh  │ true       │ smartrouting        │ tun-hosted │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────┴────────────┴─────────────────────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="54-service-edge-router-policy">5.4 Service Edge Router Policy<a href="#54-service-edge-router-policy" class="hash-link" aria-label="Direct link to 5.4 Service Edge Router Policy" title="Direct link to 5.4 Service Edge Router Policy">​</a></h2>
<p>Since we used the same role attribute for the HTTP service as the SSH service, we don&#x27;t need another service-edge-router-policy. The original service-edge-router-policy was done in <a href="#44-create-service-edge-router-policy">this section</a>.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="55-bind-and-dial-policies">5.5 Bind and Dial policies<a href="#55-bind-and-dial-policies" class="hash-link" aria-label="Direct link to 5.5 Bind and Dial policies" title="Direct link to 5.5 Bind and Dial policies">​</a></h2>
<p>We also do not need to create new Bind and Dial policies. Since our host identity (#hosts) and service attribute (#tun-hosted) did not change for bind policy, and our client identity (#clients) and service attribute (#tun-hosted) did not change for dial policy.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="56-test-the-service">5.6 Test the service<a href="#56-test-the-service" class="hash-link" aria-label="Direct link to 5.6 Test the service" title="Direct link to 5.6 Test the service">​</a></h2>
<p>Connect to the Windows client machine and open a web browser. Enter this address (<a href="http://172.16.240.129/hello.txt" target="_blank" rel="noopener noreferrer">http://172.16.240.129/hello.txt</a>). You should see the text we entered earlier on the <a href="#31-ubuntu-server">ubuntu server</a></p>
<p><img decoding="async" loading="lazy" alt="Diagram" src="data:image/png;base64,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" width="441" height="136" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="appendix">Appendix<a href="#appendix" class="hash-link" aria-label="Direct link to Appendix" title="Direct link to Appendix">​</a></h2>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a1-create-public-edge-router">A.1 Create Public Edge Router<a href="#a1-create-public-edge-router" class="hash-link" aria-label="Direct link to A.1 Create Public Edge Router" title="Direct link to A.1 Create Public Edge Router">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a11-create-edge-router">A.1.1 Create edge-router<a href="#a11-create-edge-router" class="hash-link" aria-label="Direct link to A.1.1 Create edge-router" title="Direct link to A.1.1 Create edge-router">​</a></h3>
<p>Create a VM (Ubuntu 22.04) on the public cloud. <strong>ssh</strong> into that machine.</p>
<p>Retrieve <strong>ziti_router_auto_enroll</strong> to set up your router.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">wget https://github.com/netfoundry/ziti_router_auto_enroll/releases/latest/download/ziti_router_auto_enroll.tar.gz</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tar xf ziti_router_auto_enroll.tar.gz</span><br></span></code></pre></div></div>
<p>You should have a file <strong>ziti_router_auto_enroll</strong> under the directory.</p>
<p>Get all the required information from the controller:</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# curl -s eth0.me</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">68.183.139.122  &lt;--- Controller IP</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# echo $ZITI_CTRL_ADVERTISED_PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8440  &lt;--- Controller Fabric Port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# echo $ZITI_CTRL_EDGE_ADVERTISED_PORT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">8441  &lt;--- Controller Management Port</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoNC:~# echo $ZITI_PWD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Test@123  &lt;--- Controller Passwd</span><br></span></code></pre></div></div>
<p>We are going to use Router Name: <strong>DemoPublicER</strong></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a12-enroll-edge-router">A.1.2 Enroll edge-router<a href="#a12-enroll-edge-router" class="hash-link" aria-label="Direct link to A.1.2 Enroll edge-router" title="Direct link to A.1.2 Enroll edge-router">​</a></h3>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ./ziti_router_auto_enroll -f -n --controller 68.183.139.122 --controllerFabricPort 8440 --controllerMgmtPort 8441 --adminUser admin --adminPassword Test@123 --disableHealthChecks --disableMetrics --assumePublic --routerName DemoPublicER</span><br></span></code></pre></div></div>
<p>Check to make sure ziti-router is running correctly</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoER:~# systemctl status ziti-router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">● ziti-router.service - Ziti-Router</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Loaded: loaded (/etc/systemd/system/ziti-router.service; enabled; vendor preset: enabled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Active: active (running) since Thu 2023-04-27 15:23:59 UTC; 2min 31s ago</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Main PID: 2894 (ziti)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tasks: 6 (limit: 2323)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Memory: 16.5M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CPU: 435ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     CGroup: /system.slice/ziti-router.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             └─2894 ziti router run /opt/ziti/config.yml</span><br></span></code></pre></div></div>
<p><strong>expected output:</strong> The status should show &quot;active (running)&quot;</p>
<p>Assign the attribute (#public) to the router. Here is how to do it from <strong>the router</strong>.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge login 68.183.139.122:8441 -u admin -p Test@123 -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge update edge-router DemoPublicER -a public</span><br></span></code></pre></div></div>
<p>Verify the router attribute got assigned correctly.</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoER:~# ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬───────────────────────────┬────────┬───────────────┬──────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                      │ ONLINE │ ALLOW TRANSIT │ COST │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼───────────────────────────┼────────┼───────────────┼──────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ hzb8uoeIY5 │ DemoPublicER              │ true   │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xCW0lSWpcn │ LocalGWDemoNC-edge-router │ false  │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴───────────────────────────┴────────┴───────────────┴──────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a13-set-up-ufw">A.1.3 Set up ufw<a href="#a13-set-up-ufw" class="hash-link" aria-label="Direct link to A.1.3 Set up ufw" title="Direct link to A.1.3 Set up ufw">​</a></h3>
<p>The following steps turn on the ufw firewall and opens the ports for this demo.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw enable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow 22/tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow 80/tcp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sudo ufw allow 443/tcp</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="a2-create-edge-router-policy">A.2 Create edge-router-policy<a href="#a2-create-edge-router-policy" class="hash-link" aria-label="Direct link to A.2 Create edge-router-policy" title="Direct link to A.2 Create edge-router-policy">​</a></h2>
<p>The edge-router-policy sets up the access point (Edge Routers) to the ziti fabric for the identities (Tunnelers).</p>
<p>There are many approaches on how to create policies to suit your need. For example, you may want to create policy for identities on the west coast to connect to ER in west coast. And policy for east coast identities to connect to east coast ER. But fine tuning edge-route-policy is beyond the scope of this demo. Here, we are going to show you a simple policy for all identities.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="a21-edge-router-policy-for-all-identities">A.2.1 edge-router-policy for all identities<a href="#a21-edge-router-policy-for-all-identities" class="hash-link" aria-label="Direct link to A.2.1 edge-router-policy for all identities" title="Direct link to A.2.1 edge-router-policy for all identities">​</a></h3>
<p>We will create an edge-router-policy for all identities to connect to public routers. Here is how to do it from the router.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge login 68.183.139.122:8441 -u admin -p Test@123 -y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create edge-router-policy demoEdgeRouterPolicy --edge-router-roles &#x27;#public&#x27; --identity-roles &#x27;#all&#x27;</span><br></span></code></pre></div></div>
<p>Check to make sure the policy was created correctly.</p>
<div class="language-buttonless codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-buttonless codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@LocalGWDemoER:~# ziti edge list edge-router-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬───────────────────────────────┬────────────────────────────┬────────────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME                          │ EDGE ROUTER ROLES          │ IDENTITY ROLES             │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼───────────────────────────────┼────────────────────────────┼────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2zFwqfbeCsVkR4PWP8ELuc │ demoEdgeRouterPolicy          │ #public                    │ #all                       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴───────────────────────────────┴────────────────────────────┴────────────────────────────╯</span><br></span></code></pre></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/topologies/20-gateway/tunneler.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-08-12T15:28:57.000Z" itemprop="dateModified">Aug 12, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guides/topologies/gateway/router"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Router</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/troubleshooting"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Troubleshooting</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#10-introduction" class="table-of-contents__link toc-highlight">1.0 Introduction</a></li><li><a href="#11-network-description" class="table-of-contents__link toc-highlight">1.1 Network Description</a></li><li><a href="#12-prerequisite" class="table-of-contents__link toc-highlight">1.2 Prerequisite</a></li><li><a href="#20-setup-tunnelers" class="table-of-contents__link toc-highlight">2.0 Setup Tunnelers</a></li><li><a href="#21-create-tunnelers-on-the-controller" class="table-of-contents__link toc-highlight">2.1 Create Tunnelers on the Controller</a></li><li><a href="#22-setup-the-tunneler-for-windows-subnet" class="table-of-contents__link toc-highlight">2.2 Setup the Tunneler For Windows Subnet</a><ul><li><a href="#221-register-identities" class="table-of-contents__link toc-highlight">2.2.1 Register Identities</a></li><li><a href="#222-set-up-ufw" class="table-of-contents__link toc-highlight">2.2.2 Set Up ufw</a></li><li><a href="#223-set-up-forwarding" class="table-of-contents__link toc-highlight">2.2.3 Set up Forwarding</a></li></ul></li><li><a href="#23-setup-the-tunneler-for-ubuntu-server-subnet" class="table-of-contents__link toc-highlight">2.3 Setup the Tunneler For Ubuntu Server Subnet</a><ul><li><a href="#231-register-identities" class="table-of-contents__link toc-highlight">2.3.1 Register Identities</a></li><li><a href="#232-set-up-ufw" class="table-of-contents__link toc-highlight">2.3.2 Set up ufw</a></li></ul></li><li><a href="#30-setup-client-and-server" class="table-of-contents__link toc-highlight">3.0 Setup Client and Server</a></li><li><a href="#31-ubuntu-server" class="table-of-contents__link toc-highlight">3.1 Ubuntu Server</a></li><li><a href="#32-windows-client" class="table-of-contents__link toc-highlight">3.2 Windows Client</a></li><li><a href="#40-ssh-service-configuration" class="table-of-contents__link toc-highlight">4.0 ssh Service Configuration</a></li><li><a href="#41-create-an-interceptv1-config" class="table-of-contents__link toc-highlight">4.1 Create an intercept.v1 config</a></li><li><a href="#42-create-a-hostv1-config" class="table-of-contents__link toc-highlight">4.2 Create a host.v1 config</a></li><li><a href="#43-create-ssh-service" class="table-of-contents__link toc-highlight">4.3 Create ssh Service</a></li><li><a href="#44-create-service-edge-router-policy" class="table-of-contents__link toc-highlight">4.4 Create Service Edge Router Policy</a></li><li><a href="#45-create-bind-policies" class="table-of-contents__link toc-highlight">4.5 Create Bind policies</a></li><li><a href="#46-create-dial-policies" class="table-of-contents__link toc-highlight">4.6 Create Dial policies</a></li><li><a href="#47-create-edge-router-policy-and-public-edge-router" class="table-of-contents__link toc-highlight">4.7 Create Edge Router Policy and Public Edge Router</a></li><li><a href="#48-test-the-service" class="table-of-contents__link toc-highlight">4.8 Test the service</a></li><li><a href="#50-http-service-configuration" class="table-of-contents__link toc-highlight">5.0 http Service Configuration</a></li><li><a href="#51-create-an-interceptv1-config" class="table-of-contents__link toc-highlight">5.1 Create an intercept.v1 config</a></li><li><a href="#52-create-a-hostv1-config" class="table-of-contents__link toc-highlight">5.2 Create a host.v1 config</a></li><li><a href="#53-create-http-service" class="table-of-contents__link toc-highlight">5.3 Create HTTP Service</a></li><li><a href="#54-service-edge-router-policy" class="table-of-contents__link toc-highlight">5.4 Service Edge Router Policy</a></li><li><a href="#55-bind-and-dial-policies" class="table-of-contents__link toc-highlight">5.5 Bind and Dial policies</a></li><li><a href="#56-test-the-service" class="table-of-contents__link toc-highlight">5.6 Test the service</a></li><li><a href="#appendix" class="table-of-contents__link toc-highlight">Appendix</a></li><li><a href="#a1-create-public-edge-router" class="table-of-contents__link toc-highlight">A.1 Create Public Edge Router</a><ul><li><a href="#a11-create-edge-router" class="table-of-contents__link toc-highlight">A.1.1 Create edge-router</a></li><li><a href="#a12-enroll-edge-router" class="table-of-contents__link toc-highlight">A.1.2 Enroll edge-router</a></li><li><a href="#a13-set-up-ufw" class="table-of-contents__link toc-highlight">A.1.3 Set up ufw</a></li></ul></li><li><a href="#a2-create-edge-router-policy" class="table-of-contents__link toc-highlight">A.2 Create edge-router-policy</a><ul><li><a href="#a21-edge-router-policy-for-all-identities" class="table-of-contents__link toc-highlight">A.2.1 edge-router-policy for all identities</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="ozLayoutFooter_Elxg ozFooter_Avh_"><section class="footer_TVlg ozHorizontalSectionRoot_MIa6 ozhsContent_Tzp1"><div class="footerContainer_otJT"><div class="footerGrid_DfDa"><div class="footerColumn_aKLl"><h3>OpenZiti</h3><p>An open source project enabling developers to embed zero trust networking directly into applications.</p><div class="footerSocialLinks_HWin"><a href="https://github.com/openziti/ziti" target="_blank" class="footerSocialLink_t5Hs"><svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a><a href="https://www.linkedin.com/company/netfoundry" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 16V10.1C15.996 7.5 15.375 5.49999 12.025 5.49999C10.4 5.49999 9.325 6.39999 8.875 7.29999H8.825V5.79999H5.65V16H8.95V10.7C8.95 9.30001 9.2 7.9 10.925 7.9C12.65 7.9 12.675 9.59999 12.675 10.8V16H15.996Z"></path><path d="M0.25 5.79999H3.575V16H0.25V5.79999Z"></path><path d="M1.9 0C0.85 0 0 0.85 0 1.9C0 2.95 0.85 3.8 1.9 3.8C2.95 3.8 3.8 2.95 3.8 1.9C3.8 0.85 2.95 0 1.9 0Z"></path></svg></a><a href="https://www.youtube.com/OpenZiti" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.969 4.69c-.183-1.358-1.062-2.275-2.361-2.46C12.371 2 8 2 8 2S3.629 2 2.362 2.229c-1.3.186-2.179 1.103-2.361 2.461C0 6.03 0 10 0 10s0 3.97.2 5.31c.183 1.358 1.062 2.275 2.361 2.46C3.63 18 8 18 8 18s4.371 0 5.638-.23c1.3-.185 2.178-1.102 2.361-2.46.2-1.34.2-5.31.2-5.31s0-3.97-.23-5.31zm-8.36, 8.57V6.73l3.76 2.27-3.76 2.26z"></path></svg></a><a href="https://x.com/OpenZiti" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 3.038c-.59.262-1.219.44-1.885.52.677-.406 1.194-1.05 1.438-1.815-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.038-2.396-1.038-1.813 0-3.283 1.469-3.283 3.282 0 .257.03.507.085.748-2.728-.137-5.147-1.445-6.766-3.43-.282.485-.444 1.05-.444 1.651 0 1.14.58 2.143 1.46 2.732-.538-.017-1.044-.164-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.219-.276.075-.567.116-.866.116-.211 0-.416-.021-.617-.06.418 1.304 1.63 2.254 3.066 2.28-1.124.883-2.539 1.406-4.077 1.406-.265 0-.526-.015-.785-.046 1.453.933 3.178 1.475 5.032 1.475 6.038 0 9.34-5.002 9.34-9.34 0-.142-.004-.284-.01-.425.641-.463 1.198-1.039 1.638-1.696"></path></svg></a></div></div><div class="footerColumn_aKLl"><h3>Documentation</h3><ul class="footerLinks_fOY0"><li><a href="/docs/learn/quickstarts/services/ztha">Getting Started</a></li><li><a href="/docs/reference/developer/api/">API Reference</a></li><li><a href="/docs/reference/developer/sdk/">SDK Integration</a></li></ul></div><div class="footerColumn_aKLl"><h3>Community</h3><ul class="footerLinks_fOY0"><li><a href="https://github.com/openziti/ziti">GitHub</a></li><li><a href="https://openziti.discourse.group/">Discourse Forum</a></li><li><a href="/policies/CONTRIBUTING">Contributing</a></li></ul></div><div class="footerColumn_aKLl"><h3>Resources</h3><ul class="footerLinks_fOY0"><li><a href="https://blog.openziti.io">Blog</a></li><li><a href="https://netfoundry.io/">NetFoundry</a></li></ul></div></div></div><div class="footerCopyright_W7lP"><p>© 2025 NetFoundry Inc. OpenZiti is an open source project sponsored by NetFoundry. All rights reserved.</p></div></section></footer></div></div>
</body>
</html>