<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/hsm/softhsm" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">SoftHSMv2 | OpenZiti</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://openziti.io/docs/guides/hsm/softhsm"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="robots" content="index, follow"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="SoftHSMv2 | OpenZiti"><meta data-rh="true" name="description" content="Overview"><meta data-rh="true" property="og:description" content="Overview"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://openziti.io/docs/guides/hsm/softhsm"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/guides/hsm/softhsm" hreflang="en"><link data-rh="true" rel="alternate" href="https://openziti.io/docs/guides/hsm/softhsm" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Hardware Keys","item":"https://openziti.io/docs/guides/hsm/"},{"@type":"ListItem","position":2,"name":"SoftHSMv2","item":"https://openziti.io/docs/guides/hsm/softhsm"}]}</script><link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-5SF399H3",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>





<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml">

<script>!function(t,h,e,j,s,n){t.hj=t.hj||function(){(t.hj.q=t.hj.q||[]).push(arguments)},t._hjSettings={hjid:3576473,hjsv:6},s=h.getElementsByTagName("head")[0],(n=h.createElement("script")).async=1,n.src="https://static.hotjar.com/c/hotjar-"+t._hjSettings.hjid+".js?sv="+t._hjSettings.hjsv,s.appendChild(n)}(window,document)</script><link rel="stylesheet" href="/assets/css/styles.ce83f6e0.css">
<script src="/assets/js/runtime~main.e5d232e7.js" defer="defer"></script>
<script src="/assets/js/main.1141b64d.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5SF399H3" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>




<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/ziti-logo-dark.svg"><link rel="preload" as="image" href="/img/ziti-logo-light.svg"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="starUsRoot_Cir2"><span style="color:whitesmoke">Star us on GitHub </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a href="https://openziti.io" target="_self" rel="noopener noreferrer" class="navbar__brand"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/ziti-logo-light.svg" alt="The OpenZiti logo, an open source zero trust network overlay" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate"></b></a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://netfoundry.io/products/netfoundry-cloud-30-day-free-trial/" target="_blank">NetFoundry</a></div><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/downloads">Downloads</a><div class="navbar__item"><a class="navbar__item navbar__link header-netfoundry-link" href="https://blog.openziti.io/" target="_blank">Blog</a></div><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li class=""><div class="text-divider"><p>Socials</p></div></li><li class=""><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/yt.svg" alt="YouTube logo">YouTube</span></a></li><li class=""><a href="https://x.com/OpenZiti" target="_blank" title="OpenZiti on X(formerly Twitter)"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/twit.svg" alt="X/Twitter logo">X (Twitter)</span></a></li><li class=""><a href="https://www.reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/reddit-logo.png" alt="Reddit logo">Reddit</span></a></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/ziggy.png" alt="X/Twitter Ziggy logo"><a href="https://x.com/OpenZiggy" target="_blank" title="OpenZiggy on X(formerly Twitter)">Ziggy</a></span></li><li class=""><div class="text-divider"><p>Other</p></div></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/blog-icon.png" alt="OpenZiti blog logo"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li class=""><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/oz-test-kitchen.png" alt="OpenZiti Test Kitchen logo"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper ozLayoutMainWrapper_maOX"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/learn/introduction/">LEARN</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/introduction/">What is OpenZiti?</a><button aria-label="Expand sidebar category &#x27;What is OpenZiti?&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/learn/quickstarts/">Quickstarts</a><button aria-label="Expand sidebar category &#x27;Quickstarts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/core-concepts">Core Concepts</a><button aria-label="Expand sidebar category &#x27;Core Concepts&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/learn/identity-providers/">Identity Providers</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/reference/">REFERENCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/configuration/conventions">Configuration</a><button aria-label="Expand sidebar category &#x27;Configuration&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/reference/ha/overview">Controller Clustering</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/tunnelers/">Tunnelers</a><button aria-label="Expand sidebar category &#x27;Tunnelers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/command-line/login">CLI</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/logging">Logging</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/config-types/">Config Types</a><button aria-label="Expand sidebar category &#x27;Config Types&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/events">Events</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/reference/developer/">Developer</a><button aria-label="Expand sidebar category &#x27;Developer&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/guides/">GUIDES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/deployments">Deployments</a><button aria-label="Expand sidebar category &#x27;Deployments&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/guides/external-auth/">Configuring OIDC</a><button aria-label="Expand sidebar category &#x27;Configuring OIDC&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/guides/hsm/">Hardware Keys</a><button aria-label="Collapse sidebar category &#x27;Hardware Keys&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/hsm/softhsm">SoftHSMv2</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/hsm/yubikey">YubiKey by Yubico</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/topologies">Topologies</a><button aria-label="Expand sidebar category &#x27;Topologies&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Expand sidebar category &#x27;Troubleshooting&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/guides/hsm/"><span>Hardware Keys</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">SoftHSMv2</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>SoftHSMv2</h1></header>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overview">Overview<a href="#overview" class="hash-link" aria-label="Direct link to Overview" title="Direct link to Overview">​</a></h2>
<p><a href="https://www.opendnssec.org/en/latest/softhsm/" target="_blank" rel="noopener noreferrer">SoftHSMv2</a> is a purely software-based implementation of PKCS#11. Because it is
software it is not as secure as a physical HSM but it is very useful to explore the world of PKCS#11 and how it can be
used with a Ziti-enabled client.</p>
<p>In this quickstart you will see the commands used to work with SoftHSMv2 and ziti. Since this is a quickstart limited
context will be provided for each step. When appropriate there will be a small amount of context included to aid in
understanding of what is happening and why.</p>
<div class="theme-admonition theme-admonition-caution admonition_xJq3 alert alert--warning"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_BuS1"><p>This quickstart intended audience is for more technically savvy individuals. You will need to be familiar with the command
line interface of your operating system.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="prerequisites">Prerequisites<a href="#prerequisites" class="hash-link" aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites">​</a></h2>
<ul>
<li><a href="https://www.opendnssec.org/en/latest/softhsm/" target="_blank" rel="noopener noreferrer">SoftHSMv2</a> is downloaded and installed in a known location</li>
<li><a href="https://github.com/OpenSC/OpenSC/wiki" target="_blank" rel="noopener noreferrer">OpenSC</a> is installed and <code>pkcs11-tool</code> is either on the PATH or at a known
location</li>
<li>ziti and ziti-tunnel are both on the path.</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="lets-do-this---softhsmv2">Let&#x27;s Do This - SoftHSMv2<a href="#lets-do-this---softhsmv2" class="hash-link" aria-label="Direct link to Let&#x27;s Do This - SoftHSMv2" title="Direct link to Let&#x27;s Do This - SoftHSMv2">​</a></h2>
<p>Here&#x27;s the list of steps we&#x27;ll accomplish in this quickstart:</p>
<ul>
<li>Establish a bunch of environment variables to make it easy to copy/paste the other commands. You&#x27;ll want to <em>look at
these environment variables</em>. They need to be setup properly. If you have problems with this guide it is almost
certainly because you have an environment variable setup incorrectly. Double check them.</li>
<li>Make a directory and generate a configuration file for SoftHSM</li>
<li>Use the <a href="https://github.com/openziti/ziti/releases/latest" target="_blank" rel="noopener noreferrer">Ziti CLI</a> to:<!-- -->
<ul>
<li>create two identities - one demonstrating an RSA key, one EC</li>
<li>enroll the identities</li>
<li>create a test service</li>
<li>create test router/service policies</li>
</ul>
</li>
<li>Use the pkcs11-tool provided by OpenSC to interact with SoftHSM to:<!-- -->
<ul>
<li>initialize the SoftHSM driver</li>
<li>create a key</li>
</ul>
</li>
<li>Use <code>ziti-tunnel</code> to enroll the identities using SoftHSM</li>
<li>Use <code>ziti-tunnel</code> in proxy mode to verify things are working and traffic is flowing over the network</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="establish-environment-variables">Establish Environment Variables<a href="#establish-environment-variables" class="hash-link" aria-label="Direct link to Establish Environment Variables" title="Direct link to Establish Environment Variables">​</a></h3>
<p>Open a command line and establish the following environment variables.</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    # the name of the ziti controller you&#x27;re logging into</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export ZITI_CTRL=local-edge-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the location of the certificate(s) to use to validate the controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export ZITI_CTRL_CERT=/path/to/controller.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export ZITI_USER=myUserName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export ZITI_PWD=myPassword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # a name for the configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_NAME=softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the path to the root of the softhsm config files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_ROOT=/home/cd/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # path to the softhsm2 library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export PKCS11_MODULE=/usr/local/lib/softhsm/libsofthsm2.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the id of the key - you probably want to leave these alone unless you know better</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_ID1=01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_ID2=02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # the pins used when accessing the pkcs11 api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_SOPIN=1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_PIN=2222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export RSA_ID=${HSM_NAME}${HSM_ID1}_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export EC_ID=${HSM_NAME}${HSM_ID2}_ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # location for the config file and tokens to be placed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_DEST=${HSM_ROOT}/${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_LABEL=${HSM_NAME}-label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export SOFTHSM2_CONF=${HSM_DEST}/softhsm.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    export HSM_TOKENS_DIR=&quot;${HSM_DEST}/tokens/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # make an alias for ease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    alias p=&#x27;pkcs11-tool --module $PKCS11_MODULE&#x27;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><p>Ensure you use the correct dll. If you use an x86 dll with x64 binaries you&#x27;ll get an error.</p><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    REM the name of the ziti controller you&#x27;re logging into</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET ZITI_CTRL=local-edge-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM the location of the certificate(s) to use to validate the controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET ZITI_CTRL_CERT=c:\path\to\controller.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET ZITI_USER=myUserName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET ZITI_PWD=myPassword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM a name for the configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_NAME=softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM the path to the root of the softhsm config files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_ROOT=c:\path\to\softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM path to the softhsm2 library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET PKCS11_MODULE=%HSM_ROOT%\lib\softhsm2.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    --- or ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET PKCS11_MODULE=%HSM_ROOT%\lib\softhsm2-x64.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM the id of the key - you probably want to leave these alone unless you know better</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_ID1=01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_ID2=02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET RSA_ID=%HSM_NAME%%HSM_ID1%_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET EC_ID=%HSM_NAME%%HSM_ID2%_ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM the pins used when accessing the pkcs11 api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_SOPIN=1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_PIN=2222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_DEST=%HSM_ROOT%\%HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_LABEL=%HSM_NAME%-label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET SOFTHSM2_CONF=%HSM_DEST%\softhsm.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET HSM_TOKENS_DIR=%HSM_DEST%\tokens\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM make an alias for ease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    doskey p=&quot;c:\Program Files\OpenSC Project\OpenSC\tools\pkcs11-tool.exe&quot; --module %PKCS11_MODULE% $*</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="make-directories-and-generate-config-files">Make Directories and Generate Config Files<a href="#make-directories-and-generate-config-files" class="hash-link" aria-label="Direct link to Make Directories and Generate Config Files" title="Direct link to Make Directories and Generate Config Files">​</a></h3>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    cd ${HSM_ROOT}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rm -rf ${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mkdir -p ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd ${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Create a text file at ${SOFTHSM2_CONF} with these contents but make sure you replace the tokendir entry with ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cat &gt; ${SOFTHSM2_CONF} &lt;&lt;HERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # SoftHSM v2 configuration file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    directories.tokendir = ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectstore.backend = file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ERROR, WARNING, INFO, DEBUG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.level = INFO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # If CKF_REMOVABLE_DEVICE flag should be set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slots.removable = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Enable and disable PKCS#11 mechanisms using slots.mechanisms.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slots.mechanisms = ALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    HERE</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    cd /d %HSM_ROOT%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    rmdir /s /q %HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mkdir %HSM_TOKENS_DIR%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd /d %HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Create a text file at %SOFTHSM2_CONF% with these contents but make sure you replace the tokendir entry with %HSM_TOKENS_DIR%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    echo ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # SoftHSM v2 configuration file ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    directories.tokendir = %HSM_TOKENS_DIR% ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectstore.backend = file ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ERROR, WARNING, INFO, DEBUG ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.level = INFO ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # If CKF_REMOVABLE_DEVICE flag should be set ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slots.removable = false ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Enable and disable PKCS#11 mechanisms using slots.mechanisms. ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slots.mechanisms = ALL &gt; %SOFTHSM2_CONF%</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-the-ziti-cli">Use the Ziti CLI<a href="#use-the-ziti-cli" class="hash-link" aria-label="Direct link to Use the Ziti CLI" title="Direct link to Use the Ziti CLI">​</a></h3>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge login $ZITI_CTRL:1280 -u $ZITI_USER -p $ZITI_PWD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;${RSA_ID}&quot; -o &quot;${HSM_DEST}/${RSA_ID}.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a second new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;${EC_ID}&quot; -o &quot;${HSM_DEST}/${EC_ID}.jwt&quot;</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge login %ZITI_CTRL%:1280 -u %ZITI_USER% -p %ZITI_PWD%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM create a new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;%RSA_ID%&quot; -o &quot;%HSM_DEST%\%RSA_ID%.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM create a second new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;%EC_ID%&quot; -o &quot;%HSM_DEST%\%EC_ID%.jwt&quot;</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-pkcs11-tool-to-setup-softhsmv2">Use pkcs11-tool to Setup SoftHSMv2<a href="#use-pkcs11-tool-to-setup-softhsmv2" class="hash-link" aria-label="Direct link to Use pkcs11-tool to Setup SoftHSMv2" title="Direct link to Use pkcs11-tool to Setup SoftHSMv2">​</a></h3>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    p --init-token --label &quot;ziti-test-token&quot; --so-pin $HSM_SOPIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a couple of keys - one rsa and one ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p $HSM_PIN -k --key-type rsa:2048 --id &quot;${HSM_ID1}&quot; --label ziti-rsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p $HSM_PIN -k --key-type EC:prime256v1 --id ${HSM_ID2} --label ziti-ecdsa-key --usage-sign --usage-decrypt</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    p --init-token --label &quot;ziti-test-token&quot; --so-pin %HSM_SOPIN%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p --init-pin --pin &quot;%HSM_PIN%&quot; --so-pin %HSM_SOPIN%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM create a couple of keys - one rsa and one ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p &quot;%HSM_PIN%&quot; -k --key-type rsa:2048 --id &quot;%HSM_ID1%&quot; --label ziti-rsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p &quot;%HSM_PIN%&quot; -k --key-type EC:prime256v1 --id &quot;%HSM_ID2%&quot; --label ziti-ecdsa-key --usage-sign --usage-decrypt</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-ziti-tunnel-to-enroll-the-identities">Use ziti-tunnel to Enroll the Identities<a href="#use-ziti-tunnel-to-enroll-the-identities" class="hash-link" aria-label="Direct link to Use ziti-tunnel to Enroll the Identities" title="Direct link to Use ziti-tunnel to Enroll the Identities">​</a></h3>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel enroll -j &quot;${HSM_DEST}/${RSA_ID}.jwt&quot; -k &quot;pkcs11://${PKCS11_MODULE}?id=${HSM_ID1}&amp;pin=${HSM_PIN}&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel enroll -j &quot;${HSM_DEST}/${EC_ID}.jwt&quot; -k &quot;pkcs11://${PKCS11_MODULE}?id=${HSM_ID2}&amp;pin=${HSM_PIN}&quot; -v</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel enroll -j &quot;%HSM_DEST%\%RSA_ID%.jwt&quot; -k &quot;pkcs11://%PKCS11_MODULE%?id=%HSM_ID1%&amp;pin=%HSM_PIN%&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel enroll -j &quot;%HSM_DEST%\%EC_ID%.jwt&quot; -k &quot;pkcs11://%PKCS11_MODULE%?id=%HSM_ID2%&amp;pin=%HSM_PIN%&quot; -v</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-ziti-tunnel-to-verify-things-work">Use ziti-tunnel to Verify Things Work<a href="#use-ziti-tunnel-to-verify-things-work" class="hash-link" aria-label="Direct link to Use ziti-tunnel to Verify Things Work" title="Direct link to Use ziti-tunnel to Verify Things Work">​</a></h3>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    # if you only have a single edge router this command will work without the need for copy/paste</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EDGE_ROUTER_ID=$(ziti edge list edge-routers | cut -d &quot; &quot; -f2)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # IF the above command doesn&#x27;t work - run this command and get the id from the first edge-router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # then use the id returned from the above command and put it into a variable for use in a moment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # EDGE_ROUTER_ID={insert the &#x27;id&#x27; from above - example: 64d4967b-5474-4f06-8548-5700ed7bfa80}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # remove/recreate the config - here we&#x27;ll be instructing the tunneler to listen on localhost and port 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge delete config wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create config wttrconfig ziti-tunneler-client.v1 &quot;{ \&quot;hostname\&quot; : \&quot;localhost\&quot;, \&quot;port\&quot; : 9000 }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # recreate the service with the EDGE_ROUTER_ID from above. Here we are adding a ziti service that will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # send a request to wttr.in to retrieve a weather forecast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge delete service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create service wttr.ziti &quot;${EDGE_ROUTER_ID}&quot; tcp://wttr.in:80 --configs wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # start one or both proxies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # use a browser - or curl to verify the ziti tunneler is listening locally and the traffic has flowed over the ziti network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -H &quot;Host: wttr.in&quot; http://localhost:8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -H &quot;Host: wttr.in&quot; http://localhost:9000</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    REM these two commands can&#x27;t be copied and pasted - you need to get the result of the first command and use it in the next</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM run this command and get the id from the first edge-router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM use the id returned from the above command and put it into a variable for use in a moment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    SET EDGE_ROUTER_ID={insert the &#x27;id&#x27; from above - example: 64d4967b-5474-4f06-8548-5700ed7bfa80}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM remove/recreate the config - here we&#x27;ll be instructing the tunneler to listen on localhost and port 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge delete config wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create config wttrconfig ziti-tunneler-client.v1 &quot;{ \&quot;hostname\&quot; : \&quot;localhost\&quot;, \&quot;port\&quot; : 9000 }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM recreate the service with the EDGE_ROUTER_ID from above. Here we are adding a ziti service that will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM send a request to wttr.in to retrieve a weather forecast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge delete service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create service wttr.ziti &quot;%EDGE_ROUTER_ID%&quot; tcp://wttr.in:80 --configs wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM start one or both proxies - use ctrl-break or ctrl-pause to terminate these processes </span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start /b ziti-tunnel proxy -i &quot;%HSM_DEST%/%RSA_ID%.json&quot; wttr.ziti:8000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start /b ziti-tunnel proxy -i &quot;%HSM_DEST%/%EC_ID%.json&quot; wttr.ziti:9000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM use a browser - or curl to verify the ziti tunneler is listening locally and the traffic has flowed over the ziti network</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -H &quot;Host: wttr.in&quot; http://localhost:8000 &gt; &quot;%HSM_DEST%\example_%RSA_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -H &quot;Host: wttr.in&quot; http://localhost:9000 &gt; &quot;%HSM_DEST%\example_%EC_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM show the results in the console</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type &quot;%HSM_DEST%\example_%RSA_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    type &quot;%HSM_DEST%\example_%EC_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    REM ctrl-break or ctrl-pause to kill the tunnelers</span><br></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="putting-it-all-together">Putting It All Together<a href="#putting-it-all-together" class="hash-link" aria-label="Direct link to Putting It All Together" title="Direct link to Putting It All Together">​</a></h3>
<p>Above we&#x27;ve only shown the commands that need to run and not what the output of those commands would look like. Here
we&#x27;ll see all the commands put together along with all the output from the commands. This section is long - you are
warned! Also note that this content is subject to change. If the output you see is not identical it&#x27;s because the
software has changed since this information was captured. File an <a href="https://github.com/openziti/ziti-doc/issues" target="_blank" rel="noopener noreferrer">issue</a>
if you&#x27;d like to see it updated.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sample-output">Sample Output<a href="#sample-output" class="hash-link" aria-label="Direct link to Sample Output" title="Direct link to Sample Output">​</a></h2>
<p>The tabs to the right contain example output from running all the commands in sequence. If you want to see what the
output would likely look like click one of the tabs to the right. Reminder - it&#x27;s a lot of commands and a lot of output!
:)</p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Linux/MacOS</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Windows</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # the name of the ziti controller you&#x27;re logging into</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export ZITI_CTRL=local-edge-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # the location of the certificate(s) to use to validate the controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export ZITI_CTRL_CERT=/path/to/controller.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export ZITI_USER=myUserName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export ZITI_PWD=myPassword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # a name for the configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_NAME=softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # the path to the root of the softhsm config files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_ROOT=/home/cd/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # location for the config file and tokens to be placed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_DEST=${HSM_ROOT}/${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # path to the softhsm2 library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export PKCS11_MODULE=/usr/local/lib/softhsm/libsofthsm2.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # the id of the key - you probably want to leave these alone unless you know better</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_ID1=01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_ID2=02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # the pins used when accessing the pkcs11 api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_SOPIN=1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_PIN=2222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export RSA_ID=${HSM_NAME}${HSM_ID1}_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export EC_ID=${HSM_NAME}${HSM_ID2}_ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_DEST=${HSM_ROOT}/${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export SOFTHSM2_CONF=${HSM_DEST}/softhsm.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_LABEL=${HSM_NAME}-label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ export HSM_TOKENS_DIR=&quot;${HSM_DEST}/tokens/&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # make an alias for ease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ alias p=&#x27;pkcs11-tool --module $PKCS11_MODULE&#x27;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ cd ${HSM_ROOT}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ rm -rf ${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    mkdir -p ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd ${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # Create a text file at ${SOFTHSM2_CONF} with these contents but make sure you replace the tokendir entry with ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cat &gt; ${SOFTHSM2_CONF} &lt;&lt;HERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # SoftHSM v2 configuration file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    directories.tokendir = ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    objectstore.backend = file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # ERROR, WARNING, INFO, DEBUG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    log.level = INFO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ mkdir -p ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # If CKF_REMOVABLE_DEVICE flag should be set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    slots.removable = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ cd ${HSM_NAME}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # Create a text file at ${SOFTHSM2_CONF} with these contents but make sure you replace the tokendir entry with ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ cat &gt; ${SOFTHSM2_CONF} &lt;&lt;HERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; # SoftHSM v2 configuration file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; directories.tokendir = ${HSM_TOKENS_DIR}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; objectstore.backend = file</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; # ERROR, WARNING, INFO, DEBUG</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; log.level = INFO</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; # If CKF_REMOVABLE_DEVICE flag should be set</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; slots.removable = false</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; # Enable and disable PKCS#11 mechanisms using slots.mechanisms.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; slots.mechanisms = ALL</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt; HERE</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge login $ZITI_CTRL:1280 -u $ZITI_USER -p $ZITI_PWD</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;${RSA_ID}&quot; -o &quot;${HSM_DEST}/${RSA_ID}.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a second new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create identity &quot;${EC_ID}&quot; -o &quot;${HSM_DEST}/${EC_ID}.jwt&quot;Token: 28da1089-1636-4e6b-b5c7-96edc8d6162f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # create a new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge create identity &quot;${RSA_ID}&quot; -o &quot;${HSM_DEST}/${RSA_ID}.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    dbf953bc-a987-4a89-a93d-0d6dac13150f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Enrollment expires at 2020-02-23T13:31:35.306053182Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # create a second new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge create identity &quot;${EC_ID}&quot; -o &quot;${HSM_DEST}/${EC_ID}.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cfffe40d-b859-4a5a-ab4f-c9621a57ec85</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Enrollment expires at 2020-02-23T13:31:36.676560457Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ p --init-token --label &quot;ziti-test-token&quot; --so-pin $HSM_SOPIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # create a couple of keys - one rsa and one ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p $HSM_PIN -k --key-type rsa:2048 --id &quot;${HSM_ID1}&quot; --label ziti-rsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    p -p $HSM_PIN -k --key-type EC:prime256v1 --id ${HSM_ID2} --label ziti-ecdsa-key --usage-sign --usage-decryptUsing slot 0 with a present token (0x0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Token successfully initialized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ p --init-pin --pin $HSM_PIN --so-pin $HSM_SOPIN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x7f834e53)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User PIN successfully initialized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # create a couple of keys - one rsa and one ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ p -p $HSM_PIN -k --key-type rsa:2048 --id &quot;${HSM_ID1}&quot; --label ziti-rsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x7f834e53)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Key pair generated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Key Object; RSA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-rsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      decrypt, sign, unwrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Public Key Object; RSA 2048 bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-rsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      encrypt, verify, wrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ p -p $HSM_PIN -k --key-type EC:prime256v1 --id ${HSM_ID2} --label ziti-ecdsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x7f834e53)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Key pair generated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Key Object; EC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-ecdsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      decrypt, sign, unwrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Public Key Object; EC  EC_POINT 256 bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EC_POINT:   0441046f9ae0bbc3cbe62e6bbad50ad673add3ba1ee5a07f5391893df956c53d67c62b727ca1004fe9b44027e8e1f1605a602946257b1b1d20ba00342cec85c13a0462</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EC_PARAMS:  06082a8648ce3d030107</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-ecdsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      encrypt, verify, wrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti-tunnel enroll -j &quot;${HSM_DEST}/${RSA_ID}.jwt&quot; -k &quot;pkcs11:///${PKCS11_MODULE}?id=${HSM_ID1}&amp;pin=${HSM_PIN}&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] jwt to parse: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbSI6Im90dCIsImV4cCI6MTU4MjQ2NDY5NSwiaXNzIjoiaHR0cHM6Ly9sb2NhbC1lZGdlLWNvbnRyb2xsZXI6MTI4MCIsImp0aSI6IjIzOTNjNDgwLTc0NGMtNDc3OS05NjU3LWNhOTdlMzUzOWQ0ZiIsInN1YiI6ImRiZjk1M2JjLWE5ODctNGE4OS1hOTNkLTBkNmRhYzEzMTUwZiJ9.OucLqJYgvGO0zov3ADI4oM0i0CASfpD6GUUAck5cBKVJqUN8jsdHe272CwnR7TH1w7uUNr5zPDJnwklVRQ0kzgxqFe9lGqNOxKtYecr-oI50K-J_OShPu_LkJ8dpmUk-OEzc1mq29KsIVu9GLUI43FLYD7SWFZZFsYk6iB8H4PPRrUNZucTcApgNNHljlwl8n-my5N3STqazJf7YUIHOh-OiW8rJFXZYf5gri_B6uDGQo-ZcMOISWCTRjPxe2boHK0ymrUanbe_i9vHbOQRIik7J6xOEA2-Vu-QW9WY4bEvl0_LChdV4YBG09EtWsJndl1AIsD0AP0fCjgD6FifAbpmiZx_YoqOM-KCbN9Vts9_FobNfT0rt9s7RzcHImj22jxEQtSNVbrjnulPwzhBM2PnOKrHJtq8KGgsGlC-aC1pUkiRS-eMHDOshDUFk16p56UXm9QS4d1rPmCQ8yksgEdeurRydmBKCr2tr1v9hC7gSxY1sOBF-b9k7HBGuinomuyeF6CRRMRYMiYz26suZXvP70ufJ5Z2h6hYqvIIGtpk_MxMuVl8r9iylWq3P7oqbDo74g3p3OSFwRUDm5llBuZKJUzQXYE3435NdpHeStKu4K2VYvGGCxpWe950ONrAGzwSYtYdOVvkgGxBreO3RNiQN427XD9yZw66pXXqIRV0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using engine : pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] loading key                                   context=pkcs11 url=&quot;pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=01&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using driver: //usr/local/lib/softhsm/libsofthsm2.so  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] slot not specified, using first slot reported by the driver (2139311699)  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] found signing mechanism                       context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] no cas provided in caPool. using system provided cas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] fetching certificates from server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] loading key                                   context=pkcs11 url=&quot;pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=01&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using driver: //usr/local/lib/softhsm/libsofthsm2.so  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] slot not specified, using first slot reported by the driver (2139311699)  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] found signing mechanism                       context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enrolled successfully. identity file written to: /home/cd/.softhsm/softhsm_demo/softhsm_demo01_rsa.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti-tunnel enroll -j &quot;${HSM_DEST}/${EC_ID}.jwt&quot; -k &quot;pkcs11:///${PKCS11_MODULE}?id=${HSM_ID2}&amp;pin=${HSM_PIN}&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] jwt to parse: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbSI6Im90dCIsImV4cCI6MTU4MjQ2NDY5NiwiaXNzIjoiaHR0cHM6Ly9sb2NhbC1lZGdlLWNvbnRyb2xsZXI6MTI4MCIsImp0aSI6ImJlZTJlY2U3LTE4ZTAtNGQ3Zi04NmRlLTU4NmM5MTAyNDY3YiIsInN1YiI6ImNmZmZlNDBkLWI4NTktNGE1YS1hYjRmLWM5NjIxYTU3ZWM4NSJ9.nRCE-_osr6rdVUcfyR-irvAWitCSK0pm7WaG0hOC0-O22SFs8tYw7uKvbGmNkFoVsUYK4y6A4X77Q6JPNPDIzwWl1TO788B4UiJNh6x5jFEKMawzzPbq-wGq0PLstLsULOryxRtIMdHRYaCrxspC9mIZTrIWe85iPPjirOJ0Pgq0-Li2hZmBtlFOh8zTzYGmXVQtKhA-obIDSa12Nrt6gpgpNl1Ob_EXWWkwC5rcdm4yKpiKx7wYjxBRKc4ZLODmNahe69KiG5XD9A5I5o6YWQDs-pgl3Op44U9Kk94fGSZPcgzkPUC8NaX1eWgYh6RCMs3uSp6TMi8bRisPCOW770K3CxPpCS1fKg9rpyPninFShjRMvsbf999ldWh3YKmLJXvtinQF3szbmCsVaTI4-NxlkhLcdL2Qo6ivLz_kddNfzmDFcOEcLerR0D_Ugt0mPi0RidgkX0J00uXqd1SqYyI3b68KyVd5U3hIoL8NRQ1gAluky0jSe-xj5vfTgxYiJNZlUqCA4DvGdXl98NiWu40eHEz5ksKePbB_LVCmcMW3mPNdQjmDw4fdKvfZs0FdqgOcBGzbfQznpt3UV1pgL7Kdl6EfZppP1FNjqaxHyiEqkdINY0X5k33CDV4IVuS0ZDbOuQHInfG2ggLLS_vykC37w5iJe19ECSMWd_JzgQc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using engine : pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] loading key                                   context=pkcs11 url=&quot;pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=02&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using driver: //usr/local/lib/softhsm/libsofthsm2.so  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] slot not specified, using first slot reported by the driver (2139311699)  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] found signing mechanism                       context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] failed to get mechanism info [1044]           context=pkcs11 error=&quot;pkcs11: 0x70: CKR_MECHANISM_INVALID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] no cas provided in caPool. using system provided cas</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] fetching certificates from server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] loading key                                   context=pkcs11 url=&quot;pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=02&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    INFO[0000] using driver: //usr/local/lib/softhsm/libsofthsm2.so  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] slot not specified, using first slot reported by the driver (2139311699)  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] found signing mechanism                       context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    DEBU[0000] EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;  context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    WARN[0000] failed to get mechanism info [1044]           context=pkcs11 error=&quot;pkcs11: 0x70: CKR_MECHANISM_INVALID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enrolled successfully. identity file written to: /home/cd/.softhsm/softhsm_demo/softhsm_demo02_ec.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # run this command and get the id from the first edge-router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id: c34734a4-d5de-430b-a5dc-7fa05363b28d    name: local-edge-router    role attributes: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ EDGE_ROUTER_ID=c34734a4-d5de-430b-a5dc-7fa05363b28d</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # remove/recreate the config - here we&#x27;ll be instructing the tunneler to listen on localhost and port 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge delete config wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create config wttrconfig ziti-tunneler-client.v1 &quot;{ \&quot;hostname\&quot; : \&quot;localhost\&quot;, \&quot;port\&quot; : 9000 }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # recreate the service with the EDGE_ROUTER_ID from above. Here we are adding a ziti service that will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # send a request to wttr.in to retreive a weather forecast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge delete service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti edge create service wttr.ziti &quot;${EDGE_ROUTER_ID}&quot; tcp://wttr.in:80 --configs wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # start one or both proxies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge create config wttrconfig ziti-tunneler-client.v1 &quot;{ \&quot;hostname\&quot; : \&quot;localhost\&quot;, \&quot;port\&quot; : 9000 }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    384166bd-0781-4189-ae66-6789cc1952b2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # recreate the service with the EDGE_ROUTER_ID from above. Here we are adding a ziti service that will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # send a request to wttr.in to retreive a weather forecast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge delete service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti edge create service wttr.ziti &quot;${EDGE_ROUTER_ID}&quot; tcp://wttr.in:80 --configs wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    eb5c5fe8-5781-4760-9962-90ab708027f2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ # start one or both proxies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [1] 14821</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [2] 14822</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ [   0.005]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Start: starting proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.007]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Start: starting proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.006]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {url=[pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=02&amp;pin=2222]} loading key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.007]    INFO github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: using driver: //usr/local/lib/softhsm/libsofthsm2.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.008]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {url=[pkcs11:////usr/local/lib/softhsm/libsofthsm2.so?id=01&amp;pin=2222]} loading key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.008]    INFO github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: using driver: //usr/local/lib/softhsm/libsofthsm2.so</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.019] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: slot not specified, using first slot reported by the driver (2139311699)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.020] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: slot not specified, using first slot reported by the driver (2139311699)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.023]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {sign mechanism=[0]} found signing mechanism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.024]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {sign mechanism=[0]} found signing mechanism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.023]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.loadECDSApub [pkcs11]: EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.023] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.getECDSAmechanism [pkcs11]: {error=[pkcs11: 0x70: CKR_MECHANISM_INVALID]} failed to get mechanism info [1044]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.025]    INFO github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: attempting to authenticate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.024]    INFO github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: attempting to authenticate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.060]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: {token=[de50dbc8-a00b-49aa-8fcc-285be8babdb4] id=[25692bf8-6cb1-4133-8b86-575a8ea65f09]} Got api session: {25692bf8-6cb1-4133-8b86-575a8ea65f09 de50dbc8-a00b-49aa-8fcc-285be8babdb4}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.060]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token de50dbc8-a00b-49aa-8fcc-285be8babdb4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.069]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: {token=[45eae1d0-8ad0-4428-9900-c328ed9e3d23] id=[b8654830-b9e9-4450-9116-072ab4e8cca5]} Got api session: {b8654830-b9e9-4450-9116-072ab4e8cca5 45eae1d0-8ad0-4428-9900-c328ed9e3d23}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.069]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 45eae1d0-8ad0-4428-9900-c328ed9e3d23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.106]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token de50dbc8-a00b-49aa-8fcc-285be8babdb4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.113]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 45eae1d0-8ad0-4428-9900-c328ed9e3d23</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.160]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.160]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[netcat7256]} service netcat7256 was not specified at initialization. not intercepting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.160]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.160]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: requesting session from https://local-edge-controller:1280/sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.160]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: {service_id=[eb5c5fe8-5781-4760-9962-90ab708027f2]} requesting session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.170]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.170]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: requesting session from https://local-edge-controller:1280/sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.170]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: {service_id=[eb5c5fe8-5781-4760-9962-90ab708027f2]} requesting session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.200]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[wttr.ziti] id=[a5291ddc-a86e-48c9-975e-662bc3bcb0d7]} acquired network session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.200]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).handleTCP: {service=[wttr.ziti] addr=[0.0.0.0:8000]} service is listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.221]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[wttr.ziti] id=[d4330d93-a6e1-4e48-91e1-cb26520f09d2]} acquired network session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.222]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.222]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[netcat7256]} service netcat7256 was not specified at initialization. not intercepting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.222]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).handleTCP: {service=[wttr.ziti] addr=[0.0.0.0:9000]} service is listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [1]-  Running                 ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [2]+  Running                 ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ curl -H &quot;Host: wttr.in&quot; http://localhost:8000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.289]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.302]   DEBUG github.com/netfoundry/ziti-foundation/transport/tls.Dial: server provided [2] certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.302]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.304]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.304]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.304]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{D8nP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.305]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).txer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{D8nP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.306]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxAddSinkEvent).Handle: {connId=[1]} Added sink to mux. Current sink count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.306]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).AddMsgSink: {connId=[1]} added to msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.544]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{D8nP}]: waiter found for message. type [60784], sequence [1], replyFor [1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.544]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Connect: {connId=[1]} connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.544]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {src-remote=[127.0.0.1:60053] src-local=[127.0.0.1:8000] dst-local=[:1] dst-remote=[wttr.ziti]} tunnel started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.545]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgChannel).WriteTraced: {chSeq=[-1] edgeSeq=[1] connId=[1] type=[EdgeDataType]} writing 71 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   8.547]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgEvent).Handle: {seq=[1] connId=[1]} handling received EdgeDataType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} got buffer from queue 8907 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Weather report: Laurelton, United States</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Mist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  35..39 °F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _   ↑ 5 mph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  3 mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                0.2 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Thu 13 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      Light drizzle  │      .-.      Light drizzle  │  _`/&quot;&quot;.-.     Moderate or he…│  _`/&quot;&quot;.-.     Patchy light s…│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     (   ).    39..41 °F      │     (   ).    41..46 °F      │   ,\_(   ).   33..39 °F      │   ,\_(   ).   30..+35 °F     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    (___(__)   ↗ 3-5 mph      │    (___(__)   → 8-10 mph     │    /(___(__)  → 7-9 mph      │    /(___(__)  → 6-8 mph      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     ‘ ‘ ‘ ‘   3 mi           │     ‘ ‘ ‘ ‘   1 mi           │     * * * *   5 mi           │      *  *  *  4 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    ‘ ‘ ‘ ‘    0.2 in | 66%   │    ‘ ‘ ‘ ‘    0.0 in | 64%   │    * * * *    0.0 in | 29%   │     *  *  *   0.0 in | 57%   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Fri 14 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               Overcast       │               Cloudy         │  _`/&quot;&quot;.-.     Patchy snow po…│    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .--.     8..21 °F       │      .--.     12..23 °F      │   ,\_(   ).   10..21 °F      │  _ /&quot;&quot;.-.     1..14 °F       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   .-(    ).   ↘ 9-12 mph     │   .-(    ).   ↘ 10-11 mph    │    /(___(__)  ↘ 11-14 mph    │    \_(   ).   ↓ 9-15 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │  (___.__)__)  6 mi           │  (___.__)__)  6 mi           │      ‘ * ‘ *  6 mi           │    /(___(__)  5 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               0.0 in | 0%    │               0.0 in | 0%    │     * ‘ * ‘   0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Sat 15 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     \   /     Sunny          │     \   /     Sunny          │               Overcast       │               Overcast       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      14..17 °F      │      .-.      19..24 °F      │      .--.     21..30 °F      │      .--.     17..26 °F      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ― (   ) ―   → 2 mph        │   ― (   ) ―   ↑ 3-4 mph      │   .-(    ).   ↑ 9-13 mph     │   .-(    ).   ↑ 8-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      `-’      6 mi           │      `-’      6 mi           │  (___.__)__)  6 mi           │  (___.__)__)  6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     /   \     0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Follow @igor_chubin for wttr.in updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {dst-local=[:1] dst-remote=[wttr.ziti] src-remote=[127.0.0.1:60053] src-local=[127.0.0.1:8000]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxRemoveSinkEvent).Handle: {connId=[1]} Removed sink from mux. Current sink count: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).RemoveMsgSinkById: {connId=[1]} removed from msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   9.968]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ [  10.969]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} sequencer closed, closing connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  10.969]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} return EOF from closing/closed connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  10.969]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {src-remote=[wttr.ziti] src-local=[:1] dst-local=[127.0.0.1:8000] dst-remote=[127.0.0.1:60053]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  10.969]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {dst-remote=[wttr.ziti] src-remote=[127.0.0.1:60053] src-local=[127.0.0.1:8000] dst-local=[:1]} tunnel closed: 71 bytes sent; 8907 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    curl -H &quot;Host: wttr.in&quot; http://localhost:9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.253]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.265]   DEBUG github.com/netfoundry/ziti-foundation/transport/tls.Dial: server provided [2] certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.265]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxAddSinkEvent).Handle: {connId=[1]} Added sink to mux. Current sink count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{DGp7}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).AddMsgSink: {connId=[1]} added to msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.266]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).txer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{DGp7}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.405]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{DGp7}]: waiter found for message. type [60784], sequence [1], replyFor [1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.405]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Connect: {connId=[1]} connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.405]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {src-local=[127.0.0.1:9000] dst-local=[:1] dst-remote=[wttr.ziti] src-remote=[127.0.0.1:60058]} tunnel started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.405]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.405]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgChannel).WriteTraced: {connId=[1] type=[EdgeDataType] chSeq=[-1] edgeSeq=[1]} writing 71 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgEvent).Handle: {seq=[1] connId=[1]} handling received EdgeDataType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} got buffer from queue 8907 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Weather report: Laurelton, United States</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Mist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  35..39 °F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _   ↑ 5 mph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  3 mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                0.2 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Thu 13 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      Light drizzle  │      .-.      Light drizzle  │  _`/&quot;&quot;.-.     Moderate or he…│  _`/&quot;&quot;.-.     Patchy light s…│</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     (   ).    39..41 °F      │     (   ).    41..46 °F      │   ,\_(   ).   33..39 °F      │   ,\_(   ).   30..+35 °F     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    (___(__)   ↗ 3-5 mph      │    (___(__)   → 8-10 mph     │    /(___(__)  → 7-9 mph      │    /(___(__)  → 6-8 mph      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     ‘ ‘ ‘ ‘   3 mi           │     ‘ ‘ ‘ ‘   1 mi           │     * * * *   5 mi           │      *  *  *  4 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    ‘ ‘ ‘ ‘    0.2 in | 66%   │    ‘ ‘ ‘ ‘    0.0 in | 64%   │    * * * *    0.0 in | 29%   │     *  *  *   0.0 in | 57%   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Fri 14 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               Overcast       │               Cloudy         │  _`/&quot;&quot;.-.     Patchy snow po…│    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .--.     8..21 °F       │      .--.     12..23 °F      │   ,\_(   ).   10..21 °F      │  _ /&quot;&quot;.-.     1..14 °F       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   .-(    ).   ↘ 9-12 mph     │   .-(    ).   ↘ 10-11 mph    │    /(___(__)  ↘ 11-14 mph    │    \_(   ).   ↓ 9-15 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │  (___.__)__)  6 mi           │  (___.__)__)  6 mi           │      ‘ * ‘ *  6 mi           │    /(___(__)  5 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               0.0 in | 0%    │               0.0 in | 0%    │     * ‘ * ‘   0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Sat 15 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     \   /     Sunny          │     \   /     Sunny          │               Overcast       │               Overcast       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      14..17 °F      │      .-.      19..24 °F      │      .--.     21..30 °F      │      .--.     17..26 °F      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ― (   ) ―   → 2 mph        │   ― (   ) ―   ↑ 3-4 mph      │   .-(    ).   ↑ 9-13 mph     │   .-(    ).   ↑ 8-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      `-’      6 mi           │      `-’      6 mi           │  (___.__)__)  6 mi           │  (___.__)__)  6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     /   \     0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Follow @igor_chubin for wttr.in updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {src-local=[127.0.0.1:9000] dst-local=[:1] dst-remote=[wttr.ziti] src-remote=[127.0.0.1:60058]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxRemoveSinkEvent).Handle: {connId=[1]} Removed sink from mux. Current sink count: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).RemoveMsgSinkById: {connId=[1]} removed from msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.605]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ [  15.606]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} sequencer closed, closing connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.606]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} return EOF from closing/closed connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.606]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {dst-local=[127.0.0.1:9000] dst-remote=[127.0.0.1:60058] src-remote=[wttr.ziti] src-local=[:1]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.606]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {dst-local=[:1] dst-remote=[wttr.ziti] src-remote=[127.0.0.1:60058] src-local=[127.0.0.1:9000]} tunnel closed: 71 bytes sent; 8907 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [1]-  Running                 ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [2]+  Running                 ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v &amp;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ killall ziti-tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept.ServicePoller: caught signal terminated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept.ServicePoller: caught signal terminated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept.ServicePoller: caught signal terminated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept.ServicePoller: caught signal terminated</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: stopping tunnel for unavailable service: netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: stopping tunnel for unavailable service: wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]   ERROR github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: failed to stop intercepting: StopIntercepting not implemented by proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]   ERROR github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: failed to stop intercepting: StopIntercepting not implemented by proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: stopping tunnel for unavailable service: netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: stopping tunnel for unavailable service: wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]   ERROR github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: failed to stop intercepting: StopIntercepting not implemented by proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]   ERROR github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: failed to stop intercepting: StopIntercepting not implemented by proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.731]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Stop: stopping proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  21.732]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Stop: stopping proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [1]-  Done                    ziti-tunnel proxy -i &quot;${HSM_DEST}/${RSA_ID}.json&quot; wttr.ziti:8000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [2]+  Done                    ziti-tunnel proxy -i &quot;${HSM_DEST}/${EC_ID}.json&quot; wttr.ziti:9000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    $ jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cd@sg1 ~/.softhsm/softhsm_demo</span><br></span></code></pre></div></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><div class="language-text codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM the name of the ziti controller you&#x27;re logging into</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET ZITI_CTRL=local-edge-controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM the location of the certificate(s) to use to validate the controller</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET ZITI_CTRL_CERT=c:\path\to\controller.cert</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET ZITI_USER=myUserName</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET ZITI_PWD=myPassword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM a name for the configuration</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_NAME=softhsm_demo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM the path to the root of the softhsm config files</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_ROOT=c:\path\to\softhsm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM path to the softhsm2 library</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET PKCS11_MODULE=%HSM_ROOT%\lib\softhsm2.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;--- or ---</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;---&#x27; is not recognized as an internal or external command,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    operable program or batch file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET PKCS11_MODULE=%HSM_ROOT%\lib\softhsm2-x64.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM the id of the key - you probably want to leave these alone unless you know better</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_ID1=01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_ID2=02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET RSA_ID=%HSM_NAME%%HSM_ID1%_rsa</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET EC_ID=%HSM_NAME%%HSM_ID2%_ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM the pins used when accessing the pkcs11 api</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_SOPIN=1111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_PIN=2222</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_DEST=%HSM_ROOT%\%HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_LABEL=%HSM_NAME%-label</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET SOFTHSM2_CONF=%HSM_DEST%\softhsm.config</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET HSM_TOKENS_DIR=%HSM_DEST%\tokens\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM make an alias for ease</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;doskey p=&quot;c:\Program Files\OpenSC Project\OpenSC\tools\pkcs11-tool.exe&quot; --module %PKCS11_MODULE% $*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;cd /d %HSM_ROOT%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm&gt;rmdir /s /q %HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm&gt;mkdir %HSM_TOKENS_DIR%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm&gt;cd /d %HSM_NAME%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;# Create a text file at %SOFTHSM2_CONF% with these contents but make sure you replace the tokendir entry with %HSM_TOKENS_DIR%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;#&#x27; is not recognized as an internal or external command,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    operable program or batch file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;echo ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? # SoftHSM v2 configuration file ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? directories.tokendir = %HSM_TOKENS_DIR% ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? objectstore.backend = file ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? # ERROR, WARNING, INFO, DEBUG ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? log.level = INFO ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? # If CKF_REMOVABLE_DEVICE flag should be set ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? slots.removable = false ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? # Enable and disable PKCS#11 mechanisms using slots.mechanisms. ^</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More?</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    More? slots.mechanisms = ALL &gt; %SOFTHSM2_CONF%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge login %ZITI_CTRL%:1280 -u %ZITI_USER% -p %ZITI_PWD%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Token: c6f4d504-6095-4118-8f13-3c787821963f</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM create a new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge create identity &quot;%RSA_ID%&quot; -o &quot;%HSM_DEST%\%RSA_ID%.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    a625ee46-b799-4e9f-a92c-59a579cb9756</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Enrollment expires at 2020-02-23T14:22:08.902166003Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM create a second new identity and output the jwt to a known location</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge create identity &quot;%EC_ID%&quot; -o &quot;%HSM_DEST%\%EC_ID%.jwt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    08889f51-1639-4cd0-9c18-ffcc5e315f3e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Enrollment expires at 2020-02-23T14:22:09.634832703Z</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;p --init-token --label &quot;ziti-test-token&quot; --so-pin %HSM_SOPIN%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x0)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Token successfully initialized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;p --init-pin --pin &quot;%HSM_PIN%&quot; --so-pin %HSM_SOPIN%</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x1af2a063)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    User PIN successfully initialized</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM create a couple of keys - one rsa and one ec</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;p -p &quot;%HSM_PIN%&quot; -k --key-type rsa:2048 --id &quot;%HSM_ID1%&quot; --label ziti-rsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x1af2a063)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Key pair generated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Key Object; RSA</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-rsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      decrypt, sign, unwrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Access:     sensitive, always sensitive, never extractable, local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Public Key Object; RSA 2048 bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-rsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      encrypt, verify, wrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Access:     local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;p -p &quot;%HSM_PIN%&quot; -k --key-type EC:prime256v1 --id &quot;%HSM_ID2%&quot; --label ziti-ecdsa-key --usage-sign --usage-decrypt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Using slot 0 with a present token (0x1af2a063)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Key pair generated:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Private Key Object; EC</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-ecdsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      decrypt, sign, unwrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Access:     sensitive, always sensitive, never extractable, local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Public Key Object; EC  EC_POINT 256 bits</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EC_POINT:   04410419240eaf1e7628c94dbb3ab46f0b4c5b3fe8bab8227b67ed9bdea6d107547c16ac401437f674c73986697cc2c0e4ae0416775ee8ec0b65f1fe6c935acdc4b35a</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    EC_PARAMS:  06082a8648ce3d030107</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    label:      ziti-ecdsa-key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ID:         02</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Usage:      encrypt, verify, wrap</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Access:     local</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti-tunnel enroll -j &quot;%HSM_DEST%\%RSA_ID%.jwt&quot; -k &quot;pkcs11://%PKCS11_MODULE%?id=%HSM_ID1%&amp;pin=%HSM_PIN%&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;jwt to parse: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbSI6Im90dCIsImV4cCI6MTU4MjQ2NzcyOCwiaXNzIjoiaHR0cHM6Ly9sb2NhbC1lZGdlLWNvbnRyb2xsZXI6MTI4MCIsImp0aSI6IjQwZjE5Y2VhLWFjYWYtNDQyMy1iNzhjLWI2NjU4MDA0NGI2MSIsInN1YiI6ImE2MjVlZTQ2LWI3OTktNGU5Zi1hOTJjLTU5YTU3OWNiOTc1NiJ9.LkziWbgKeJtZ6f5dd169K32Gq86-6ly13v7iHn7Zj_ITFudxXzLa2dl3JonBRg6hNW8ghiPNZ7JpcSkRiaN8npKUHAnsZfr1kPE-NR-eJmUTqM88UhznQJOKyAZzA-dLxRfsRgmU9ESLVsAQEE4wefPz8AlsXWGYK9oWx-X0SEwu4TgjCWP1jEd7pQJXw5ZXIBYLZMG0buIFaKgskH-inpK7BF2LZc9ENr6nj4W4X_tm7kbzGdQ-ofzlhJMBHFz2w_qQXDqXiYWf59Wrszd9-3y0rbvykmc9L8G3B1YlICKyD6mhaPt4fLquZEOwsyeOgH9BLJhX9I33nfYZe_mQf4jzhw5U13K1VKaL-JGwfXntwrKMUJhB62NDMLNALMDqc4hK3BKp1wdZT5YL2Y91J2lLa50mg0OG9ASvkmh7dW3FhDFntl9UnSuPmVJExfMJJCXwe0DgbLcg0TugUuioJ9iCrAZ2tTsLoXDIqLj4zqDhe2nCXdTGgqGpa2ftqNWsUxJmZM2V8ll8Mb2tcuNu0WHcpZ1nH9iXuNHWRsLyowIZB0NJoIvYRlHzlPiSjJxZlNdMSh2jm6tZ7_sAyw_cIAU20yJ3KSGE2PT9bCgkISiYEZ2V5Q3cyGIi0OMP7IqZ5vomqHhkF41C4LIH7A4NKCWMztTwt-WOIndGX5yB1GA&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=info msg=&quot;using engine : pkcs11\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;loading key&quot; context=pkcs11 url=&quot;pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=01&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=info msg=&quot;using driver: c:\\path\\to\\softhsm\\lib\\softhsm2-x64.dll&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=warning msg=&quot;slot not specified, using first slot reported by the driver (452108387)&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;found signing mechanism&quot; context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;no cas provided in caPool. using system provided cas&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;fetching certificates from server&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;loading key&quot; context=pkcs11 url=&quot;pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=01&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=info msg=&quot;using driver: c:\\path\\to\\softhsm\\lib\\softhsm2-x64.dll&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=warning msg=&quot;slot not specified, using first slot reported by the driver (452108387)&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:18-05:00&quot; level=debug msg=&quot;found signing mechanism&quot; context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enrolled successfully. identity file written to: c:\path\to\softhsm\softhsm_demo\softhsm_demo01_rsa.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti-tunnel enroll -j &quot;%HSM_DEST%\%EC_ID%.jwt&quot; -k &quot;pkcs11://%PKCS11_MODULE%?id=%HSM_ID2%&amp;pin=%HSM_PIN%&quot; -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;jwt to parse: eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbSI6Im90dCIsImV4cCI6MTU4MjQ2NzcyOSwiaXNzIjoiaHR0cHM6Ly9sb2NhbC1lZGdlLWNvbnRyb2xsZXI6MTI4MCIsImp0aSI6ImU0NDhlMGVjLTk4Y2ItNDBjMC05MmE4LWE2YjMyZDJlY2UwMCIsInN1YiI6IjA4ODg5ZjUxLTE2MzktNGNkMC05YzE4LWZmY2M1ZTMxNWYzZSJ9.HHlGcNPh1E83SG3ncCzIPLpav4fRZ44eAeq9Igr24CHT3TCJXXooFNVY5LYtTJ3ydsE6RVPn3UCrP_72CK4Y8Bc-OHDxtPsl0wQwH90tYIz68d2Br0D8kBjjLnYNfsQS0w4t9GEdnNLD8WfjIF8V1croBksrA0jyDiZFak67tKwohzftmm7bNNibA2KvNFVSa_ZaD1lT-SR5xEHaTkR4LpBhPSN9HeR6TAj0c0LsFgFAm_4LrX14r3eufCxxj0TIEHPvxqa_dMJq3TuUFQQPvSIStnXKd9i4gTnFhFdxeZ4J4R94IT6UdzAVD1lIBA9tta7XrMgKpG7Yl8OX60rh3je4S73WAff4kZg6gFpL2RckHuCGdn4AoAXPJoFqBerQ3xybAVNW913fxtw942juVBhjb4Ex2LzZylkRrQmJ3xV5s3-MuW8-1-2N1lK5u1JK_sulrCx5trrvFb99z2INnNh0baVFq_7-3KozVsE0RNiXGc5dAjhNFWJWXT9H6PhIzzJ-0l84ZQaloxon1b70LnoVPC8g2z-Psvv8-Pc2JIlg5K4DLIXsagD4n4S1Fh8aqAyduF5Sc7ddVQ20-8Fz8iIZXNEGvNa9KwuHVzrk3UZJ3cB7Q1oWDshHPcMd7B4AtyV4z9U4qUP7syyAYkGYrMT_F26uNmIb0s2eW6xDf68&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=info msg=&quot;using engine : pkcs11\n&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;loading key&quot; context=pkcs11 url=&quot;pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=02&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=info msg=&quot;using driver: c:\\path\\to\\softhsm\\lib\\softhsm2-x64.dll&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=warning msg=&quot;slot not specified, using first slot reported by the driver (452108387)&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;found signing mechanism&quot; context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=warning msg=&quot;failed to get mechanism info [1044]&quot; context=pkcs11 error=&quot;pkcs11: 0x70: CKR_MECHANISM_INVALID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;no cas provided in caPool. using system provided cas&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;fetching certificates from server&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;loading key&quot; context=pkcs11 url=&quot;pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=02&amp;pin=2222&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=info msg=&quot;using driver: c:\\path\\to\\softhsm\\lib\\softhsm2-x64.dll&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=warning msg=&quot;slot not specified, using first slot reported by the driver (452108387)&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;found signing mechanism&quot; context=pkcs11 sign mechanism=0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=debug msg=&quot;EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;&quot; context=pkcs11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    time=&quot;2020-02-13T09:22:19-05:00&quot; level=warning msg=&quot;failed to get mechanism info [1044]&quot; context=pkcs11 error=&quot;pkcs11: 0x70: CKR_MECHANISM_INVALID&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    enrolled successfully. identity file written to: c:\path\to\softhsm\softhsm_demo\softhsm_demo02_ec.json</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM run this command and get the id from the first edge-router.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    id: 727f0074-9011-4b79-955b-a6a9e3bb67b1    name: local-edge-router    role attributes: {}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM use the id returned from the above command and put it into a variable for use in a momment</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;SET EDGE_ROUTER_ID=727f0074-9011-4b79-955b-a6a9e3bb67b1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM remove/recreate the config - here we&#x27;ll be instructing the tunneler to listen on localhost and port 9000</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge delete config wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge create config wttrconfig ziti-tunneler-client.v1 &quot;{ \&quot;hostname\&quot; : \&quot;localhost\&quot;, \&quot;port\&quot; : 9000 }&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    7e73d98c-e44f-4360-9a48-6d1c812f0a75</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM recreate the service with the EDGE_ROUTER_ID from above. Here we are adding a ziti service that will</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM send a request to wttr.in to retreive a weather forecast</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge delete service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;ziti edge create service wttr.ziti &quot;%EDGE_ROUTER_ID%&quot; tcp://wttr.in:80 --configs wttrconfig</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    04ccec0c-3329-4f8f-8942-9dbd378bb15e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;REM start one or both proxies - use ctrl-break or ctrl-pause to terminate these processes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;start /b ziti-tunnel proxy -i &quot;%HSM_DEST%/%RSA_ID%.json&quot; wttr.ziti:8000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;[   0.026]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Start: starting proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.027]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {url=[pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=01&amp;pin=2222]} loading key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.028]    INFO github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: using driver: c:\path\to\softhsm\lib\softhsm2-x64.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.036] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: slot not specified, using first slot reported by the driver (452108387)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.043]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {sign mechanism=[0]} found signing mechanism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.044]    INFO github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: attempting to authenticate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.079]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: {id=[087afe19-9c8b-40f4-88c9-962d9e04f1b8] token=[28c9472d-8540-413d-9f8e-532139dfbdcb]} Got api session: {087afe19-9c8b-40f4-88c9-962d9e04f1b8 28c9472d-8540-413d-9f8e-532139dfbdcb}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.080]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 28c9472d-8540-413d-9f8e-532139dfbdcb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.124]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 28c9472d-8540-413d-9f8e-532139dfbdcb</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.166]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.166]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[netcat7256]} service netcat7256 was not specified at initialization. not intercepting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.167]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.169]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: requesting session from https://local-edge-controller:1280/sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.169]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: {service_id=[04ccec0c-3329-4f8f-8942-9dbd378bb15e]} requesting session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.203]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[wttr.ziti] id=[4b9096a5-4bef-4296-813d-252aebe7ebe6]} acquired network session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.203]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).handleTCP: {service=[wttr.ziti] addr=[0.0.0.0:8000]} service is listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    start /b ziti-tunnel proxy -i &quot;%HSM_DEST%/%EC_ID%.json&quot; wttr.ziti:9000 -v</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;[   0.017]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).Start: starting proxy interceptor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.017]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {url=[pkcs11://c:%5Cpath%5Cto%5Csofthsm%5Clib%5Csofthsm2-x64.dll?id=02&amp;pin=2222]} loading key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.018]    INFO github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: using driver: c:\path\to\softhsm\lib\softhsm2-x64.dll</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.026] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: slot not specified, using first slot reported by the driver (452108387)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.034]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.(*engine).LoadKey [pkcs11]: {sign mechanism=[0]} found signing mechanism</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.034]   DEBUG github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.loadECDSApub [pkcs11]: EC oid[1.2.840.10045.3.1.7], rest: [], err: &lt;nil&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.035] WARNING github.com/netfoundry/ziti-foundation/identity/engines/pkcs11.getECDSAmechanism [pkcs11]: {error=[pkcs11: 0x70: CKR_MECHANISM_INVALID]} failed to get mechanism info [1044]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.037]    INFO github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: attempting to authenticate</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.074]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).Authenticate: {token=[68289015-5910-464f-8c1f-4870c28cfbb1] id=[32d29510-6285-4cff-80b3-a9630ffef388]} Got api session: {32d29510-6285-4cff-80b3-a9630ffef388 68289015-5910-464f-8c1f-4870c28cfbb1}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.074]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 68289015-5910-464f-8c1f-4870c28cfbb1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.123]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getServices: using api session token 68289015-5910-464f-8c1f-4870c28cfbb1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.162]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service wttr.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.163]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: requesting session from https://local-edge-controller:1280/sessions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.164]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti.(*contextImpl).getSession: {service_id=[04ccec0c-3329-4f8f-8942-9dbd378bb15e]} requesting session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.204]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[wttr.ziti] id=[d09009a6-a2b2-405b-8125-8f9c021ff8de]} acquired network session</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.204]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept.updateServices: starting tunnel for newly available service netcat7256</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.206]   DEBUG github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.interceptor.Intercept: {service=[netcat7256]} service netcat7256 was not specified at initialization. not intercepting</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [   0.207]    INFO github.com/netfoundry/ziti-edge/tunnel/intercept/proxy.(*interceptor).handleTCP: {addr=[0.0.0.0:9000] service=[wttr.ziti]} service is listening</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;curl -H &quot;Host: wttr.in&quot; http://localhost:8000 &gt; &quot;%HSM_DEST%\example_%RSA_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.743]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                    Dload  Upload   Total   Spent    Left  Spee[  14.758]   DEBUG github.com/netfoundry/ziti-foundation/transport/tls.Dial: server provided [2] certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    d[  14.758]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.759]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.759]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.760]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{PpLP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.760]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxAddSinkEvent).Handle: {connId=[1]} Added sink to mux. Current sink count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.761]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).AddMsgSink: {connId=[1]} added to msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.761]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).txer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{PpLP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[  14.874]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{PpLP}]: waiter found for message. type [60784], sequence [1], replyFor [1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.874]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Connect: {connId=[1]} connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.875]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {dst-local=[:1] dst-remote=[wttr.ziti] src-remote=[127.0.0.1:62125] src-local=[127.0.0.1:8000]} tunnel started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.878]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgChannel).WriteTraced: {edgeSeq=[1] connId=[1] type=[EdgeDataType] chSeq=[-1]} writing 71 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  14.879]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.057]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgEvent).Handle: {connId=[1] seq=[1]} handling received EdgeDataType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.057]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} got buffer from queue 8964 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.058]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    100  8799  100  8799    0     0  28111      0 --:--:-- --:--:-- --:--:-- 28111</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.067]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {src-remote=[127.0.0.1:62125] src-local=[127.0.0.1:8000] dst-local=[:1] dst-remote=[wttr.ziti]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.067]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.069]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxRemoveSinkEvent).Handle: {connId=[1]} Removed sink from mux. Current sink count: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.069]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).RemoveMsgSinkById: {connId=[1]} removed from msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  15.070]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;[  16.070]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} sequencer closed, closing connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  16.070]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} return EOF from closing/closed connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  16.071]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {dst-remote=[127.0.0.1:62125] src-remote=[wttr.ziti] src-local=[:1] dst-local=[127.0.0.1:8000]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  16.072]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {dst-remote=[wttr.ziti] src-remote=[127.0.0.1:62125] src-local=[127.0.0.1:8000] dst-local=[:1]} tunnel closed: 71 bytes sent; 8964 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;    curl -H &quot;Host: wttr.in&quot; http://localhost:9000 &gt; &quot;%HSM_DEST%\example_%EC_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.776]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    [  18.785]   DEBUG github.com/netfoundry/ziti-foundation/transport/tls.Dial: server provided [2] certificates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.785]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.786]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).sendHello [u{classic}-&gt;i{}]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.786]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*classicDialer).Create [tls:local-edge-router:3022]: exited</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.787]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxAddSinkEvent).Handle: {connId=[1]} Added sink to mux. Current sink count: 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.787]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{15kP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.789]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).AddMsgSink: {connId=[1]} added to msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.789]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).txer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{15kP}]: started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Dload  Upload   Total   Spent    Left  Speed</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[  18.902]   DEBUG github.com/netfoundry/ziti-foundation/channel2.(*channelImpl).rxer [ch{ziti-sdk}-&gt;u{classic}-&gt;i{15kP}]: waiter found for message. type [60784], sequence [1], replyFor [1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.903]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Connect: {connId=[1]} connected</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.904]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {src-remote=[127.0.0.1:62130] src-local=[127.0.0.1:9000] dst-local=[:1] dst-remote=[wttr.ziti]} tunnel started</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.905]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgChannel).WriteTraced: {type=[EdgeDataType] chSeq=[-1] edgeSeq=[1] connId=[1]} writing 71 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  18.906]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0[  19.334]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgEvent).Handle: {seq=[1] connId=[1]} handling received EdgeDataType</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.335]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} got buffer from queue 8964 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.336]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} read buffer = 32768 bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    100  8799  100  8799    0     0  15628      0 --:--:-- --:--:-- --:--:-- 15628</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.344]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {src-remote=[127.0.0.1:62130] src-local=[127.0.0.1:9000] dst-local=[:1] dst-remote=[wttr.ziti]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.344]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: begin</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.345]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*muxRemoveSinkEvent).Handle: {connId=[1]} Removed sink from mux. Current sink count: 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.347]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/edge.(*MsgMux).RemoveMsgSinkById: {connId=[1]} removed from msg mux</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  19.349]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Close: {connId=[1]} close: end</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;[  20.345]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} sequencer closed, closing connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  20.345]   DEBUG github.com/netfoundry/ziti-sdk-golang/ziti/internal/edge_impl.(*edgeConn).Read: {connId=[1]} return EOF from closing/closed connection</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  20.347]    INFO github.com/netfoundry/ziti-edge/tunnel.Run: {src-remote=[127.0.0.1:62130] src-local=[127.0.0.1:9000] dst-local=[:1] dst-remote=[wttr.ziti]} tunnel closed: 71 bytes sent; 8964 bytes received</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    [  20.349]    INFO github.com/netfoundry/ziti-edge/tunnel.myCopy: {dst-local=[127.0.0.1:9000] dst-remote=[127.0.0.1:62130] src-remote=[wttr.ziti] src-local=[:1]} stopping pipe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    tpye &quot;%HSM_DEST%\example_%RSA_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &#x27;tpye&#x27; is not recognized as an internal or external command,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    operable program or batch file.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;type &quot;%HSM_DEST%\example_%RSA_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Weather report: Laurelton, United States</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Mist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  35..39 °F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _   ↑ 5 mph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  3 mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                0.0 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌────────────────��─────────────┬───────────────────────┤  Thu 13 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      Light rain     │      .-.      Light rain     │  _`/&quot;&quot;.-.     Moderate or he…│    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     (   ).    35..37 °F      │     (   ).    39..41 °F      │   ,\_(   ).   32..39 °F      │  _ /&quot;&quot;.-.     26..+33 °F     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    (___(__)   ↑ 4-6 mph      │    (___(__)   ↗ 5-6 mph      │    /(___(__)  → 8-10 mph     │    \_(   ).   → 9-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     ‘ ‘ ‘ ‘   5 mi           │     ‘ ‘ ‘ ‘   5 mi           │     * * * *   5 mi           │    /(___(__)  4 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    ‘ ‘ ‘ ‘    0.1 in | 79%   │    ‘ ‘ ‘ ‘    0.0 in | 80%   │    * * * *    0.0 in | 25%   │               0.0 in | 51%   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Fri 14 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼─────────────────────────────��┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    \  /       Partly cloudy  │     \   /     Sunny          │    \  /       Partly cloudy  │     \   /     Clear          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │  _ /&quot;&quot;.-.     3..17 °F       │      .-.      6..19 °F       │  _ /&quot;&quot;.-.     8..19 °F       │      .-.      5..14 °F       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    \_(   ).   ↘ 11-13 mph    │   ― (   ) ―   ↘ 11-13 mph    │    \_(   ).   ↗ 9-12 mph     │   ― (   ) ―   ↓ 7-11 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    /(___(__)  6 mi           │      `-’      6 mi           │    /(___(__)  6 mi           │      `-’      6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │     /   \     0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └───────────────────��──────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Sat 15 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├────────────���─────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     \   /     Sunny          │     \   /     Sunny          │    \  /       Partly cloudy  │    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      12..17 °F      │      .-.      17..24 °F      │  _ /&quot;&quot;.-.     21..30 °F      │  _ /&quot;&quot;.-.     15..24 °F      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ― (   ) ―   ↑ 3-4 mph      │   ― (   ) ―   ↑ 6-7 mph      │    \_(   ).   ↑ 8-13 mph     │    \_(   ).   ↑ 7-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      `-’      6 mi           │      `-’      6 mi           │    /(___(__)  6 mi           │    /(___(__)  6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     /   \     0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Follow @igor_chubin for wttr.in updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;type &quot;%HSM_DEST%\example_%EC_ID%.txt&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Weather report: Laurelton, United States</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                Mist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  35..39 °F</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _   ↑ 5 mph</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ - _ - _ -  3 mi</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                0.0 in</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌────────────────��─────────────┬───────────────────────┤  Thu 13 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      Light rain     │      .-.      Light rain     │  _`/&quot;&quot;.-.     Moderate or he…│    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     (   ).    35..37 °F      │     (   ).    39..41 °F      │   ,\_(   ).   32..39 °F      │  _ /&quot;&quot;.-.     26..+33 °F     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    (___(__)   ↑ 4-6 mph      │    (___(__)   ↗ 5-6 mph      │    /(___(__)  → 8-10 mph     │    \_(   ).   → 9-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     ‘ ‘ ‘ ‘   5 mi           │     ‘ ‘ ‘ ‘   5 mi           │     * * * *   5 mi           │    /(___(__)  4 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    ‘ ‘ ‘ ‘    0.1 in | 79%   │    ‘ ‘ ‘ ‘    0.0 in | 80%   │    * * * *    0.0 in | 25%   │               0.0 in | 51%   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Fri 14 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├──────────────────────────────┼──────────────────────────────┼─────────────────────────────��┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    \  /       Partly cloudy  │     \   /     Sunny          │    \  /       Partly cloudy  │     \   /     Clear          │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │  _ /&quot;&quot;.-.     3..17 °F       │      .-.      6..19 °F       │  _ /&quot;&quot;.-.     8..19 °F       │      .-.      5..14 °F       │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    \_(   ).   ↘ 11-13 mph    │   ― (   ) ―   ↘ 11-13 mph    │    \_(   ).   ↗ 9-12 mph     │   ― (   ) ―   ↓ 7-11 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │    /(___(__)  6 mi           │      `-’      6 mi           │    /(___(__)  6 mi           │      `-’      6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │               0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │     /   \     0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └───────────────────��──────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                        ┌─────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ┌──────────────────────────────┬───────────────────────┤  Sat 15 Feb ├───────────────────────┬──────────────────────────────┐</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │            Morning           │             Noon      └──────┬──────┘     Evening           │             Night            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ├────────────���─────────────────┼──────────────────────────────┼──────────────────────────────┼──────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     \   /     Sunny          │     \   /     Sunny          │    \  /       Partly cloudy  │    \  /       Partly cloudy  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      .-.      12..17 °F      │      .-.      17..24 °F      │  _ /&quot;&quot;.-.     21..30 °F      │  _ /&quot;&quot;.-.     15..24 °F      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │   ― (   ) ―   ↑ 3-4 mph      │   ― (   ) ―   ↑ 6-7 mph      │    \_(   ).   ↑ 8-13 mph     │    \_(   ).   ↑ 7-14 mph     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │      `-’      6 mi           │      `-’      6 mi           │    /(___(__)  6 mi           │    /(___(__)  6 mi           │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    │     /   \     0.0 in | 0%    │     /   \     0.0 in | 0%    │               0.0 in | 0%    │               0.0 in | 0%    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    └──────────────────────────────┴──────────────────────────────┴──────────────────────────────┴──────────────────────────────┘</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Follow @igor_chubin for wttr.in updates</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    c:\path\to\softhsm\softhsm_demo&gt;</span><br></span></code></pre></div></div></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/hsm/softhsm.mdx" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"><span class="theme-last-updated">Last updated<!-- --> on <b><time datetime="2025-06-30T18:08:49.000Z" itemprop="dateModified">Jun 30, 2025</time></b></span></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guides/hsm/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Hardware Security Modules</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/guides/hsm/yubikey"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">YubiKey by Yubico</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link toc-highlight">Overview</a></li><li><a href="#prerequisites" class="table-of-contents__link toc-highlight">Prerequisites</a></li><li><a href="#lets-do-this---softhsmv2" class="table-of-contents__link toc-highlight">Let&#39;s Do This - SoftHSMv2</a><ul><li><a href="#establish-environment-variables" class="table-of-contents__link toc-highlight">Establish Environment Variables</a></li><li><a href="#make-directories-and-generate-config-files" class="table-of-contents__link toc-highlight">Make Directories and Generate Config Files</a></li><li><a href="#use-the-ziti-cli" class="table-of-contents__link toc-highlight">Use the Ziti CLI</a></li><li><a href="#use-pkcs11-tool-to-setup-softhsmv2" class="table-of-contents__link toc-highlight">Use pkcs11-tool to Setup SoftHSMv2</a></li><li><a href="#use-ziti-tunnel-to-enroll-the-identities" class="table-of-contents__link toc-highlight">Use ziti-tunnel to Enroll the Identities</a></li><li><a href="#use-ziti-tunnel-to-verify-things-work" class="table-of-contents__link toc-highlight">Use ziti-tunnel to Verify Things Work</a></li><li><a href="#putting-it-all-together" class="table-of-contents__link toc-highlight">Putting It All Together</a></li></ul></li><li><a href="#sample-output" class="table-of-contents__link toc-highlight">Sample Output</a></li></ul></div></div></div></div></main></div></div><footer class="ozLayoutFooter_Elxg ozFooter_Avh_"><section class="footer_TVlg ozHorizontalSectionRoot_MIa6 ozhsContent_Tzp1"><div class="footerContainer_otJT"><div class="footerGrid_DfDa"><div class="footerColumn_aKLl"><h3>OpenZiti</h3><p>An open source project enabling developers to embed zero trust networking directly into applications.</p><div class="footerSocialLinks_HWin"><a href="https://github.com/openziti/ziti" target="_blank" class="footerSocialLink_t5Hs"><svg width="20" height="20" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z"></path></svg></a><a href="https://www.linkedin.com/company/netfoundry" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 16V10.1C15.996 7.5 15.375 5.49999 12.025 5.49999C10.4 5.49999 9.325 6.39999 8.875 7.29999H8.825V5.79999H5.65V16H8.95V10.7C8.95 9.30001 9.2 7.9 10.925 7.9C12.65 7.9 12.675 9.59999 12.675 10.8V16H15.996Z"></path><path d="M0.25 5.79999H3.575V16H0.25V5.79999Z"></path><path d="M1.9 0C0.85 0 0 0.85 0 1.9C0 2.95 0.85 3.8 1.9 3.8C2.95 3.8 3.8 2.95 3.8 1.9C3.8 0.85 2.95 0 1.9 0Z"></path></svg></a><a href="https://www.youtube.com/OpenZiti" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.969 4.69c-.183-1.358-1.062-2.275-2.361-2.46C12.371 2 8 2 8 2S3.629 2 2.362 2.229c-1.3.186-2.179 1.103-2.361 2.461C0 6.03 0 10 0 10s0 3.97.2 5.31c.183 1.358 1.062 2.275 2.361 2.46C3.63 18 8 18 8 18s4.371 0 5.638-.23c1.3-.185 2.178-1.102 2.361-2.46.2-1.34.2-5.31.2-5.31s0-3.97-.23-5.31zm-8.36, 8.57V6.73l3.76 2.27-3.76 2.26z"></path></svg></a><a href="https://x.com/OpenZiti" target="_blank" class="footerSocialLink_t5Hs"><svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor" xmlns="http://www.w3.org/2000/svg"><path d="M15.996 3.038c-.59.262-1.219.44-1.885.52.677-.406 1.194-1.05 1.438-1.815-.634.375-1.337.648-2.085.795-.598-.638-1.45-1.038-2.396-1.038-1.813 0-3.283 1.469-3.283 3.282 0 .257.03.507.085.748-2.728-.137-5.147-1.445-6.766-3.43-.282.485-.444 1.05-.444 1.651 0 1.14.58 2.143 1.46 2.732-.538-.017-1.044-.164-1.487-.41v.04c0 1.59 1.13 2.918 2.633 3.219-.276.075-.567.116-.866.116-.211 0-.416-.021-.617-.06.418 1.304 1.63 2.254 3.066 2.28-1.124.883-2.539 1.406-4.077 1.406-.265 0-.526-.015-.785-.046 1.453.933 3.178 1.475 5.032 1.475 6.038 0 9.34-5.002 9.34-9.34 0-.142-.004-.284-.01-.425.641-.463 1.198-1.039 1.638-1.696"></path></svg></a></div></div><div class="footerColumn_aKLl"><h3>Documentation</h3><ul class="footerLinks_fOY0"><li><a href="/docs/learn/quickstarts/services/ztha">Getting Started</a></li><li><a href="/docs/reference/developer/api/">API Reference</a></li><li><a href="/docs/reference/developer/sdk/">SDK Integration</a></li></ul></div><div class="footerColumn_aKLl"><h3>Community</h3><ul class="footerLinks_fOY0"><li><a href="https://github.com/openziti/ziti">GitHub</a></li><li><a href="https://openziti.discourse.group/">Discourse Forum</a></li><li><a href="/policies/CONTRIBUTING">Contributing</a></li></ul></div><div class="footerColumn_aKLl"><h3>Resources</h3><ul class="footerLinks_fOY0"><li><a href="https://blog.openziti.io">Blog</a></li><li><a href="https://netfoundry.io/">NetFoundry</a></li></ul></div></div></div><div class="footerCopyright_W7lP"><p>© 2025 NetFoundry Inc. OpenZiti is an open source project sponsored by NetFoundry. All rights reserved.</p></div></section></footer></div></div>
</body>
</html>