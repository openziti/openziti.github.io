<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-guides/Digital_Ocean/Services">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.0">
<title data-rh="true">Services | OpenZiti</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://docs.openziti.io/docs/guides/Digital_Ocean/Services"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Services | OpenZiti"><meta data-rh="true" name="description" content="3.1 Introduction"><meta data-rh="true" property="og:description" content="3.1 Introduction"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://docs.openziti.io/docs/guides/Digital_Ocean/Services"><link data-rh="true" rel="alternate" href="https://docs.openziti.io/docs/guides/Digital_Ocean/Services" hreflang="en"><link data-rh="true" rel="alternate" href="https://docs.openziti.io/docs/guides/Digital_Ocean/Services" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://EXWPKK5PV4-dsn.algolia.net" crossorigin="anonymous"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OpenZiti RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OpenZiti Atom Feed">


<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-THVRRJ3GLE"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-THVRRJ3GLE",{anonymize_ip:!0})</script>




<link rel="search" type="application/opensearchdescription+xml" title="OpenZiti" href="/opensearch.xml"><link rel="stylesheet" href="/assets/css/styles.e6cbe7a9.css">
<link rel="preload" href="/assets/js/runtime~main.7f429a9b.js" as="script">
<link rel="preload" href="/assets/js/main.cd162dba.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#docusaurus_skipToContent_fallback">Skip to main content</a></div><div class="root_VOM9"><span style="color:whitesmoke">Star us on GitHub </span><span style="height:20px"><span><a href="https://github.com/openziti/ziti" data-icon="octicon-star" data-show-count="true" aria-label="Star buttons/github-buttons on GitHub">Star</a></span></span></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/ziti-logo-dark.svg" alt="OpenZiti Logo" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/ziti-logo-light.svg" alt="OpenZiti Logo" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate"></b></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/learn/introduction/">Documentation</a><a class="navbar__item navbar__link" href="/docs/downloads">Downloads</a><a href="https://blog.openziti.io/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link">Links</a><ul class="dropdown__menu"><li><div class="text-divider"><p>Socials</p></div></li><li><a href="https://www.youtube.com/OpenZiti" target="_blank" title="OpenZiti on YouTube"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/yt.svg">YouTube</span></a></li><li><a href="https://twitter.com/OpenZiti" target="_blank" title="OpenZiti on Twitter"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/twit.svg">Twitter</span></a></li><li><a href="https://reddit.com/r/openziti" target="_blank" title="OpenZiti Subreddit"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/reddit-logo.png">Reddit</span></a></li><li><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/ziggy.png"><a href="https://twitter.com/OpenZiggy" target="_blank" title="OpenZiggy on Twitter">Ziggy</a></span></li><li><div class="text-divider"><p>Other</p></div></li><li><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/blog-icon.png"><a href="https://blog.openziti.io/" target="_blank" title="Blog">Blog</a></span></li><li><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/oz-test-kitchen.png"><a href="https://github.com/openziti-test-kitchen" target="_blank" title="Git project for the test kitchen">Test Kitchen</a></span></li><li><a href="https://zeds.openziti.org" target="_blank" title="Developer Sandbox"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/zeds.png">ZEDS</span></a></li><li><a href="https://netfoundry.io/pricing/" target="_blank" title="NetFoundry-hosted Ziti"><span id="navbarDropdownItem"><img id="navbarDropdownImage" src="/img/nf.svg">CloudZiti</span></a></li></ul></div><a href="https://openziti.discourse.group/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-discourse-link" title="Discourse"></a><a href="https://github.com/openziti/ziti" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link header-github-link" title="GitHub"></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_eExm docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebarViewport_Xe31"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/learn/introduction/">LEARN</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/learn/introduction/">What is OpenZiti?</a><button aria-label="Toggle the collapsible sidebar category &#x27;What is OpenZiti?&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/learn/quickstarts/network/">Quickstarts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Quickstarts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/learn/core-concepts/">Core Concepts</a><button aria-label="Toggle the collapsible sidebar category &#x27;Core Concepts&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/reference/">REFERENCE</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reference/tunnelers/">Tunnelers</a><button aria-label="Toggle the collapsible sidebar category &#x27;Tunnelers&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reference/deployments/">Deployments</a><button aria-label="Toggle the collapsible sidebar category &#x27;Deployments&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reference/configuration/conventions">Configuration</a><button aria-label="Toggle the collapsible sidebar category &#x27;Configuration&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/reference/developer/">Developer</a><button aria-label="Toggle the collapsible sidebar category &#x27;Developer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/reference/glossary">Glossary</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title"><a class="menu__link" href="/docs/guides/">GUIDES</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/docs/category/digital-ocean">Digital Ocean</a><button aria-label="Toggle the collapsible sidebar category &#x27;Digital Ocean&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/Digital_Ocean/">Intro</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/Digital_Ocean/Controller">Controller</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/guides/Digital_Ocean/Router">Router</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/guides/Digital_Ocean/Services">Services</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/local-gateway">Local Gateway</a><button aria-label="Toggle the collapsible sidebar category &#x27;Local Gateway&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/kubernetes">Kubernetes</a><button aria-label="Toggle the collapsible sidebar category &#x27;Kubernetes&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides/alt-server-certs">Public CA Certs</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/guides/hsm/">Hardware Security Modules (HSM)</a><button aria-label="Toggle the collapsible sidebar category &#x27;Hardware Security Modules (HSM)&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/securing-apis">Securing APIs</a><button aria-label="Toggle the collapsible sidebar category &#x27;Securing APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/docs/category/troubleshooting">Troubleshooting</a><button aria-label="Toggle the collapsible sidebar category &#x27;Troubleshooting&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_PEFL"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_kv0_"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/category/digital-ocean"><span itemprop="name">Digital Ocean</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Services</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>3.0 Ziti services</h1><h2 class="anchor anchorWithStickyNavbar_LWe7" id="31-introduction">3.1 Introduction<a href="#31-introduction" class="hash-link" aria-label="Direct link to 3.1 Introduction" title="Direct link to 3.1 Introduction">​</a></h2><p>In this guide, we will demonstrate ziti services with three examples:</p><ul><li>connection between two identities running ziti-edge-tunnel</li><li>connection between ziti-edge-tunnel and a ziti-router (with tunnel enabled)</li><li>connection from a non-OpenZiti endpoint using router as GW</li></ul><p><img loading="lazy" alt="Diagram" src="/assets/images/Services1-17ff111d2a74a1a24ab9194d72f0465a.jpg" width="593" height="215" class="img_ev3q"></p><p>This guide provides both CLI and GUI (ZAC) instructions. To use ZAC, make sure ZAC is installed. If you have not installed ZAC, and would like to use it in this section, please follow the <a href="/docs/learn/quickstarts/zac/">ZAC Setup Guide</a> before continue.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="32-setup-vms-for-ziti-network">3.2 Setup VMs for ziti network<a href="#32-setup-vms-for-ziti-network" class="hash-link" aria-label="Direct link to 3.2 Setup VMs for ziti network" title="Direct link to 3.2 Setup VMs for ziti network">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="321-controller">3.2.1 Controller<a href="#321-controller" class="hash-link" aria-label="Direct link to 3.2.1 Controller" title="Direct link to 3.2.1 Controller">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3211-zac">3.2.1.1 ZAC<a href="#3211-zac" class="hash-link" aria-label="Direct link to 3.2.1.1 ZAC" title="Direct link to 3.2.1.1 ZAC">​</a></h4><p>Please make sure you can login to your network and see the welcome screen before continue.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/ZAC4-cd71daa7e31004fd6ed6a305681675c1.jpg" width="1695" height="958" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3212-cli">3.2.1.2 CLI<a href="#3212-cli" class="hash-link" aria-label="Direct link to 3.2.1.2 CLI" title="Direct link to 3.2.1.2 CLI">​</a></h4><p>You will need to login to controller to provision identities and service. Please make sure you are performing the action on the right node.</p><p>On the controller, before performing the CLI command, you will need to login first:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">zitiLogin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The login token expires after a period of time. If the token expired, you will need to login again via the same command. You will see error message like this when the CLI logs out:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">error: error listing https://161.35.108.218:8441/edge/management/v1/config-types?filter=id%3D%22host.v1%22 in Ziti Edge Controller. Status code: 401 Unauthorized, Server returned: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;error&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;code&quot;: &quot;UNAUTHORIZED&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;message&quot;: &quot;The request could not be completed. The session is not authorized or the credentials are invalid&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;requestId&quot;: &quot;7zxWCy7Vx&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    },</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &quot;meta&quot;: {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;apiEnrollmentVersion&quot;: &quot;0.0.1&quot;,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        &quot;apiVersion&quot;: &quot;0.0.1&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="322-router">3.2.2 Router<a href="#322-router" class="hash-link" aria-label="Direct link to 3.2.2 Router" title="Direct link to 3.2.2 Router">​</a></h3><p>Follow the <a href="/docs/guides/Digital_Ocean/Router/">Router guide</a> to setup a &quot;Router with link listener and tunneler&quot;. We will name this router: <strong>JAMES-ER-SF</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3221-zac">3.2.2.1 ZAC<a href="#3221-zac" class="hash-link" aria-label="Direct link to 3.2.2.1 ZAC" title="Direct link to 3.2.2.1 ZAC">​</a></h4><p>On the ZAC <strong>ROUTERS</strong> screen, you can check your router and make sure it is created correctly. You can also check the identity associated with the router by clicked on <strong>IDENTITIES</strong></p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services02-router-75b8104f6b6f924e95da19cbde4b1dcc.png" width="1656" height="656" class="img_ev3q"></p><p>On the <strong>IDENTITIES</strong> screen, you will see an identity match your router name.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services03-router-78ec27de221bff588023d3ee7b02c6e9.png" width="1641" height="645" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3222-cli">3.2.2.2 CLI<a href="#3222-cli" class="hash-link" aria-label="Direct link to 3.2.2.2 CLI" title="Direct link to 3.2.2.2 CLI">​</a></h4><p>Once the router is create, you can check the <strong>controller</strong> to make sure the router is created correctly.</p><p>You should see an router named <strong>JAMES-ER-SF</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬──────────────────────┬────────┬───────────────┬──────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                 │ ONLINE │ ALLOW TRANSIT │ COST │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼──────────────────────┼────────┼───────────────┼──────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2hWwOcTaR  │ James-NC-edge-router │ true   │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xTP5-y7VxP │ JAMES-ER-SF          │ false  │ true          │    0 │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴──────────────────────┴────────┴───────────────┴──────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should also see an identity named <strong>JAMES-ER-SF</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list identities</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬──────────────────────┬────────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                 │ TYPE   │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼──────────────────────┼────────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2hWwOcTaR  │ James-NC-edge-router │ Router │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ bhNbEYGrM  │ Default Admin        │ User   │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xTP5-y7VxP │ JAMES-ER-SF          │ Router │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴──────────────────────┴────────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-3 of 3</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Since we created this router as link listener, you should also check the link listener function is correctly setup. Check the router on fabric to make sure it has listeners displayed for the router you created.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti fabric list routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬──────────────────────┬────────┬──────┬──────────────┬──────────┬────────────────────────┬─────────────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                 │ ONLINE │ COST │ NO TRAVERSAL │ DISABLED │ VERSION                │ LISTENERS                   │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼──────────────────────┼────────┼──────┼──────────────┼──────────┼────────────────────────┼─────────────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2hWwOcTaR  │ James-NC-edge-router │ true   │    0 │ false        │ false    │ v0.27.7 on linux/amd64 │ 1: tls:161.35.108.218:10080 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xTP5-y7VxP │ JAMES-ER-SF          │ true   │    0 │ false        │ false    │ v0.27.7 on linux/amd64 │ 1: tls:146.190.120.86:80    │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴──────────────────────┴────────┴──────┴──────────────┴──────────┴────────────────────────┴─────────────────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="323-tunnelersidentities">3.2.3 Tunnelers/Identities<a href="#323-tunnelersidentities" class="hash-link" aria-label="Direct link to 3.2.3 Tunnelers/Identities" title="Direct link to 3.2.3 Tunnelers/Identities">​</a></h3><p>We need two tunnelers for our testing. Please follow <a href="/docs/guides/Digital_Ocean/Controller/">controller guide</a> section of &quot;Create VM on Digital Ocean&quot; to create two VMs running Ubuntu 22.04.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3231-create-identity-with-zac">3.2.3.1 Create Identity with ZAC<a href="#3231-create-identity-with-zac" class="hash-link" aria-label="Direct link to 3.2.3.1 Create Identity with ZAC" title="Direct link to 3.2.3.1 Create Identity with ZAC">​</a></h4><p>To create Identities on ZAC, go to the Identities screen, and press <strong>+</strong> icon. On the <strong>CREATE IDENTITY</strong> widget, enter the <strong>NAME</strong> of the identity (Required and has to be unique). Leave the <strong>IDENTITY TYPE</strong> as &quot;Device&quot;. Leave the <strong>ENROLLMENT TYPE</strong> as &quot;One Time Token&quot;. Fill in other optional fields and press <strong>SAVE</strong>.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services04-CreateService-55878e810547d68569bfc7c3825be029.png" width="1031" height="998" class="img_ev3q"></p><p>Once the identity is created, you can check your identity and download the <strong>JWT</strong> from the <strong>MANAGE IDENTITIES</strong> screen</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services05-CreateService-7e98d38f24652c5f14222c45c2b15888.png" width="1364" height="621" class="img_ev3q"></p><p><strong>Create two identities before you continue.</strong></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3232-create-identity-with-cli">3.2.3.2 Create Identity with CLI<a href="#3232-create-identity-with-cli" class="hash-link" aria-label="Direct link to 3.2.3.2 Create Identity with CLI" title="Direct link to 3.2.3.2 Create Identity with CLI">​</a></h4><p>Create two identities (JAMES-CL-NY, JAMES-CL-SF) on the <strong>controller</strong>:</p><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user JAMES-CL-NY -o JAMES-CL-NY.jwt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create identity user JAMES-CL-SF -o JAMES-CL-SF.jwt</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3233-register-identities">3.2.3.3 Register Identities<a href="#3233-register-identities" class="hash-link" aria-label="Direct link to 3.2.3.3 Register Identities" title="Direct link to 3.2.3.3 Register Identities">​</a></h4><p>Login to your VMs created earlier, follow <a href="/docs/reference/tunnelers/linux/">Install Linux Package</a> <strong>Ubuntu Jammy 22.04</strong> section to install and register your ziti-edge-tunnel.</p><p>After the tunnel is registered, check the status and make sure it is running</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># systemctl status ziti-edge-tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">● ziti-edge-tunnel.service - Ziti Edge Tunnel</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Loaded: loaded (/etc/systemd/system/ziti-edge-tunnel.service; enabled; vendor preset: enabled)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Active: active (running) since Wed 2023-04-05 20:57:04 UTC; 1min 41s ago</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Process: 2640 ExecStartPre=/opt/openziti/bin/ziti-edge-tunnel.sh (code=exited, status=0/SUCCESS)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Main PID: 2641 (ziti-edge-tunne)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Tasks: 5 (limit: 2323)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     Memory: 6.5M</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        CPU: 752ms</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     CGroup: /system.slice/ziti-edge-tunnel.service</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">             └─2641 /opt/openziti/bin/ziti-edge-tunnel run --verbose=2 --dns-ip-range=100.64.0.1/10 --identity-dir=/opt/openziti/etc/identities</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3234-gather-info-of-the-vms">3.2.3.4 Gather info of the VMs<a href="#3234-gather-info-of-the-vms" class="hash-link" aria-label="Direct link to 3.2.3.4 Gather info of the VMs" title="Direct link to 3.2.3.4 Gather info of the VMs">​</a></h4><p>After you registered both tunnelers, write down the local IP and subnet of these VMs, we will be using the local IP to test our traffics.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">JAMES-ER-SF: 10.124.0.2/20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JAMES-CL-SF: 10.124.0.3/20</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">JAMES-CL-NY: 10.136.219.136/16</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="33-create-edge-router-policy">3.3 Create Edge Router Policy<a href="#33-create-edge-router-policy" class="hash-link" aria-label="Direct link to 3.3 Create Edge Router Policy" title="Direct link to 3.3 Create Edge Router Policy">​</a></h2><p>By default, the system created an edge router policy to bind all identities to any routers tag with <strong>#public</strong> attribute. So, we need to add #public to our router (JAMES-ER-SF). </p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="331-zac">3.3.1 ZAC<a href="#331-zac" class="hash-link" aria-label="Direct link to 3.3.1 ZAC" title="Direct link to 3.3.1 ZAC">​</a></h3><p>From the <strong>ROUTERS</strong> screen, you can choose <strong>Router Policies</strong> to display the edge router policies. As you can see, the default policy is already in place.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services06-router-policy-727eafc8d1cad347cecd3d77b7bf7a6c.png" width="1670" height="593" class="img_ev3q"></p><p>To add attribute &quot;public&quot; to the router, choose your router from the <strong>ROUTERS</strong> screen, click on <strong>...</strong> and choose <strong>Edit</strong></p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services07-router-update-668c5c24c3c66a9b078917b42650090e.png" width="1362" height="553" class="img_ev3q"></p><p>On the <strong>EDIT EDGE ROUTER</strong> screen, you can add <strong>public</strong> attribute and then press <strong>SAVE</strong></p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services08-router-update-c7420ae7beab5982994348db9a0f19db.png" width="622" height="757" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="332-cli">3.3.2 CLI<a href="#332-cli" class="hash-link" aria-label="Direct link to 3.3.2 CLI" title="Direct link to 3.3.2 CLI">​</a></h3><p>On the <strong>controller</strong>:</p><p>check the edge router policy</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list edge-router-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬───────────────────────────────┬───────────────────────┬───────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME                          │ EDGE ROUTER ROLES     │ IDENTITY ROLES        │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼───────────────────────────────┼───────────────────────┼───────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2my8BX4UTsdnNtH5jInLH2 │ allEdgeRouters                │ #public               │ #all                  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴───────────────────────────────┴───────────────────────┴───────────────────────╯</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>check the edge router attribute</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬──────────────────────┬────────┬───────────────┬──────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                 │ ONLINE │ ALLOW TRANSIT │ COST │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼──────────────────────┼────────┼───────────────┼──────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2hWwOcTaR  │ James-NC-edge-router │ true   │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xTP5-y7VxP │ JAMES-ER-SF          │ true   │ true          │    0 │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴──────────────────────┴────────┴───────────────┴──────┴────────────╯</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Add &quot;public&quot; attribute to our router:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge update edge-router JAMES-ER-SF -a &quot;public&quot;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list edge-routers</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────┬──────────────────────┬────────┬───────────────┬──────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID         │ NAME                 │ ONLINE │ ALLOW TRANSIT │ COST │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────┼──────────────────────┼────────┼───────────────┼──────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2hWwOcTaR  │ James-NC-edge-router │ true   │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ xTP5-y7VxP │ JAMES-ER-SF          │ true   │ true          │    0 │ public     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────┴──────────────────────┴────────┴───────────────┴──────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="34-setup-tunnel-to-tunnel-ssh-connection">3.4 Setup Tunnel to Tunnel ssh connection<a href="#34-setup-tunnel-to-tunnel-ssh-connection" class="hash-link" aria-label="Direct link to 3.4 Setup Tunnel to Tunnel ssh connection" title="Direct link to 3.4 Setup Tunnel to Tunnel ssh connection">​</a></h2><p>In this section, we will be showing how to configure ziti to establish ssh service via our network. We will be using a pseudo dns name (t2tssh.ziti) to establish this connection.  The intercept side (ingress) will be JAMES-CL-SF, the server side (egress) will be JAMES-CL-NY.</p><p>For CLI procedures, all commands are done on the <strong>controller</strong></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="341-create-a-hostv1-config">3.4.1 Create a host.v1 config<a href="#341-create-a-hostv1-config" class="hash-link" aria-label="Direct link to 3.4.1 Create a host.v1 config" title="Direct link to 3.4.1 Create a host.v1 config">​</a></h3><p>This config is used instruct the server-side tunneler how to offload the traffic from the overlay, back to the underlay. We are dropping the traffic off our loopback interface, so we use the address &quot;127.0.0.1“</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3411-zac">3.4.1.1 ZAC<a href="#3411-zac" class="hash-link" aria-label="Direct link to 3.4.1.1 ZAC" title="Direct link to 3.4.1.1 ZAC">​</a></h4><p>Create the configuration from <strong>MANAGE CONFIGURATIONS</strong> screen.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services10-655bc71be07a63761fc0696f4bf26f01.png" width="670" height="1175" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3412-cli">3.4.1.2 CLI<a href="#3412-cli" class="hash-link" aria-label="Direct link to 3.4.1.2 CLI" title="Direct link to 3.4.1.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config t2thostconf host.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocol&quot;:&quot;tcp&quot;, &quot;address&quot;:&quot;127.0.0.1&quot;, &quot;port&quot;:22}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="342-create-an-interceptv1-config">3.4.2 Create an intercept.v1 config<a href="#342-create-an-interceptv1-config" class="hash-link" aria-label="Direct link to 3.4.2 Create an intercept.v1 config" title="Direct link to 3.4.2 Create an intercept.v1 config">​</a></h3><p>This config is used to instruct the intercept-side tunneler how to correctly intercept the targeted traffic and put it onto the overlay. We are setting up intercept on dns name &quot;t2tssh.ziti&quot;</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3421-zac">3.4.2.1 ZAC<a href="#3421-zac" class="hash-link" aria-label="Direct link to 3.4.2.1 ZAC" title="Direct link to 3.4.2.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services11-362ff69194eb84b5d7874525425d22dd.png" width="630" height="979" class="img_ev3q"></p><p>Check the provisioned configs on the configuration screen:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services12-a4ab3663ce31dbffd8294dbbfc0d3755.png" width="1350" height="290" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3422-cli">3.4.2.2 CLI<a href="#3422-cli" class="hash-link" aria-label="Direct link to 3.4.2.2 CLI" title="Direct link to 3.4.2.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config t2tintconf intercept.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocols&quot;: [&quot;tcp&quot;], &quot;addresses&quot;: [&quot;t2tssh.ziti&quot;], &quot;portRanges&quot;: [{&quot;low&quot;: 22, &quot;high&quot;: 22}]}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>If the command finished successfully, you will see two configs:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬─────────────┬──────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME        │ CONFIG TYPE  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼─────────────┼──────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 1R9iDpU7OvREH6LNxQapPO │ t2tintconf  │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ gIeZ1KgilGXzkY4RxDF2f  │ t2thostconf │ host.v1      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴─────────────┴──────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="343-create-service">3.4.3 Create Service<a href="#343-create-service" class="hash-link" aria-label="Direct link to 3.4.3 Create Service" title="Direct link to 3.4.3 Create Service">​</a></h3><p>Now we need to put these two configs into a service. We going to name the service &quot;t2tssh&quot;:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3431-zac">3.4.3.1 ZAC<a href="#3431-zac" class="hash-link" aria-label="Direct link to 3.4.3.1 ZAC" title="Direct link to 3.4.3.1 ZAC">​</a></h4><p>Create service from <strong>Services</strong> menu from <strong>MANAGE EDGE SERVICES</strong> screen.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services13-ea447061d73ef380988bac6bf5a508cd.png" width="1021" height="773" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3432-cli">3.4.3.2 CLI<a href="#3432-cli" class="hash-link" aria-label="Direct link to 3.4.3.2 CLI" title="Direct link to 3.4.3.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create </span><span class="token function" style="color:#d73a49">service</span><span class="token plain"> t2tssh -c t2tintconf,t2thostconf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Check Service</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭───────────────────────┬────────┬────────────┬─────────────────────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                    │ NAME   │ ENCRYPTION │ TERMINATOR STRATEGY │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                       │        │  REQUIRED  │                     │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├───────────────────────┼────────┼────────────┼─────────────────────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ CZJi5tDxTk8C8XymCbu7f │ t2tssh │ true       │ smartrouting        │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰───────────────────────┴────────┴────────────┴─────────────────────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-1 of 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Please note, the <strong>Encryption = true</strong> and <strong>smartrouting</strong> are default setting.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="344-create-bind-service-policy">3.4.4 Create Bind Service policy<a href="#344-create-bind-service-policy" class="hash-link" aria-label="Direct link to 3.4.4 Create Bind Service policy" title="Direct link to 3.4.4 Create Bind Service policy">​</a></h3><p>Now we need to specify which tunneler (in our case, <strong>JAMES-CL-NY</strong>)is going to host the service by setting up a bind service policy</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3441-zac">3.4.4.1 ZAC<a href="#3441-zac" class="hash-link" aria-label="Direct link to 3.4.4.1 ZAC" title="Direct link to 3.4.4.1 ZAC">​</a></h4><p>Create a <strong>service policy</strong> from <strong>MANAGE SERVICE POLICIES</strong> screen:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services14-ee071b242b26121d254321885fffa7f2.png" width="649" height="851" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3442-cli">3.4.4.2 CLI<a href="#3442-cli" class="hash-link" aria-label="Direct link to 3.4.4.2 CLI" title="Direct link to 3.4.4.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy t2tssh.bind Bind --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@t2tssh&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-CL-NY&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="345-create-dial-service-policy">3.4.5 Create Dial Service policy<a href="#345-create-dial-service-policy" class="hash-link" aria-label="Direct link to 3.4.5 Create Dial Service policy" title="Direct link to 3.4.5 Create Dial Service policy">​</a></h3><p>Now we need to specify the intercept side tunneler (<strong>JAMES-CL-SF</strong>) for the service by setting up a dial service policy</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3451-zac">3.4.5.1 ZAC<a href="#3451-zac" class="hash-link" aria-label="Direct link to 3.4.5.1 ZAC" title="Direct link to 3.4.5.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services15-1556684199482f89a0f0a31a402317c1.png" width="617" height="846" class="img_ev3q"></p><p>We should have two service policies created. The services name should match on two policies.  One policy is Bind and the other ons is Dial.  They should be set to different identities.</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services16-44fc4082e49fb8830114a34ebc61738e.png" width="1349" height="293" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3452-cli">3.4.5.2 CLI<a href="#3452-cli" class="hash-link" aria-label="Direct link to 3.4.5.2 CLI" title="Direct link to 3.4.5.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy t2tssh.dial Dial --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@t2tssh&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-CL-SF&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure both policies are setup correctly：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list service-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬─────────────┬──────────┬───────────────┬────────────────┬─────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME        │ SEMANTIC │ SERVICE ROLES │ IDENTITY ROLES │ POSTURE CHECK ROLES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼─────────────┼──────────┼───────────────┼────────────────┼─────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 3h25stJwThctE1AAJRGVwP │ t2tssh.bind │ AllOf    │ @t2tssh       │ @JAMES-CL-NY   │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 5eSuYfv381U3qNs3vYbqpU │ t2tssh.dial │ AllOf    │ @t2tssh       │ @JAMES-CL-SF   │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴─────────────┴──────────┴───────────────┴────────────────┴─────────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should also make sure the policy advisor display correctly:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge policy-advisor services |grep t2tssh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-CL-NY (2) -&gt; t2tssh (2) Common Routers: (2/2) Dial: N Bind: Y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-CL-SF (2) -&gt; t2tssh (2) Common Routers: (2/2) Dial: Y Bind: N</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure there is a &quot;Dial&quot; line and a &quot;Bind&quot; line. They are both &quot;OKAY&quot; and has at least 1 Common Routers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="346-verify-the-connection">3.4.6 Verify the connection<a href="#346-verify-the-connection" class="hash-link" aria-label="Direct link to 3.4.6 Verify the connection" title="Direct link to 3.4.6 Verify the connection">​</a></h3><p>Login to the intercept side tunneler (<strong>JAMES-CL-SF</strong>) node, you should be able to ssh to the server (<strong>JAMES-CL-NY</strong>) by using dns name &quot;t2tssh.ziti&quot;</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-SF:~# ssh t2tssh.ziti</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Welcome to Ubuntu 22.04.2 LTS (GNU/Linux 5.15.0-67-generic x86_64)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Documentation:  https://help.ubuntu.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Management:     https://landscape.canonical.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Support:        https://ubuntu.com/advantage</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  System information as of Wed Apr  5 22:35:36 UTC 2023</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  System load:  0.009765625       Users logged in:       1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Usage of /:   3.4% of 48.27GB   IPv4 address for eth0: 104.248.116.185</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Memory usage: 11%               IPv4 address for eth0: 10.10.0.6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Swap usage:   0%                IPv4 address for eth1: 10.136.219.136</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  Processes:    94                IPv4 address for tun0: 100.64.0.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> * Introducing Expanded Security Maintenance for Applications.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Receive updates to over 25,000 software packages with your</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">   Ubuntu Pro subscription. Free for personal use.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">     https://ubuntu.com/pro</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Expanded Security Maintenance for Applications is not enabled.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">28 updates can be applied immediately.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">21 of these updates are standard security updates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">To see these additional updates run: apt list --upgradable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Enable ESM Apps to receive additional future security updates.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">See https://ubuntu.com/esm or run: sudo pro status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Last login: Wed Apr  5 20:45:18 2023 from 45.17.199.35</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-NY:~# &lt;ctrl-d&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logout</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Connection to t2tssh.ziti closed.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-SF:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="35-setup-tunnel-to-ert-http-connection">3.5 Setup Tunnel to ERT http connection<a href="#35-setup-tunnel-to-ert-http-connection" class="hash-link" aria-label="Direct link to 3.5 Setup Tunnel to ERT http connection" title="Direct link to 3.5 Setup Tunnel to ERT http connection">​</a></h2><p>Edge Router Tunnel (ERT) has combine router and tunneler function. In this section, we will demonstrate a connection between a Ziti-Edge-Tunnel (JAMES-CL-NY) to a ERT (JAMES-ER-SF)</p><p>The procedure is similar to tunnel to tunnel service, so please refer to that section for detail explanation of each step.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="351-create-a-hostv1-config">3.5.1 Create a host.v1 config<a href="#351-create-a-hostv1-config" class="hash-link" aria-label="Direct link to 3.5.1 Create a host.v1 config" title="Direct link to 3.5.1 Create a host.v1 config">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3511-zac">3.5.1.1 ZAC<a href="#3511-zac" class="hash-link" aria-label="Direct link to 3.5.1.1 ZAC" title="Direct link to 3.5.1.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services20-4dbd9e18442fcfb6852aba33653602cf.png" width="677" height="1158" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3512-cli">3.5.1.2 CLI<a href="#3512-cli" class="hash-link" aria-label="Direct link to 3.5.1.2 CLI" title="Direct link to 3.5.1.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config t2ehostconf host.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocol&quot;:&quot;tcp&quot;, &quot;address&quot;:&quot;127.0.0.1&quot;, &quot;port&quot;:8080}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="352-create-an-interceptv1-config">3.5.2 Create an intercept.v1 config<a href="#352-create-an-interceptv1-config" class="hash-link" aria-label="Direct link to 3.5.2 Create an intercept.v1 config" title="Direct link to 3.5.2 Create an intercept.v1 config">​</a></h3><p>Use destination local ip (10.124.0.2) as intercept address</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3521-zac">3.5.2.1 ZAC<a href="#3521-zac" class="hash-link" aria-label="Direct link to 3.5.2.1 ZAC" title="Direct link to 3.5.2.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services21-eb83684b9ed2767713217e2e0299544f.png" width="664" height="976" class="img_ev3q"></p><p>And you should have two configs:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services22-61684fc739691d1ae4a0e39a71f09718.png" width="1367" height="311" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3522-cli">3.5.2.2 CLI<a href="#3522-cli" class="hash-link" aria-label="Direct link to 3.5.2.2 CLI" title="Direct link to 3.5.2.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config t2eintconf intercept.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocols&quot;: [&quot;tcp&quot;], &quot;addresses&quot;: [&quot;10.124.0.2&quot;], &quot;portRanges&quot;: [{&quot;low&quot;: 80, &quot;high&quot;: 80}]}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list configs |grep t2e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ IlgnlM2srnU7s8C3hiLJA  │ t2eintconf  │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ uJUtyXI5XH1wSsSCiCARp  │ t2ehostconf │ host.v1      │</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="353-create-service">3.5.3 Create Service<a href="#353-create-service" class="hash-link" aria-label="Direct link to 3.5.3 Create Service" title="Direct link to 3.5.3 Create Service">​</a></h3><p>Now we need to put these two configs into a service. We going to name the service &quot;t2ehttp&quot;:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3531-zac">3.5.3.1 ZAC<a href="#3531-zac" class="hash-link" aria-label="Direct link to 3.5.3.1 ZAC" title="Direct link to 3.5.3.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services23-7283400f2e927e467cdf18a6c05e90d2.png" width="1034" height="766" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3532-cli">3.5.3.2 CLI<a href="#3532-cli" class="hash-link" aria-label="Direct link to 3.5.3.2 CLI" title="Direct link to 3.5.3.2 CLI">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service t2ehttp -c t2eintconf,t2ehostconf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Check Service</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list services |grep t2e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 5FI8Aw0IQ7xaUMgH2rKvps │ t2ehttp │ true       │ smartrouting        │            │</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="354-create-bind-service-policy">3.5.4 Create Bind Service policy<a href="#354-create-bind-service-policy" class="hash-link" aria-label="Direct link to 3.5.4 Create Bind Service policy" title="Direct link to 3.5.4 Create Bind Service policy">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3541-zac">3.5.4.1 ZAC<a href="#3541-zac" class="hash-link" aria-label="Direct link to 3.5.4.1 ZAC" title="Direct link to 3.5.4.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services24-d2ebf76a7153a0b1121bec122ebd89b3.png" width="612" height="830" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3542-cli">3.5.4.2 CLI<a href="#3542-cli" class="hash-link" aria-label="Direct link to 3.5.4.2 CLI" title="Direct link to 3.5.4.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy t2ehttp.bind Bind --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@t2ehttp&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-ER-SF&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="355-create-dial-service-policy">3.5.5 Create Dial Service policy<a href="#355-create-dial-service-policy" class="hash-link" aria-label="Direct link to 3.5.5 Create Dial Service policy" title="Direct link to 3.5.5 Create Dial Service policy">​</a></h3><p>Now we need to specify the intercept side tunneler (<strong>JAMES-CL-NY</strong>) for the service by setting up a dial service policy</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3551-zac">3.5.5.1 ZAC<a href="#3551-zac" class="hash-link" aria-label="Direct link to 3.5.5.1 ZAC" title="Direct link to 3.5.5.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services25-16725c772a0df51019faefaef5398e96.png" width="632" height="833" class="img_ev3q"></p><p>Check two service polices:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services26-5a2f698799fe3937fe02af0306d5ea7e.png" width="1363" height="313" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3552-cli">3.5.5.2 CLI<a href="#3552-cli" class="hash-link" aria-label="Direct link to 3.5.5.2 CLI" title="Direct link to 3.5.5.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy t2ehttp.dial Dial --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@t2ehttp&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-CL-NY&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure both policies are setup correctly：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list service-policies |grep t2e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 1UFHo2XRniIuORXKJaXDIZ │ t2ehttp.bind │ AllOf    │ @t2ehttp      │ @JAMES-ER-SF   │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 3jgxqoRp9g4axj6MM986Dt │ t2ehttp.dial │ AllOf    │ @t2ehttp      │ @JAMES-CL-NY   │                     │</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should also make sure the policy advisor display correctly:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge policy-advisor services |grep t2ehttp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-CL-NY (2) -&gt; t2ehttp (2) Common Routers: (2/2) Dial: Y Bind: N</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-ER-SF (2) -&gt; t2ehttp (2) Common Routers: (2/2) Dial: N Bind: Y</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure there is a &quot;Dial&quot; line and a &quot;Bind&quot; line. They are both &quot;OKAY&quot; and has at least 1 Common Routers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="356-verify-the-connection">3.5.6 Verify the connection<a href="#356-verify-the-connection" class="hash-link" aria-label="Direct link to 3.5.6 Verify the connection" title="Direct link to 3.5.6 Verify the connection">​</a></h3><p>Login to the router (<strong>JAMES-ER-SF</strong>), setup a file to send via http.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-ER-SF:~# cat &gt;hello.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is file from Edge Router in San Francisco.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ctrl-d&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-ER-SF:~# python3 -m http.server 8080</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Serving HTTP on 0.0.0.0 port 8080 (http://0.0.0.0:8080/) ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Login to the intercept side tunneler (<strong>JAMES-CL-NY</strong>) node.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-NY:~# curl http://10.124.0.2/hello.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is file from Edge Router in San Francisco.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-NY:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="357-conclusion">3.5.7 Conclusion<a href="#357-conclusion" class="hash-link" aria-label="Direct link to 3.5.7 Conclusion" title="Direct link to 3.5.7 Conclusion">​</a></h3><p>In section, we demonstrated intercepting http (port 80) request to an IP address and forward the request to a remote http server listening to port 8080 via ziti network.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="36-setup-connection-from-a-non-openziti-client">3.6 Setup Connection from a non-OpenZiti client<a href="#36-setup-connection-from-a-non-openziti-client" class="hash-link" aria-label="Direct link to 3.6 Setup Connection from a non-OpenZiti client" title="Direct link to 3.6 Setup Connection from a non-OpenZiti client">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="361-introduction">3.6.1 Introduction<a href="#361-introduction" class="hash-link" aria-label="Direct link to 3.6.1 Introduction" title="Direct link to 3.6.1 Introduction">​</a></h3><p>In this section, we will demonstrate how to setup non-OpenZiti client to use the ziti service. The following conditions need to be met in order for this connection to work correctly:</p><ul><li>The non-OpenZiti client has to be in the same data center as the edge router. </li><li>The edge router is created with tunneler enabled.</li></ul><p>We are also need to do the following to successfully demonstrate the connection:</p><ul><li>Create host and intercept config</li><li>Create service</li><li>Create dial and bind policy</li><li>Setup route on the non-OpenZiti client</li></ul><p>We will create an intercept at 11.11.11.11:80, and drop off at local IP (10.10.0.6) **JAMES-CL-NY&quot; port (80).
<img loading="lazy" alt="Diagram" src="/assets/images/Services37-bea3e85d8120ec419c56ae8bbb5e45e0.png" width="689" height="235" class="img_ev3q"></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="362-create-a-hostv1-config">3.6.2 Create a host.v1 config<a href="#362-create-a-hostv1-config" class="hash-link" aria-label="Direct link to 3.6.2 Create a host.v1 config" title="Direct link to 3.6.2 Create a host.v1 config">​</a></h3><p>Used address <strong>10.10.0.6</strong> as host side destination, and port <strong>80</strong> as destination port.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3621-zac">3.6.2.1 ZAC<a href="#3621-zac" class="hash-link" aria-label="Direct link to 3.6.2.1 ZAC" title="Direct link to 3.6.2.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services30-fe87fa960eaaaeb66209a9b181874274.png" width="693" height="1173" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3622-cli">3.6.2.2 CLI<a href="#3622-cli" class="hash-link" aria-label="Direct link to 3.6.2.2 CLI" title="Direct link to 3.6.2.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config e2thostconf host.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocol&quot;:&quot;tcp&quot;, &quot;address&quot;:&quot;10.10.0.6&quot;, &quot;port&quot;:80}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="363-create-an-interceptv1-config">3.6.3 Create an intercept.v1 config<a href="#363-create-an-interceptv1-config" class="hash-link" aria-label="Direct link to 3.6.3 Create an intercept.v1 config" title="Direct link to 3.6.3 Create an intercept.v1 config">​</a></h3><p>Use a pseudo ip (11.11.11.11) as intercept address</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3631-zac">3.6.3.1 ZAC<a href="#3631-zac" class="hash-link" aria-label="Direct link to 3.6.3.1 ZAC" title="Direct link to 3.6.3.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services31-43a0b54d72dad7e556a52bc443b6eed2.png" width="653" height="991" class="img_ev3q"></p><p>And you should have two configs:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services32-f18cb5a4deafa876f966cc53d1eb4c26.png" width="1377" height="300" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3632-cli">3.6.3.2 CLI<a href="#3632-cli" class="hash-link" aria-label="Direct link to 3.6.3.2 CLI" title="Direct link to 3.6.3.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create config e2tintconf intercept.v1 </span><span class="token string" style="color:#e3116c">&#x27;{&quot;protocols&quot;: [&quot;tcp&quot;], &quot;addresses&quot;: [&quot;11.11.11.11&quot;], &quot;portRanges&quot;: [{&quot;low&quot;: 80, &quot;high&quot;: 80}]}&#x27;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list configs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬─────────────┬──────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME        │ CONFIG TYPE  │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼─────────────┼──────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 2XPvCjPhQHSXi5xWXgprFy │ e2thostconf │ host.v1      │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 4GxliAfD7Ww1uEpyJeb9eF │ e2tintconf  │ intercept.v1 │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴─────────────┴──────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="364-create-service">3.6.4 Create Service<a href="#364-create-service" class="hash-link" aria-label="Direct link to 3.6.4 Create Service" title="Direct link to 3.6.4 Create Service">​</a></h3><p>Now we need to put these two configs into a service. We going to name the service &quot;t2ehttp&quot;:</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3641-zac">3.6.4.1 ZAC<a href="#3641-zac" class="hash-link" aria-label="Direct link to 3.6.4.1 ZAC" title="Direct link to 3.6.4.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services33-9ab434f7bca42feb49c5bfa022229979.png" width="1028" height="736" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3642-cli">3.6.4.2 CLI<a href="#3642-cli" class="hash-link" aria-label="Direct link to 3.6.4.2 CLI" title="Direct link to 3.6.4.2 CLI">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service e2thttp -c e2thostconf,e2tintconf</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><strong>Check Service</strong></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list services</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬─────────┬────────────┬─────────────────────┬────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME    │ ENCRYPTION │ TERMINATOR STRATEGY │ ATTRIBUTES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│                        │         │  REQUIRED  │                     │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼─────────┼────────────┼─────────────────────┼────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 22Rxkf75JPYYgC2TYv6IHB │ e2thttp │ true       │ smartrouting        │            │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴─────────┴────────────┴─────────────────────┴────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-1 of 1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="365-create-bind-service-policy">3.6.5 Create Bind Service policy<a href="#365-create-bind-service-policy" class="hash-link" aria-label="Direct link to 3.6.5 Create Bind Service policy" title="Direct link to 3.6.5 Create Bind Service policy">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3651-zac">3.6.5.1 ZAC<a href="#3651-zac" class="hash-link" aria-label="Direct link to 3.6.5.1 ZAC" title="Direct link to 3.6.5.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services34-b655cf6bfb8b4b47651f3ecd3987740e.png" width="624" height="831" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3652-cli">3.6.5.2 CLI<a href="#3652-cli" class="hash-link" aria-label="Direct link to 3.6.5.2 CLI" title="Direct link to 3.6.5.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy e2thttp.bind Bind --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@e2thttp&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-CL-NY&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="366-create-dial-service-policy">3.6.6 Create Dial Service policy<a href="#366-create-dial-service-policy" class="hash-link" aria-label="Direct link to 3.6.6 Create Dial Service policy" title="Direct link to 3.6.6 Create Dial Service policy">​</a></h3><p>Now we need to specify the intercept side tunneler (<strong>JAMES-ER-SF</strong>) for the service by setting up a dial service policy</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3661-zac">3.6.6.1 ZAC<a href="#3661-zac" class="hash-link" aria-label="Direct link to 3.6.6.1 ZAC" title="Direct link to 3.6.6.1 ZAC">​</a></h4><p><img loading="lazy" alt="Diagram" src="/assets/images/Services35-4ec1ac75d3df6b975226c88d6c9f9d2a.png" width="620" height="844" class="img_ev3q"></p><p>Check two service polices:</p><p><img loading="lazy" alt="Diagram" src="/assets/images/Services36-064ab049933323ecf932ee99970358a4.png" width="1358" height="300" class="img_ev3q"></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="3662-cli">3.6.6.2 CLI<a href="#3662-cli" class="hash-link" aria-label="Direct link to 3.6.6.2 CLI" title="Direct link to 3.6.6.2 CLI">​</a></h4><div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-bash codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">ziti edge create service-policy t2ehttp.dial Dial --service-roles </span><span class="token string" style="color:#e3116c">&#x27;@e2thttp&#x27;</span><span class="token plain"> --identity-roles </span><span class="token string" style="color:#e3116c">&quot;@JAMES-ER-SF&quot;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure both policies are setup correctly：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge list service-policies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╭────────────────────────┬──────────────┬──────────┬───────────────┬────────────────┬─────────────────────╮</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ ID                     │ NAME         │ SEMANTIC │ SERVICE ROLES │ IDENTITY ROLES │ POSTURE CHECK ROLES │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├────────────────────────┼──────────────┼──────────┼───────────────┼────────────────┼─────────────────────┤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ 3amYaaKuaRjbhYVnyp3E0U │ t2ehttp.dial │ AllOf    │ @e2thttp      │ @JAMES-ER-SF   │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">│ AAsWJvHALaz7hxeAHWBIX  │ e2thttp.bind │ AllOf    │ @e2thttp      │ @JAMES-CL-NY   │                     │</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">╰────────────────────────┴──────────────┴──────────┴───────────────┴────────────────┴─────────────────────╯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">results: 1-2 of 2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>You should also make sure the policy advisor display correctly:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># ziti edge policy-advisor services |grep e2thttp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-CL-NY (2) -&gt; e2thttp (2) Common Routers: (2/2) Dial: N Bind: Y</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">OKAY : JAMES-ER-SF (2) -&gt; e2thttp (2) Common Routers: (2/2) Dial: Y Bind: N</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Make sure there is a &quot;Dial&quot; line and a &quot;Bind&quot; line. They are both &quot;OKAY&quot; and has at least 1 Common Routers.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="367-verify-the-connection">3.6.7 Verify the connection<a href="#367-verify-the-connection" class="hash-link" aria-label="Direct link to 3.6.7 Verify the connection" title="Direct link to 3.6.7 Verify the connection">​</a></h3><p>Login to the Client (<strong>JAMES-CL-NY</strong>), setup a file to send via http.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-CL-NY:~# cat &gt;hello.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is file from Open-Ziti Client in Big Apple.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ctrl-d&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-ER-SF:~# python3 -m http.server 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Serving HTTP on 0.0.0.0 port 80 (http://0.0.0.0:80/) ...</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Login to the non-OpenZiti client machine (<strong>JAMES-Non-Ziti-SF</strong>).</p><p><strong>setup the route first</strong>. The route is via our ER in the same DC (10.124.0.2)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-Non-Ziti-SF:~# ip route add 11.11.11.11/32 via 10.124.0.2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Now test the connection</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-Non-Ziti-SF:~# curl http://11.11.11.11/hello.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">This is file from Open-Ziti Client in Big Apple.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">root@JAMES-Non-Ziti-SF:~#</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/openziti/ziti-doc/tree/main/docusaurus/docs/guides/Digital_Ocean/Services.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/guides/Digital_Ocean/Router"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Router</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/category/local-gateway"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Local Gateway</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#31-introduction" class="table-of-contents__link toc-highlight">3.1 Introduction</a></li><li><a href="#32-setup-vms-for-ziti-network" class="table-of-contents__link toc-highlight">3.2 Setup VMs for ziti network</a><ul><li><a href="#321-controller" class="table-of-contents__link toc-highlight">3.2.1 Controller</a></li><li><a href="#322-router" class="table-of-contents__link toc-highlight">3.2.2 Router</a></li><li><a href="#323-tunnelersidentities" class="table-of-contents__link toc-highlight">3.2.3 Tunnelers/Identities</a></li></ul></li><li><a href="#33-create-edge-router-policy" class="table-of-contents__link toc-highlight">3.3 Create Edge Router Policy</a><ul><li><a href="#331-zac" class="table-of-contents__link toc-highlight">3.3.1 ZAC</a></li><li><a href="#332-cli" class="table-of-contents__link toc-highlight">3.3.2 CLI</a></li></ul></li><li><a href="#34-setup-tunnel-to-tunnel-ssh-connection" class="table-of-contents__link toc-highlight">3.4 Setup Tunnel to Tunnel ssh connection</a><ul><li><a href="#341-create-a-hostv1-config" class="table-of-contents__link toc-highlight">3.4.1 Create a host.v1 config</a></li><li><a href="#342-create-an-interceptv1-config" class="table-of-contents__link toc-highlight">3.4.2 Create an intercept.v1 config</a></li><li><a href="#343-create-service" class="table-of-contents__link toc-highlight">3.4.3 Create Service</a></li><li><a href="#344-create-bind-service-policy" class="table-of-contents__link toc-highlight">3.4.4 Create Bind Service policy</a></li><li><a href="#345-create-dial-service-policy" class="table-of-contents__link toc-highlight">3.4.5 Create Dial Service policy</a></li><li><a href="#346-verify-the-connection" class="table-of-contents__link toc-highlight">3.4.6 Verify the connection</a></li></ul></li><li><a href="#35-setup-tunnel-to-ert-http-connection" class="table-of-contents__link toc-highlight">3.5 Setup Tunnel to ERT http connection</a><ul><li><a href="#351-create-a-hostv1-config" class="table-of-contents__link toc-highlight">3.5.1 Create a host.v1 config</a></li><li><a href="#352-create-an-interceptv1-config" class="table-of-contents__link toc-highlight">3.5.2 Create an intercept.v1 config</a></li><li><a href="#353-create-service" class="table-of-contents__link toc-highlight">3.5.3 Create Service</a></li><li><a href="#354-create-bind-service-policy" class="table-of-contents__link toc-highlight">3.5.4 Create Bind Service policy</a></li><li><a href="#355-create-dial-service-policy" class="table-of-contents__link toc-highlight">3.5.5 Create Dial Service policy</a></li><li><a href="#356-verify-the-connection" class="table-of-contents__link toc-highlight">3.5.6 Verify the connection</a></li><li><a href="#357-conclusion" class="table-of-contents__link toc-highlight">3.5.7 Conclusion</a></li></ul></li><li><a href="#36-setup-connection-from-a-non-openziti-client" class="table-of-contents__link toc-highlight">3.6 Setup Connection from a non-OpenZiti client</a><ul><li><a href="#361-introduction" class="table-of-contents__link toc-highlight">3.6.1 Introduction</a></li><li><a href="#362-create-a-hostv1-config" class="table-of-contents__link toc-highlight">3.6.2 Create a host.v1 config</a></li><li><a href="#363-create-an-interceptv1-config" class="table-of-contents__link toc-highlight">3.6.3 Create an intercept.v1 config</a></li><li><a href="#364-create-service" class="table-of-contents__link toc-highlight">3.6.4 Create Service</a></li><li><a href="#365-create-bind-service-policy" class="table-of-contents__link toc-highlight">3.6.5 Create Bind Service policy</a></li><li><a href="#366-create-dial-service-policy" class="table-of-contents__link toc-highlight">3.6.6 Create Dial Service policy</a></li><li><a href="#367-verify-the-connection" class="table-of-contents__link toc-highlight">3.6.7 Verify the connection</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container container-fluid"><div class="footer__links text--center"><div class="footer__links"><a class="footer__link-item" href="/policies/CODE_OF_CONDUCT">Policies</a><span class="footer__link-separator">·</span><a href="https://netfoundry.io/pricing/" target="_blank" rel="noopener noreferrer" class="footer__link-item">CloudZiti</a><span class="footer__link-separator">·</span><a href="https://blog.openziti.io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2023 NetFoundry Inc.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7f429a9b.js"></script>
<script src="/assets/js/main.cd162dba.js"></script>
</body>
</html>